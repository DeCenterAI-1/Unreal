try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="950a4d68-9a9a-4ed8-9b4c-c6b35279cc47",e._sentryDebugIdIdentifier="sentry-dbid-950a4d68-9a9a-4ed8-9b4c-c6b35279cc47")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98620],{16610:(e,t,r)=>{"use strict";r.d(t,{BS:()=>n,K5:()=>i,rt:()=>o});var l=r(40178),a=r(14669),s=r(25303);async function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(0,l.eO)(t,a.bh),{data:i,error:o}=await e.from("posts").select("*").eq("isPrivate",!1).eq("isDraft",!1).order("createdAt",{ascending:!1}).range(r[0],r[1]);if(o)throw(0,s.vV)("Supabase error fetching posts",o),Error(o.message);return i.map(e=>({...e,ipfsImages:Array.isArray(e.ipfsImages)?e.ipfsImages:"string"==typeof e.ipfsImages?JSON.parse(e.ipfsImages):null}))}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(0,l.eO)(t,20),{data:a,error:i}=await e.from("posts").select("*").eq("isPrivate",!1).eq("isDraft",!1).gt("like_count",0).order("like_count",{ascending:!1}).range(r[0],r[1]);if(i)throw(0,s.vV)("Supabase error fetching top posts",i),Error(i.message);return a.map(e=>({...e,ipfsImages:Array.isArray(e.ipfsImages)?e.ipfsImages:"string"==typeof e.ipfsImages?JSON.parse(e.ipfsImages):null}))}async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,a=(0,l.eO)(t,20);if(!r){var i;let{error:t,data:l}=await e.auth.getUser();if(t)throw(0,s.vV)("Error fetching user for following posts",t),Error("Failed to retrieve authenticated user.");if(!(r=null==l?void 0:null===(i=l.user)||void 0===i?void 0:i.id))throw Error("User ID is undefined.")}let{data:o,error:n}=await e.from("follows").select("followee_id").eq("follower_id",r);if(n)throw(0,s.vV)("Error fetching user followings",n),n;let d=o.map(e=>e.followee_id);if(0===d.length)return[];let{data:c,error:u}=await e.from("posts").select("*").in("author",d).eq("isPrivate",!1).eq("isDraft",!1).order("createdAt",{ascending:!1}).range(a[0],a[1]);if(u)throw(0,s.vV)("Supabase error fetching following posts",u),Error(u.message);return c.map(e=>({...e,ipfsImages:Array.isArray(e.ipfsImages)?e.ipfsImages:"string"==typeof e.ipfsImages?JSON.parse(e.ipfsImages):null}))}},19111:(e,t,r)=>{"use strict";r.d(t,{k:()=>c});var l=r(83137),a=r(80364),s=r(84532),i=r(25303);let o=async(e,t)=>{if(!e)return(0,i.FF)("No userId provided. Returning default stats"),{followeeCount:0,followerCount:0};try{let{count:r,error:l}=await t.from("follows").select("*",{count:"exact",head:!0}).eq("follower_id",e);if(l)throw(0,i.vV)("Supabase follower count error",l),Error("Error fetching follower count: ".concat(l.message));let{count:a,error:s}=await t.from("follows").select("*",{count:"exact",head:!0}).eq("followee_id",e);if(s)throw(0,i.vV)("Supabase followee count error",s),Error("Error fetching followee count: ".concat(s.message));return{followerCount:r||0,followeeCount:a||0}}catch(e){throw(0,i.vV)("Server error in getFollowStats",e),e}};var n=r(57178),d=r(76648);function c(e){var t,r;let i=(0,l.useQueryClient)(),c=(0,a.useQuery)({queryKey:["followStats",e],queryFn:async()=>e?(0,n.zO)("followStats-".concat(e),()=>o(e,s.N)):{followeeCount:0,followerCount:0},enabled:!!e,staleTime:6e5,gcTime:18e5}),u=(0,d.useCallback)(t=>{e&&(i.setQueryData(["followStats",e],e=>e?{...e,followeeCount:e.followeeCount+1}:{followeeCount:1,followerCount:0}),t&&i.setQueryData(["followStats",t],e=>e?{...e,followerCount:e.followerCount+1}:{followeeCount:0,followerCount:1}))},[e,i]),f=(0,d.useCallback)(t=>{e&&(i.setQueryData(["followStats",e],e=>e?{...e,followeeCount:Math.max(0,e.followeeCount-1)}:{followeeCount:0,followerCount:0}),t&&i.setQueryData(["followStats",t],e=>e?{...e,followerCount:Math.max(0,e.followerCount-1)}:{followeeCount:0,followerCount:0}))},[e,i]),p=(0,d.useCallback)(()=>{e&&i.invalidateQueries({queryKey:["followStats",e],exact:!0})},[e,i]);return{...c,incrementFolloweeCount:u,decrementFolloweeCount:f,refreshStats:p,followeeCount:(null===(t=c.data)||void 0===t?void 0:t.followeeCount)||0,followerCount:(null===(r=c.data)||void 0===r?void 0:r.followerCount)||0}}},22439:(e,t,r)=>{"use strict";r.d(t,{r:()=>c});var l=r(83137),a=r(80364),s=r(84532),i=r(25303);let o=async(e,t)=>{if(!e)return 0;try{let{count:r,error:l}=await t.from("likes").select("*",{count:"exact"}).eq("post_author",e);if(l)return(0,i.vV)("Error fetching like count",l),0;return r||0}catch(e){return(0,i.vV)("Unexpected error",e),0}};var n=r(57178),d=r(76648);let c=e=>{let t=(0,l.useQueryClient)(),r=(0,a.useQuery)({queryKey:["likeStat",e],queryFn:async()=>e?(0,n.zO)("likeStat-".concat(e),()=>o(e,s.N)):0,enabled:!!e,staleTime:6e5,gcTime:18e5}),i=(0,d.useCallback)(()=>{e&&t.setQueryData(["likeStat",e],e=>(e||0)+1)},[e,t]),c=(0,d.useCallback)(()=>{e&&t.setQueryData(["likeStat",e],e=>Math.max(0,(e||0)-1))},[e,t]),u=(0,d.useCallback)(()=>{e&&t.invalidateQueries({queryKey:["likeStat",e],exact:!0})},[e,t]);return{...r,incrementLikeStat:i,decrementLikeStat:c,refreshLikeStat:u,likeCount:r.data||0}}},34055:(e,t,r)=>{Promise.resolve().then(r.bind(r,68434))},34561:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var l=r(71844);function a(e){let{value:t,title:r,leftBorder:a}=e;return(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center gap-2 border-primary-6 px-5 ".concat(a&&"border-l-[1px]"),children:[(0,l.jsx)("p",{className:"text-xl text-primary-5",children:t}),(0,l.jsx)("p",{className:"text-primary-6",children:r})]})}},37039:(e,t,r)=>{"use strict";r.d(t,{v7:()=>u,zW:()=>f});var l=r(71844),a=r(76648),s=r(79621),i=r(23609);let o=()=>({isActive:!1}),n={isActive:!1},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;return(0,i.y)()(t=>({...e,startGeneration:()=>t(()=>({isActive:!0})),stopGeneration:()=>t(()=>({isActive:!1}))}))},c=(0,a.createContext)(void 0),u=e=>{let{children:t}=e,r=(0,a.useRef)(null);return r.current||(r.current=d(o())),(0,l.jsx)(c.Provider,{value:r.current,children:t})},f=e=>{let t=(0,a.useContext)(c);if(!t)throw Error("useGenerationStore must be used within GenerationStoreProvider");return(0,s.P)(t,e)}},47019:(e,t,r)=>{"use strict";r.d(t,{default:()=>o});var l=r(71844),a=r(76648),s=r(93344),i=r(46032);function o(){let[e,t]=(0,a.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h1",{className:"text-center text-4xl text-primary-1 nasalization",children:"Create Anything Imaginable"}),(0,l.jsx)("div",{className:"w-4/5 max-w-4xl mt-7",children:(0,l.jsxs)("div",{className:"relative h-12 flex w-full rounded-l-full mb-10",children:[(0,l.jsx)("div",{className:"absolute left-4 top-2.5",children:(0,l.jsx)(i.Bm,{color:"#FFFFFF"})}),(0,l.jsx)("input",{onClick:()=>t(!0),className:"basis-5/6 outline-none indent-12 rounded-l-full bg-primary-12 border-[1px] border-primary-9",placeholder:"Generate stunning AI images in seconds"}),(0,l.jsx)("button",{onClick:()=>t(!0),className:"basis-1/6 text-primary-11 bg-primary-5 font-semibold rounded-r-full px-6",children:"Generate"})]})}),(0,l.jsx)(s.A,{open:e,setOpen:t})]})}},68434:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>el});var l=r(71844),a=r(76648),s=r(69626),i=r(79677),o=r(46032);let n=(0,a.memo)(function(e){let{text:t}=e,r=(0,s.useRouter)(),[n,d]=(0,a.useTransition)();(0,s.useSearchParams)();let c=(0,s.usePathname)(),{activeTab:u,setActiveTab:f}=(0,i.t)(),p=t.toLowerCase(),m=u.toLowerCase()===p,h=(0,a.useCallback)(()=>{m||(f(t.toUpperCase()),d(()=>{r.push("".concat(c,"?s=").concat(p))}))},[r,c,p,m,f,t]);return(0,l.jsxs)("div",{className:"relative rounded-full cursor-pointer overflow-hidden",children:[(0,l.jsxs)("button",{onClick:h,className:"rounded-full px-4 py-2 text-sm md:text-base font-medium ".concat(m?"bg-primary-10":"text-primary-6 bg-opacity-0"," flex items-center gap-2"),children:[(()=>{let e=m?"#F0F0F0":"#5D5D5D";switch(t){case"Explore":return(0,l.jsx)(o.fC,{color:e,width:16,height:16});case"Following":return(0,l.jsx)(o.ny,{color:e,width:16,height:16});case"Top":return(0,l.jsx)(o.gX,{color:e,width:16,height:16});case"Search":return(0,l.jsx)(o.WI,{color:e,width:16,height:16});default:return null}})(),t]}),m&&(0,l.jsx)("div",{className:"hidden md:flex  absolute w-[90px] h-[2px] -bottom-[1px] left-0 right-0 mx-auto"})]})});var d=r(47019),c=r(31203);function u(e){let{currentIndex:t,index:r,text:a,setCurrentIndex:s,section:i}=e;return(0,l.jsx)("button",{className:"flex justify-center items-center gap-x-2 py-2 px-4 border-primary-1 ".concat(t===r?"border-b-2":""),onClick:()=>s(r),children:(0,l.jsx)("p",{style:{color:t===r?"#DADADA":"#5D5D5D"},children:a})})}function f(e){let{currentIndex:t,setCurrentIndex:r,section:a="creation"}=e;return(0,l.jsxs)("div",{className:"flex gap-x-8 border-b-[1px] border-primary-11",children:[(0,l.jsx)(u,{currentIndex:t,index:0,text:"User",setCurrentIndex:r,section:a}),(0,l.jsx)(u,{currentIndex:t,index:1,text:"Image",setCurrentIndex:r,section:a})]})}var p=r(9686);r(8795);var m=r(14669),h=r(89100),x=r(58425),v=r(29595),g=r(80903),w=r(85502),b=r(24281),y=r(19102),j=r(83137),N=r(72528),C=r(84532),F=r(25303);let I=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;if(!(null==e?void 0:e.trim()))return[];let l=Math.max(0,(t-1)*r),{data:a,error:s}=await C.N.from("posts_with_rank").select("*").eq("isPrivate",!1).eq("isDraft",!1).textSearch("prompt",e,{type:"websearch",config:"english"}).order("rank",{ascending:!1}).order("id",{ascending:!1}).range(l,l+(r-1));if(s)throw(0,F.vV)("Supabase post search error",s),Error(s.message);return a.map(e=>{var t,r,l,a,s,i,o,n,d,c;return{...e,id:null!==(t=e.id)&&void 0!==t?t:0,prompt:null!==(r=e.prompt)&&void 0!==r?r:"",author:null!==(l=e.author)&&void 0!==l?l:"",caption:null!==(a=e.caption)&&void 0!==a?a:"",category:null!==(s=e.category)&&void 0!==s?s:"",cpu:null!==(i=e.cpu)&&void 0!==i?i:0,createdAt:null!==(o=e.createdAt)&&void 0!==o?o:"",device:null!==(n=e.device)&&void 0!==n?n:"",rank:null!==(d=e.rank)&&void 0!==d?d:0,seed:null!==(c=e.seed)&&void 0!==c?c:0,ipfsImages:(()=>{if(Array.isArray(e.ipfsImages))return e.ipfsImages;if("string"==typeof e.ipfsImages)try{return JSON.parse(e.ipfsImages)}catch(t){(0,F.FF)("Failed to parse ipfsImages",{ipfsImages:e.ipfsImages})}return null})()}})};var k=r(57178);let S=function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,l=(0,j.useQueryClient)(),[s,i]=(0,a.useState)(e);(0,a.useEffect)(()=>{let t=setTimeout(()=>{i(e)},300);return()=>clearTimeout(t)},[e]);let o=(0,a.useMemo)(()=>s.trim().toLowerCase(),[s]),n=(0,N.useInfiniteQuery)({queryKey:["posts","search",o,r],queryFn:async e=>{let{pageParam:t=1}=e,l=await I(o,t,r);return l.forEach(e=>{(0,k.jk)("posts",e)}),{data:null!=l?l:[],nextCursor:l.length===r?t+1:void 0}},initialPageParam:1,getNextPageParam:e=>(null==e?void 0:e.data.length)<r?void 0:e.nextCursor,enabled:o.length>2,staleTime:3e5,gcTime:9e5}),d=(0,a.useCallback)(()=>{if(n.hasNextPage&&!n.isFetchingNextPage){var e,t;let a=null===(t=n.data)||void 0===t?void 0:null===(e=t.pages[n.data.pages.length-1])||void 0===e?void 0:e.nextCursor;a&&l.prefetchInfiniteQuery({queryKey:["posts","search",o,r],queryFn:e=>{let{pageParam:t=a}=e;return I(o,t,r)},initialPageParam:a})}},[n.hasNextPage,n.isFetchingNextPage,null===(t=n.data)||void 0===t?void 0:t.pages,l,o,r]);return{...n,prefetchNextPage:d,debouncedKeyword:o}};var A=r(55280);function E(e,t){var r;let{alt:a="",title:s,sizes:i}=e,{photo:o,width:n,height:d,index:c=0}=t,u=c<8,f="object"==typeof o&&null!==o&&"src"in o&&(null===(r=String(o.src).split("/").pop())||void 0===r?void 0:r.split("?")[0])||"search-img-".concat(c);return(0,l.jsx)("div",{style:{width:"100%",position:"relative",aspectRatio:"".concat(n," / ").concat(d)},children:(0,l.jsx)(A.A,{fill:!0,src:o,alt:a||"Search result",title:s,sizes:i||"(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 33vw",loading:u?"eager":"lazy",priority:u,placeholder:"blurDataURL"in o?"blur":void 0,trackPerformance:!1,imageName:f})})}function T(e){var t,r,o;let{searchTerm:n}=e,[d,c]=(0,a.useState)(-1),[u,f]=(0,a.useState)((null===(t=window)||void 0===t?void 0:t.innerWidth)<m.ux?2:4),{initFromUrl:h}=(0,i.t)(),x=(0,s.useSearchParams)();(0,a.useEffect)(()=>{h(x.get("s"))},[x,h]);let{data:b,isLoading:y,isError:j,error:N,fetchNextPage:C,hasNextPage:F,isFetchingNextPage:I}=S(n,10);(0,a.useEffect)(()=>{let e=()=>{f(window.innerWidth<m.ux?2:4)};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}},[]);let k=e=>{c(e.index)};return j?(0,l.jsx)("p",{className:"wrapper",children:"message"in N?N.message:N}):b&&0!==b.pages.length?(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)(g.A,{isLoadingInitial:y,isLoadingMore:I,loadMore:()=>F&&C(),hasNextPage:F,children:(0,l.jsx)(p.A,{photos:(0,w.wK)(null!==(r=null==b?void 0:b.pages)&&void 0!==r?r:[]),columns:u,spacing:4,render:{extras:(e,t)=>(0,l.jsx)(P,{context:t,handleImageIndex:k}),image:E}})}),(0,l.jsx)(v.default,{photo:d>-1&&(0,w.wK)(null!==(o=null==b?void 0:b.pages)&&void 0!==o?o:[])[d],setImageIndex:c})]}):(0,l.jsx)("p",{children:"It looks like you haven't saved any books to this shelf yet."})}function P(e){let{context:t,handleImageIndex:r}=e,a=t.photo.author||"",{data:s,isLoading:i}=(0,b.A)(a),{data:o,isLoading:n}=(0,y.A)(a);return(0,l.jsx)(h.A,{setImageIndex:()=>r(t),context:t,children:(0,l.jsx)("div",{className:"absolute flex items-center gap-1 bottom-2 left-2",children:!i&&!n&&s&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"rounded-full",children:o?(0,l.jsx)(x.default,{className:"rounded-full border-[1px] border-primary-3 drop-shadow-lg",src:o,width:24,height:24,alt:"profile"}):(0,l.jsx)("div",{className:"w-6 h-6 bg-gray-300 rounded-full"})}),(0,l.jsx)("p",{className:"font-semibold text-sm drop-shadow-lg",children:s})]})})})}var q=r(77710),_=r(40178),z=r(34561);let D=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;if(!(null==e?void 0:e.trim()))return[];let l=Math.max(0,(t-1)*r),{data:a,error:s}=await C.N.from("profiles").select("*, posts:posts(*)").textSearch("search_vector",e,{type:"websearch",config:"english"}).order("createdAt",{ascending:!1}).range(l,l+(r-1));if(s)throw(0,F.vV)("Supabase user search error",s),Error(s.message);return a.map(e=>{var t;return{id:e.id,full_name:e.full_name||"",username:e.display_name||e.full_name||"",avatar_url:e.avatar_url,createdAt:null!==(t=e.createdAt)&&void 0!==t?t:"",posts:Array.isArray(e.posts)?e.posts.slice(0,10).map(e=>{var t;return{...e,createdAt:null!==(t=e.createdAt)&&void 0!==t?t:"",ipfsImages:(()=>{if(Array.isArray(e.ipfsImages))return e.ipfsImages;if("string"==typeof e.ipfsImages)try{return JSON.parse(e.ipfsImages)}catch(t){(0,F.FF)("Failed to parse ipfsImages",{ipfsImages:e.ipfsImages})}return null})()}}):[]}})},O=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(0,N.useInfiniteQuery)({queryKey:["posts",e.trim(),t],queryFn:async r=>{let{pageParam:l=1}=r,a=await D(e,l,t);return{data:null!=a?a:[],nextCursor:a.length===t?l+1:void 0}},initialPageParam:1,getNextPageParam:e=>{var t;return null!==(t=null==e?void 0:e.nextCursor)&&void 0!==t?t:void 0},enabled:e.trim().length>2,staleTime:3e5})};var L=r(19111),Q=r(22439),V=r(97349),K=r(83672),R=r(80738),U=r(62953),M=r.n(U);function G(e){var t;let{searchTerm:r}=e,{data:a,isLoading:s,isError:i,error:o,fetchNextPage:n,hasNextPage:d,isFetchingNextPage:c}=O(r,10);return(0,l.jsx)("div",{children:null==a?void 0:null===(t=a.pages)||void 0===t?void 0:t.flatMap(e=>e.data.map(e=>(0,l.jsx)(B,{data:e,posts:e.posts},e.id)))})}function B(e){var t,r;let{data:a,posts:s}=e,{data:i}=(0,L.k)(a.id),{data:o}=(0,Q.r)(a.id),{userId:n}=(0,K.J)(),{data:d,isLoading:c}=(0,V.j)(n,a.id),u=(0,R.T)();return(0,l.jsxs)("div",{className:"bg-primary-11 rounded-t-3xl my-3",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center h-16 py-4 px-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(M(),{href:"/home/profile/".concat(a.id),className:"w-10 h-10 bg-primary-9 rounded-full",children:(0,l.jsx)(x.default,{src:a.avatar_url||"/profile.jpg",width:40,height:40,alt:"profile",className:"rounded-full"})}),(0,l.jsx)(M(),{href:"/home/profile/".concat(a.id),className:"text-primary-1 text-lg w-36 font-normal",children:a.username}),n!==a.id&&(0,l.jsx)("button",{disabled:u.isPending,onClick:()=>{u.mutate({followerId:n,followeeId:a.id})},className:"flex items-center justify-center gap-1 rounded-full h-8 w-24 px-2 py-1 border-[1px] border-primary-8\n    ".concat(d?"bg-transparent":"bg-primary-10"),children:(0,l.jsx)("p",{className:"text-primary-5 text-sm",children:c?"Loading...":d?"Unfollow":"Follow"})})]}),(0,l.jsxs)("div",{className:"flex gap-x-4 my-4",children:[(0,l.jsx)(z.A,{value:(null==i?void 0:null===(t=i.followeeCount)||void 0===t?void 0:t.toString())||"0",title:(null==i?void 0:i.followeeCount)===1?"Follower":"Followers"}),(0,l.jsx)(z.A,{value:(null==i?void 0:null===(r=i.followerCount)||void 0===r?void 0:r.toString())||"0",title:(null==i||i.followerCount,"Following"),leftBorder:!0}),(0,l.jsx)(z.A,{value:(null==o?void 0:o.toString())||"0",title:1===o?"Like":"Likes",leftBorder:!0})]})]}),(0,l.jsx)("div",{className:"overflow-x-auto whitespace-nowrap",children:s.map((e,t)=>(0,l.jsx)(J,{post:e},t))})]})}function J(e){var t,r,a;let{post:s}=e;return(0,l.jsxs)(M(),{href:"home/photo/".concat(s.id),className:"relative inline-block w-[306px] cursor-pointer",children:[(0,l.jsxs)("div",{className:"absolute top-0 flex justify-between text-primary-1 text-sm picture-gradient w-full h-12 items-center px-3",children:[(0,l.jsx)("p",{children:(0,q.f)(s.createdAt)}),(0,l.jsx)("button",{children:(0,l.jsx)(o.Ys,{color:"#FFFFFF"})})]}),(0,l.jsx)(x.default,{src:(0,w.Qp)(null===(t=s.ipfsImages)||void 0===t?void 0:t[0].hash,null===(a=s.ipfsImages)||void 0===a?void 0:null===(r=a[0].fileNames)||void 0===r?void 0:r[0],s.author),width:306,height:408,alt:"generated"}),(0,l.jsx)("p",{className:"absolute bottom-0 left-0 w-full text-left text-primary-1 text-sm picture-gradient h-14 p-3",children:(0,_.EJ)(s.caption||s.prompt,3)})]})}var W=r(41084);function X(){let[e,t]=(0,a.useState)(0),[r,s]=(0,a.useState)(!1),[i,n]=(0,a.useState)(!1),[d,c]=(0,a.useState)(""),[u]=(0,W.d7)(d,500);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{className:"flex gap-x-1 h-9 w-10 items-center justify-center rounded-full ".concat(i?"bg-primary-10":""),onClick:()=>s(!0),onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:(0,l.jsx)(o.WI,{width:16,height:16,color:i?"#8F8F8F":"#5D5D5D"})}),r&&(0,l.jsxs)("div",{className:"fixed z-50  top-0  h-full w-screen bg-gray-950/50",children:[(0,l.jsx)("div",{onClick:()=>s(!1),className:"m-auto z-50  top-0 left-0 h-screen w-screen bg-gray-950/50"}),(0,l.jsxs)("div",{className:"absolute w-full max-w-[1034px] h-[90vh] z-50 top-2 md:top-[5vh] left-0 md:left-60 border-primary-8 border-[1px] bg-primary-12 rounded-xl p-4",children:[(0,l.jsxs)("div",{className:"flex justify-between text-primary-3",children:[(0,l.jsx)("p",{className:"nasalization text-2xl",children:"Search for Anything Imaginable"}),(0,l.jsx)("div",{className:"cursor-pointer",onClick:()=>s(!1),children:(0,l.jsx)(o.US,{width:24,height:24,color:"#C1C1C1"})})]}),(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"relative h-14 w-full my-3 rounded-xl bg-primary-10",children:[(0,l.jsx)("button",{className:"absolute top-[18px] left-3 z-10",children:(0,l.jsx)(o.WI,{width:20,height:20,color:"#8F8F8F"})}),(0,l.jsx)("input",{type:"text",placeholder:"Search for anything imaginable",value:d,onChange:e=>c(e.target.value),className:"absolute text-primary-2 placeholder:text-primary-2 bg-inherit left-0 top-0 w-full h-14 px-10 rounded-lg border-[1px] border-primary-11 border-none focus:outline-none focus:ring-0"})]})}),(0,l.jsx)("div",{className:"my-2",children:(0,l.jsx)(f,{currentIndex:e,setCurrentIndex:t})}),(0,l.jsxs)("div",{className:"overflow-y-auto h-[70vh]",children:[0===e&&(0,l.jsx)(G,{searchTerm:u}),1===e&&(0,l.jsx)(T,{searchTerm:u})]})]})]})]})}var Z=r(85921),Y=r(64707),H=r(6733),$=r(16610);function ee(){return(0,l.jsx)("div",{className:"h-screen w-screen top-0  left-0 fixed z-50 flex items-center justify-center ",children:(0,l.jsx)(x.default,{src:"/Icon-White.png",alt:"unreal",height:50,width:50,priority:!0})})}function et(e){let{children:t,searchType:r}=e,[s,i]=(0,a.useState)(!1),o=(0,j.useQueryClient)();return((0,a.useEffect)(()=>{(async()=>{await o.prefetchInfiniteQuery({queryKey:["posts",r||"explore"],queryFn:async e=>{let{pageParam:t=0}=e,l=[];return{data:null!=(l=(null==r?void 0:r.toUpperCase())==="EXPLORE"?await (0,$.K5)(C.N,t):(null==r?void 0:r.toUpperCase())==="FOLLOWING"?await (0,$.BS)(C.N,t):(null==r?void 0:r.toUpperCase())==="TOP"?await (0,$.rt)(C.N,t):await (0,$.K5)(C.N,t))?l:[],nextCursor:l.length>0?t+1:void 0}},initialPageParam:0,getNextPageParam:e=>{var t;return null!==(t=null==e?void 0:e.nextCursor)&&void 0!==t?t:void 0}}),i(!0)})()},[r,o]),s)?(0,l.jsx)(Y.HydrationBoundary,{state:(0,H.hw)(o),children:t}):(0,l.jsx)(ee,{})}let er=(0,c.default)(()=>r.e(10702).then(r.bind(r,10702)),{loadableGenerated:{webpack:()=>[10702]},ssr:!0,loading:()=>(0,l.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2  w-full ",children:Array(12).fill(null).map((e,t)=>(0,l.jsx)(Z.A,{height:200,baseColor:"#1a1a1a",highlightColor:"#333"},t))})});function el(){let e=(0,s.useSearchParams)(),t=(null==e?void 0:e.get("s"))||"";return(0,l.jsx)(et,{searchType:t,children:(0,l.jsxs)("div",{className:"relative flex flex-col items-center background-color-primary-1 px-1 md:px-10 w-full",children:[(0,l.jsx)("div",{className:"hidden md:flex flex-col justify-center items-center pt-5 w-full",children:(0,l.jsx)(d.default,{})}),(0,l.jsxs)("div",{className:"flex gap-x-2 items-center w-full h-10 mt-3 md:mt-0 mb-2 relative",children:[(0,l.jsx)(X,{}),(0,l.jsx)(n,{text:"Explore"}),(0,l.jsx)(n,{text:"Following"}),(0,l.jsx)(n,{text:"Top"})]}),(0,l.jsx)("div",{className:"overflow-y-auto w-full",children:(0,l.jsx)(er,{})})]})})}},79677:(e,t,r)=>{"use strict";r.d(t,{t:()=>l});let l=(0,r(79621).v)(e=>({activeTab:"EXPLORE",isTabTransitioning:!1,previousTab:null,setActiveTab:t=>e(e=>{let r=e.activeTab!==t;return{activeTab:t,isTabTransitioning:r,previousTab:r?e.activeTab:e.previousTab}}),setIsTabTransitioning:t=>e({isTabTransitioning:t}),initFromUrl:t=>{if(!t)return;let r=t.toUpperCase();["EXPLORE","FOLLOWING","TOP","SEARCH"].includes(r)&&e(e=>({previousTab:e.activeTab!==r?e.activeTab:e.previousTab,activeTab:r,isTabTransitioning:!1}))}}))},80903:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var l=r(71844),a=r(76648),s=r(85921);r(68336);let i=function(e){let t=(0,a.useRef)(null),{isLoadingInitial:r,isLoadingMore:i,children:o,loadMore:n,hasNextPage:d}=e;return(0,a.useEffect)(()=>{let e=new IntersectionObserver(function(e){e.forEach(e=>{!e.isIntersecting||i||r||n()})},{root:null,rootMargin:"100px",threshold:0});return t.current&&e.observe(t.current),()=>e.disconnect()},[i,r,n]),(0,l.jsxs)("div",{className:"mb-32 w-full",children:[r&&(0,l.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2  w-full ",children:Array(12).fill(null).map((e,t)=>(0,l.jsx)(s.A,{height:200,baseColor:"#1a1a1a",highlightColor:"#333"},t))}),!r&&(0,l.jsx)(l.Fragment,{children:o}),(0,l.jsx)("div",{ref:t,id:"obs",children:i&&d&&(0,l.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2  w-full p-2 ",children:[,,,,].fill(null).map((e,t)=>(0,l.jsx)(s.A,{height:200,baseColor:"#1a1a1a",highlightColor:"#333"},t))})})]})}},89100:(e,t,r)=>{"use strict";r.d(t,{A:()=>v});var l=r(71844),a=r(76648),s=r(46032),i=r(40178),o=r(5430),n=r(84532),d=r(57760),c=r(83672),u=r(77710),f=r(1667),p=r(3593),m=r(69626),h=r(62953),x=r.n(h);function v(e){let{hideContent:t,children:r,setImageIndex:h,context:v,photo:g,section:w}=e,b=(0,m.useRouter)(),[y,j]=(0,a.useState)(!1),{userId:N}=(0,c.J)(),{likes:C,likesCount:F,isLoading:I,hasUserLiked:k}=(0,o.G)(Number(v.photo.id),n.N),{mutate:S}=(0,d.$)(Number(v.photo.id),N,v.photo.author),A=null==C?void 0:C.some(e=>e.author===N),E=()=>{h()},{data:T,isLoading:P}=(0,f._9)(v.photo.id);(0,f.nU)(v.photo.id);let q=()=>{b.push("/home/photo/"+v.photo.id)};return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{onMouseEnter:()=>j(!0),onMouseLeave:()=>j(!1),className:"absolute top-0 left-0 w-full h-full flex flex-col text-primary-1 text-sm md:hover:bg-gray-900/50",children:[y&&(0,l.jsxs)("div",{className:"relative hidden md:flex flex-col text-primary-1 justify-between px-4 py-3 h-full",children:[(0,l.jsxs)("div",{onClick:q,className:"absolute top-0 left-0 w-full h-full",children:[" ",g," "]}),(0,l.jsx)("div",{onClick:q,className:"absolute top-0 left-0 w-full h-full cursor-pointer"}),t?(0,l.jsx)("div",{children:" "}):(0,l.jsxs)("div",{className:"flex justify-between text-primary-1 text-sm z-20",children:[(0,l.jsx)("p",{children:(0,u.f)(v.photo.createdAt)}),(0,l.jsx)(p.A,{image:v.photo,postId:v.photo.id,children:(0,l.jsx)(s.Ys,{color:"#FFFFFF"})})]}),(0,l.jsxs)("div",{className:"flex justify-center gap-4 z-10",children:[(0,l.jsxs)("button",{className:"flex gap-1 items-center",onClick:()=>S(),children:[A?(0,l.jsx)(s.zw,{color:"#FFFFFF"}):(0,l.jsx)(s.C3,{color:"#FFFFFF"}),(0,l.jsx)("p",{children:C?(0,i.ZV)(null==C?void 0:C.length):""})]}),(0,l.jsxs)("button",{className:"flex gap-1 items-center",onClick:()=>E(),children:[(0,l.jsx)(s.oy,{color:"#FFFFFF"})," ",(0,l.jsx)("p",{children:T?(0,i.ZV)(null==T?void 0:T.length):""})]})]}),t?(0,l.jsx)("p",{}):(0,l.jsxs)(x(),{href:"/home/photo/".concat(v.photo.id),children:[" ",(0,l.jsx)("p",{className:"text-left text-primary-1 text-sm z-10",children:(0,i.EJ)(v.photo.caption||v.photo.prompt)})]})]}),(0,l.jsxs)("div",{className:"flex flex-col md:hidden h-full w-full justify-between items-end p-3",children:[(0,l.jsx)("div",{className:"relative block mr-4",children:(0,l.jsx)("div",{className:"absolute",children:(0,l.jsx)("div",{className:"absolute z-20",children:(0,l.jsx)(p.A,{image:v.photo,postId:v.photo.id,children:(0,l.jsx)(s.Ys,{color:"#FFFFFF"})})})})}),(0,l.jsxs)("div",{className:"flex flex-col ".concat("photoGridTwo"==w?" mb-12":"mb-6"),children:[(0,l.jsxs)("div",{className:"relative flex flex-col items-center",children:[(0,l.jsx)("button",{className:"absolute flex flex-col items-center z-10",onClick:()=>S(),children:A?(0,l.jsx)(s.zw,{color:"#FFFFFF"}):(0,l.jsx)(s.C3,{color:"#FFFFFF"})}),(0,l.jsx)("p",{className:"mt-6 z-10",children:C?(0,i.ZV)(null==C?void 0:C.length):""})]}),(0,l.jsxs)("div",{className:"relative flex flex-col items-center",children:[(0,l.jsx)("button",{className:"absolute flex gap-1 items-center z-10",onClick:E,children:(0,l.jsx)(s.oy,{color:"#FFFFFF"})}),(0,l.jsx)("p",{className:"mt-6 z-10",children:T?(0,i.ZV)(null==T?void 0:T.length):""})]})]})]}),(0,l.jsxs)("div",{onClick:q,className:"absolute hidden md:block w-full h-full",children:[!y&&r," "]}),(0,l.jsxs)("div",{onClick:q,className:"absolute  md:hidden w-full h-full",children:[r," "]})]})})}},93344:(e,t,r)=>{"use strict";r.d(t,{A:()=>j});var l=r(71844),a=r(84532),s=r(37039),i=r(84808),o=r(34489),n=r(86976),d=r(25303);let c=e=>{var t;let{prompt:r,user:l,stopGeneration:a}=e;if(!l){(0,d.vV)("User is undefined, cannot send job request",Error("No user"));return}if(!(null===(t=l.wallet)||void 0===t?void 0:t.privateKey)){(0,d.vV)("Missing private key, cannot proceed",Error("No private key"));return}let s=l.id,c={module:"isdxl",version:"v1.6.0",inputs:{Prompt:r,cpu:34,ram:"70gb",Device:"xpu",Seed:o.Ay.int(1e3,1e8),N:1,Format:"webp"},author:s,category:"GENERATION"},u={"Content-Type":"application/json"};l.creditBalance<=0&&(u.Authorization="Bearer ".concat(l.wallet.privateKey)),i.P.post("/api/darts",c,{headers:u}).catch(e=>{var t;a(),n.oR.error("Error sending job request:",(null===(t=e.response)||void 0===t?void 0:t.data)||e.message),(0,d.vV)("Error sending job request",e)})};var u=r(69626),f=r(76648),p=r(83137),m=r(54265),h=r(83672),x=r(62198),v=r(65025),g=r(40178),w=r(23948),b=r(6135);let y=(0,g.yt)(w.h,"0x37719927bbf857b4e2c0195aee74e7b3f1161a77");function j(e){var t,r,i;let{open:o,setOpen:g}=e,{user:w}=(0,h.J)(),{mutate:j,isGenerating:N,progress:C,cancelJob:F}=function(e){let t=(0,u.useRouter)(),r=(0,p.useQueryClient)(),{startGeneration:l,stopGeneration:i}=(0,s.zW)(e=>e),[o,n]=(0,f.useState)(!1),[h,x]=(0,f.useState)(0),v=(0,m.useMutation)({mutationFn:async t=>{let{prompt:r}=t;if(!r)throw Error("Prompt is required");if(!e)throw Error("User must be logged in");n(!0),x(0),l();try{return await c({prompt:r,user:e,stopGeneration:i}),x(100),{success:!0}}catch(e){throw n(!1),i(),e}},onError:e=>{(0,d.vV)("Error creating job",e),n(!1),i(),r.invalidateQueries({queryKey:["posts"]})},retry:(e,t)=>!(t.message.includes("Prompt is required")||t.message.includes("User must be logged in"))&&e<2}),g=(0,f.useCallback)(()=>{n(!1),x(0),i()},[i]);return(0,f.useEffect)(()=>{if(!e)return;let l=a.N.channel("user_posts_channel").on("postgres_changes",{event:"INSERT",schema:"public",table:"posts"},l=>{l.new.author===e.id&&(n(!1),x(100),i(),r.invalidateQueries({queryKey:["posts"]}),t.push("/home/photo/".concat(l.new.id,"?a=").concat(l.new.author)))}).subscribe();return()=>{a.N.removeChannel(l)}},[e,t,i,r]),{...v,cancelJob:g,isGenerating:o,progress:h,generationState:{isGenerating:o,progress:h}}}(w),[I,k]=(0,f.useState)(null),[S,A]=(0,f.useState)(!1),[E,T]=(0,f.useState)(!1),{data:P,refetch:q}=(0,v.Q)({contract:y,method:"function balanceOf(address account) returns (uint256)",params:[(null==w?void 0:null===(t=w.wallet)||void 0===t?void 0:t.address)||""]}),_=async()=>{var e;if(!(null==I?void 0:I.trim())){n.oR.error("Please provide a prompt.");return}if((null!==(e=null==w?void 0:w.creditBalance)&&void 0!==e?e:0)+Number((0,b.ck)(null!=P?P:BigInt(0)))<1){n.oR.error("Credit balance too low.");return}T(!0),j({prompt:I},{onSuccess:()=>{T(!1),z()},onError:e=>{T(!1),n.oR.error("Error generating image: ".concat(e.message))}})},z=()=>{g(!1)};if(o)return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{onClick:z,className:"fixed z-30 top-0 left-0 h-screen w-full"}),(0,l.jsxs)("div",{className:"absolute flex justify-center z-30 top-0 left-0 h-screen w-full",children:[(0,l.jsx)("div",{onClick:z,className:"absolute z-30 top-0 left-0 h-screen w-full"}),(0,l.jsx)("div",{className:"absolute z-50 md:mt-20 w-full md:w-8/12 max-w-[924px] h-5/6 md:h-[432px] rounded-md border-primary-8 border-[1px] p-3 bg-primary-12",children:(0,l.jsxs)("div",{className:"flex flex-col bg-primary-13 h-full w-full rounded-md",children:[(0,l.jsx)("div",{className:"flex-grow",children:(0,l.jsx)("textarea",{onChange:e=>k(e.target.value),className:"bg-inherit w-full h-full resize-none outline-none p-4 text-primary-8 placeholder:text-primary-8"})}),(0,l.jsxs)("div",{className:"h-14 p-2 w-full flex justify-end border-t-[1px] border-primary-11 gap-2",children:[(0,l.jsx)("button",{onClick:z,className:"basis-1/12 text-primary-5 border-primary-11 border-[1px] font-semibold rounded-full px-6",children:"Close"}),(0,l.jsx)(x.A,{open:S,setOpen:A,refetch:q}),(null!==(r=null==w?void 0:w.creditBalance)&&void 0!==r?r:0)+(P?Number((0,b.ck)(P))/3:0)<1&&(0,l.jsx)("button",{onClick:()=>A(!0),className:"basis-1/6 text-primary-11 bg-primary-5 font-semibold rounded-full px-6",children:"Top Up"}),(null!==(i=null==w?void 0:w.creditBalance)&&void 0!==i?i:0)+(P?Number((0,b.ck)(P))/3:0)>=1&&(0,l.jsx)("button",{onClick:_,className:"basis-1/6 text-primary-11 bg-primary-5 font-semibold rounded-full px-6",children:"Generate"})]})]})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[15842,97833,56550,17643,16022,50380,30475,19382,34489,41921,31922,65275,29595,99954,67227,77358],()=>t(34055)),_N_E=e.O()}]);