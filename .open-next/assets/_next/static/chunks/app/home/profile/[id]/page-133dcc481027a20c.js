try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="e0bb69cb-d496-463a-aae5-dff8cb79b297",e._sentryDebugIdIdentifier="sentry-dbid-e0bb69cb-d496-463a-aae5-dff8cb79b297")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[55680],{19111:(e,t,a)=>{"use strict";a.d(t,{k:()=>u});var r=a(83137),l=a(80364),i=a(84532),n=a(25303);let s=async(e,t)=>{if(!e)return(0,n.FF)("No userId provided. Returning default stats"),{followeeCount:0,followerCount:0};try{let{count:a,error:r}=await t.from("follows").select("*",{count:"exact",head:!0}).eq("follower_id",e);if(r)throw(0,n.vV)("Supabase follower count error",r),Error("Error fetching follower count: ".concat(r.message));let{count:l,error:i}=await t.from("follows").select("*",{count:"exact",head:!0}).eq("followee_id",e);if(i)throw(0,n.vV)("Supabase followee count error",i),Error("Error fetching followee count: ".concat(i.message));return{followerCount:a||0,followeeCount:l||0}}catch(e){throw(0,n.vV)("Server error in getFollowStats",e),e}};var o=a(57178),d=a(76648);function u(e){var t,a;let n=(0,r.useQueryClient)(),u=(0,l.useQuery)({queryKey:["followStats",e],queryFn:async()=>e?(0,o.zO)("followStats-".concat(e),()=>s(e,i.N)):{followeeCount:0,followerCount:0},enabled:!!e,staleTime:6e5,gcTime:18e5}),c=(0,d.useCallback)(t=>{e&&(n.setQueryData(["followStats",e],e=>e?{...e,followeeCount:e.followeeCount+1}:{followeeCount:1,followerCount:0}),t&&n.setQueryData(["followStats",t],e=>e?{...e,followerCount:e.followerCount+1}:{followeeCount:0,followerCount:1}))},[e,n]),m=(0,d.useCallback)(t=>{e&&(n.setQueryData(["followStats",e],e=>e?{...e,followeeCount:Math.max(0,e.followeeCount-1)}:{followeeCount:0,followerCount:0}),t&&n.setQueryData(["followStats",t],e=>e?{...e,followerCount:Math.max(0,e.followerCount-1)}:{followeeCount:0,followerCount:0}))},[e,n]),p=(0,d.useCallback)(()=>{e&&n.invalidateQueries({queryKey:["followStats",e],exact:!0})},[e,n]);return{...u,incrementFolloweeCount:c,decrementFolloweeCount:m,refreshStats:p,followeeCount:(null===(t=u.data)||void 0===t?void 0:t.followeeCount)||0,followerCount:(null===(a=u.data)||void 0===a?void 0:a.followerCount)||0}}},22439:(e,t,a)=>{"use strict";a.d(t,{r:()=>u});var r=a(83137),l=a(80364),i=a(84532),n=a(25303);let s=async(e,t)=>{if(!e)return 0;try{let{count:a,error:r}=await t.from("likes").select("*",{count:"exact"}).eq("post_author",e);if(r)return(0,n.vV)("Error fetching like count",r),0;return a||0}catch(e){return(0,n.vV)("Unexpected error",e),0}};var o=a(57178),d=a(76648);let u=e=>{let t=(0,r.useQueryClient)(),a=(0,l.useQuery)({queryKey:["likeStat",e],queryFn:async()=>e?(0,o.zO)("likeStat-".concat(e),()=>s(e,i.N)):0,enabled:!!e,staleTime:6e5,gcTime:18e5}),n=(0,d.useCallback)(()=>{e&&t.setQueryData(["likeStat",e],e=>(e||0)+1)},[e,t]),u=(0,d.useCallback)(()=>{e&&t.setQueryData(["likeStat",e],e=>Math.max(0,(e||0)-1))},[e,t]),c=(0,d.useCallback)(()=>{e&&t.invalidateQueries({queryKey:["likeStat",e],exact:!0})},[e,t]);return{...a,incrementLikeStat:n,decrementLikeStat:u,refreshLikeStat:c,likeCount:a.data||0}}},34561:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var r=a(71844);function l(e){let{value:t,title:a,leftBorder:l}=e;return(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center gap-2 border-primary-6 px-5 ".concat(l&&"border-l-[1px]"),children:[(0,r.jsx)("p",{className:"text-xl text-primary-5",children:t}),(0,r.jsx)("p",{className:"text-primary-6",children:a})]})}},44644:(e,t,a)=>{"use strict";a.d(t,{default:()=>U});var r=a(71844),l=a(76648),i=a(83137),n=a(46032),s=a(34561),o=a(19111),d=a(22439),u=a(69626),c=a(84532),m=a(25303);let p=async(e,t)=>{if(!e)return null;try{let{data:a,error:r}=await t.from("profiles").select("*").eq("id",e).single();if(r)return(0,m.vV)("Error fetching user profile with ID: ".concat(e),r),null;if(!a)return null;return{id:a.id,wallet:a.wallet,bio:a.bio,location:a.location,creditBalance:a.credit_balance,full_name:a.full_name,username:a.display_name||a.full_name,avatar_url:a.avatar_url}}catch(e){return(0,m.vV)("Unexpected error",e),null}};var h=a(80364),f=a(57178),y=a(83672);function x(e){let t=(0,i.useQueryClient)(),{userId:a}=(0,y.J)(),r=(0,h.useQuery)({queryKey:["profile_data",e],queryFn:async()=>{if(!e)return null;let t=(0,m.Lk)("getUserData","data-fetching",{profileId:e});try{let a=(0,f.QH)("users",e);if(a)return t(),a;let r=await (0,f.zO)("user-profile-".concat(e),async()=>{let t=(0,m.Lk)("getUserById","database-query",{profileId:e}),a=await p(e,c.N);return t(),a});return r&&(0,f.jk)("users",{...r,id:e}),t(),r}catch(e){throw t(),e}},enabled:!!e,staleTime:3e5,gcTime:18e5,retry:1}),n=(0,l.useCallback)(a=>{if(!e)return;let r=(0,m.Lk)("updateUserDataOptimistically","client-update",{profileId:e,updateFields:Object.keys(a)});(0,m.Rm)("Current data in cache",t.getQueryData(["profile_data",e])),(0,m.Rm)("Applying updates",a);let l=["full_name","display_name","bio"],i={};Object.entries(a).forEach(e=>{let[t,a]=e;(l.includes(t)||"display_name"===t||"firstname"===t||"lastname"===t)&&(i[t]=a)}),t.setQueryData(["profile_data",e],t=>{if(!t)return t;i.display_name&&(i.username=i.display_name);let a={...t,...i};return(0,m.Rm)("New data after merge",a),(0,f.jk)("users",{...a,id:e}),a}),r()},[e,t]),s=(0,l.useMemo)(()=>!!a&&a===e,[a,e]);return{...r,updateUserDataOptimistically:n,isOwnProfile:s,profileId:e}}let g=async(e,t)=>{if(!t)return;let a=(0,m.Lk)("prefetchUserData","prefetching",{userId:t});if(e.getQueryData(["profile_data",t])){a();return}return e.prefetchQuery({queryKey:["profile_data",t],queryFn:async()=>(0,f.zO)("user-profile-".concat(t),async()=>{let e=(0,m.Lk)("getUserById","database-query",{userId:t}),r=await p(t,c.N);return e(),r&&(0,f.jk)("users",{...r,id:t}),a(),r}),staleTime:3e5})};var b=a(85921);a(68336);let v=()=>(0,r.jsxs)("div",{className:"flex flex-col md:flex-row pt-5 w-full mb-12 gap-4",children:[(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("div",{className:"w-28 h-28 md:w-52 md:h-52",children:(0,r.jsx)(b.A,{circle:!0,height:"100%",baseColor:"#1a1a1a",highlightColor:"#333"})}),(0,r.jsxs)("div",{className:"block md:hidden",children:[(0,r.jsx)(b.A,{width:150,height:32,baseColor:"#1a1a1a",highlightColor:"#333"}),(0,r.jsxs)("div",{className:"flex my-4 gap-3",children:[(0,r.jsx)(b.A,{width:112,height:36,baseColor:"#1a1a1a",highlightColor:"#333"}),(0,r.jsx)(b.A,{width:48,height:36,baseColor:"#1a1a1a",highlightColor:"#333"})]})]})]}),(0,r.jsxs)("div",{className:"flex-grow text-primary-5",children:[(0,r.jsxs)("div",{className:"hidden md:block",children:[(0,r.jsx)(b.A,{width:200,height:32,baseColor:"#1a1a1a",highlightColor:"#333"}),(0,r.jsxs)("div",{className:"flex my-4 gap-3",children:[(0,r.jsx)(b.A,{width:112,height:36,baseColor:"#1a1a1a",highlightColor:"#333"}),(0,r.jsx)(b.A,{width:48,height:36,baseColor:"#1a1a1a",highlightColor:"#333"})]})]}),(0,r.jsxs)("div",{className:"flex gap-x-4 my-4",children:[(0,r.jsx)(b.A,{width:80,height:32,baseColor:"#1a1a1a",highlightColor:"#333"}),(0,r.jsx)(b.A,{width:80,height:32,baseColor:"#1a1a1a",highlightColor:"#333"}),(0,r.jsx)(b.A,{width:80,height:32,baseColor:"#1a1a1a",highlightColor:"#333"})]}),(0,r.jsx)(b.A,{width:50,height:24,baseColor:"#1a1a1a",highlightColor:"#333"}),(0,r.jsx)(b.A,{width:"80%",height:18,count:2,baseColor:"#1a1a1a",highlightColor:"#333"})]}),(0,r.jsx)("div",{className:"hidden md:block",children:(0,r.jsx)(b.A,{width:120,height:40,baseColor:"#1a1a1a",highlightColor:"#333"})})]});var w=a(15365);function j(e){let{openProfile:t,deleteProfile:a}=e;return(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("button",{onClick:t,className:"flex h-12 items-center gap-2",children:[(0,r.jsx)(n.kG,{color:"#C1C1C1"}),(0,r.jsx)("p",{className:"text-primary-6",children:"Edit Profile"})]}),(0,r.jsxs)("button",{onClick:a,className:"flex h-11 items-center gap-2",children:[(0,r.jsx)(n.d7,{color:"#FF5252"}),(0,r.jsx)("p",{className:"text-[#FF5252]",children:"Delete Account Permanently"})]})]})}var C=a(84808);let N=()=>{let[e,t]=(0,l.useState)(!1),[a,r]=(0,l.useState)(null),i=(0,u.useRouter)();return{deleteAccount:async()=>{var e,a,l;t(!0),r(null),(0,m.Rm)("Account deletion process initiated");try{let{data:t,error:a}=await c.N.auth.getUser();if(a||!t.user){let e="You need to be logged in.";throw(0,m.vV)(e,a||Error(e)),Error(e)}let{data:r}=await c.N.auth.getSession();(0,m.Rm)("Sending account deletion request",{userId:t.user.id});let l=await C.P.delete("/api/account/delete",{headers:{"Content-Type":"application/json"},data:{userId:t.user.id,token:null===(e=r.session)||void 0===e?void 0:e.access_token}});return 200===l.status&&((0,m.Rm)("Account deleted successfully, logging out user"),await c.N.auth.signOut(),i.push("/")),{success:!0}}catch(t){let e=(null===(l=t.response)||void 0===l?void 0:null===(a=l.data)||void 0===a?void 0:a.error)||t.message||"An unexpected error occurred";return(0,m.vV)("Account deletion failed",t),r(e),{success:!1,error:e}}finally{t(!1)}},loading:e,error:a}};var _=a(86976);function k(e){let{closeAction:t}=e,{deleteAccount:a,loading:i,error:n}=N(),[s,o]=(0,l.useState)(""),d=async e=>{if(e.preventDefault(),"DELETE"!==s){_.oR.error("Please enter the correct confirmation");return}await a()};return(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("p",{className:"text-primary-7 text-sm",children:["Deleting your account will permanently remove your profile, credits, and all associated data, including your generated images and history. Any remaining credits will be lost, and this action is irreversible. To confirm, type ",(0,r.jsx)("strong",{className:"text-primary-5",children:"DELETE"})," in the field below."]}),(0,r.jsxs)("form",{children:[(0,r.jsx)("label",{className:"text-primary-4 mb-2 block",children:"Confirm Account Deletion"}),(0,r.jsx)("input",{className:"block border-[1px] border-primary-10 h-14 w-full rounded-2xl bg-inherit outline-none placeholder:text-primary-7 indent-4",type:"text",placeholder:"Enter DELETE to proceed",onChange:e=>o(e.target.value)}),(0,r.jsxs)("div",{className:"flex justify-end h-12 mb-4 mt-8 text-primary-6 gap-4",children:[(0,r.jsx)("button",{onClick:t,className:"border-primary-10 w-40 border-[1px] rounded-full",children:"Cancel"}),(0,r.jsx)("button",{className:"".concat("DELETE"!==s?"border-primary-10":"bg-primary-10 "," w-40 rounded-full text-primary-3 disabled:bg-primary-11 disabled:text-primary-9"),disabled:"DELETE"!==s,type:"button",onClick:d,children:"Delete Account"})]})]})]})}var P=a(40178),D=a(54265);let E=()=>{let e=(0,i.useQueryClient)(),t=(0,l.useRef)(null),a=(0,l.useRef)(null),r=(0,D.useMutation)({mutationFn:async e=>{let{user:t,id:a,preserveFields:r=!1}=e;if(!a)throw Error("User ID is required");let l={},i=["full_name","display_name","bio"];if(Object.entries(t).forEach(e=>{let[t,a]=e;i.includes(t)&&void 0!==a&&(l[t]=a)}),0===Object.keys(l).length)return(0,m.Rm)("No valid fields to update"),t;(0,m.Rm)("Final updates to send to API:",l);let{data:n,error:s}=await c.N.from("profiles").update(l).eq("id",a).select();if(s)throw Error(s.message);let o={...t,...(null==n?void 0:n[0])||{}};return o.credit_balance&&0!==o.credit_balance&&(o.creditBalance=o.credit_balance),o},onMutate:async t=>{let{user:a,id:r}=t;await Promise.all([e.cancelQueries({queryKey:["user"]}),e.cancelQueries({queryKey:["profile_data",r]}),e.cancelQueries({queryKey:["user",r]})]);let l=e.getQueryData(["user"]),i=e.getQueryData(["profile_data",r]),n=e.getQueryData(["user",r]);if(e.setQueryData(["user"],e=>e&&e.user?{...e,user:{...e.user,...a}}:e),e.setQueryData(["profile_data",r],e=>e?{...e,...a}:e),r){let e=(0,f.QH)("users",r)||{};(0,m.Rm)("Existing entity before update",e),(0,m.Rm)("Updates being applied",a);let t={...a};t.username=a.display_name,(0,m.Rm)("Enhanced client cache update",t),(0,f.jk)("users",{...e,...t,id:r})}return{previousUser:l,previousProfile:i,previousUserData:n,id:r}},onError:(t,a,r)=>{let{id:l}=a;(0,m.vV)("Error updating user details:",t),_.oR.error("Failed to update profile: ".concat(t.message)),(null==r?void 0:r.previousUser)&&e.setQueryData(["user"],r.previousUser),(null==r?void 0:r.previousProfile)&&e.setQueryData(["profile_data",l],r.previousProfile),(null==r?void 0:r.previousUserData)&&e.setQueryData(["user",l],r.previousUserData)},onSuccess:(t,a)=>{let{id:r}=a;_.oR.success("Profile updated successfully"),(0,f.jk)("users",{id:r,...t}),t.avatar_url&&(e.invalidateQueries({queryKey:["user"]}),e.invalidateQueries({queryKey:["profile_data",r]}),e.invalidateQueries({queryKey:["user",r]}))}}),n=(0,l.useCallback)((l,i)=>{if((0,m.Rm)("Throttled update called with",{id:l,updates:i}),a.current){(0,m.Rm)("Existing pending updates",a.current);let e=(i.hasOwnProperty("firstname")||i.hasOwnProperty("lastname"))&&!i.hasOwnProperty("display_name")&&a.current.user.display_name;a.current={id:l,user:{...a.current.user,...i}},e&&((0,m.Rm)("Preserving display_name when combining updates with first/last name changes"),a.current.user.display_name=a.current.user.display_name),(0,m.Rm)("Combined pending updates",a.current);return}a.current={user:i,id:l},(0,m.Rm)("Stored pending update",a.current),t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{if(a.current){var i,n;(0,m.Rm)("Processing throttled update");let s=e.getQueryData(["profile_data",l]);if((0,m.Rm)("Current profile data from cache",s),s){let e={},n=(null===(i=a.current)||void 0===i?void 0:i.user)||{},o=["full_name","display_name","bio"];if((n.hasOwnProperty("firstname")||n.hasOwnProperty("lastname"))&&!n.hasOwnProperty("display_name")&&s.display_name&&((0,m.Rm)("Name update detected - explicitly preserving display_name",s.display_name),n.display_name=s.display_name),Object.entries(n).forEach(t=>{let[a,r]=t;o.includes(a)&&void 0!==r&&(e[a]=r)}),!e.full_name&&(n.hasOwnProperty("firstname")||n.hasOwnProperty("lastname"))){(0,m.Rm)("Handling firstname/lastname update");let t=n.firstname||(s.full_name?s.full_name.split(" ")[0]:""),a=n.lastname||(s.full_name&&s.full_name.split(" ").length>1?s.full_name.split(" ").slice(1).join(" "):"");e.full_name="".concat(t," ").concat(a).trim(),(0,m.Rm)("Setting full_name from first/last name",e.full_name)}if(e.full_name&&!e.display_name&&s.display_name&&((0,m.Rm)("Re-checking display_name is preserved during name update"),e.display_name=s.display_name),0===Object.keys(e).length){(0,m.Rm)("No valid fields to update, skipping"),a.current=null,t.current=null;return}(0,m.Rm)("Final update data to send to API",e),r.mutate({user:e,id:l,preserveFields:!0})}else{(0,m.Rm)("No current data found, using safer update approach");let e={},t=(null===(n=a.current)||void 0===n?void 0:n.user)||{},i=["full_name","display_name","bio"];Object.entries(t).forEach(t=>{let[a,r]=t;i.includes(a)&&void 0!==r&&(e[a]=r)}),Object.keys(e).length>0&&r.mutate({user:e,id:l,preserveFields:!0})}a.current=null,t.current=null}},500)},[r,e]),s=(0,l.useCallback)((e,t,a)=>r.mutate({user:{[t]:a},id:e}),[r]),o=(0,l.useCallback)((t,a)=>{let l=e.getQueryData(["profile_data",t]),i={},n=["full_name","display_name","bio"];return Object.entries(a).forEach(e=>{let[t,a]=e;n.includes(t)&&void 0!==a&&(i[t]=a)}),i.full_name&&!i.display_name&&(null==l?void 0:l.display_name)&&(i.display_name=l.display_name),r.mutate({user:i,id:t,preserveFields:!0})},[r,e]);return{...r,updateUserField:s,throttledUpdateUser:n,updateViewedProfile:o}};var A=a(58425);function R(e){let{profileId:t,closeAction:a}=e,{user:i}=(0,y.J)(),{data:n,updateUserDataOptimistically:s}=x(t),{updateViewedProfile:o,throttledUpdateUser:d}=E(),[u,c]=(0,l.useState)((0,P.W0)((null==n?void 0:n.full_name)||"").firstName),[p,h]=(0,l.useState)((0,P.W0)((null==n?void 0:n.full_name)||"").lastName),[f,g]=(0,l.useState)((null==n?void 0:n.full_name)||""),[b,v]=(0,l.useState)((null==n?void 0:n.bio)||""),[w,j]=(0,l.useState)((null==n?void 0:n.display_name)||(null==n?void 0:n.username)||""),[C]=(0,l.useState)((null==i?void 0:i.email)||"");return(0,l.useEffect)(()=>{if(n){let{firstName:e,lastName:t}=(0,P.W0)(n.full_name||"");c(e),h(t),g(n.full_name||""),v(n.bio||""),j(n.display_name||n.username||""),(0,m.Rm)("Updated display name from profile data",{displayName:n.display_name||n.username||""})}},[n]),(0,l.useEffect)(()=>{u||p?g("".concat(u," ").concat(p)):g("")},[u,p]),(0,r.jsx)("div",{className:"flex flex-col gap-3",children:(0,r.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!t){_.oR.error("Cannot update profile: User ID is missing");return}if((0,m.Rm)("Profile update initiated",{full_name:f,displayName:w}),!f||!w){_.oR.error("Please fill in all fields.");return}(0,m.Rm)("Current profile data before update",{profileData:n});let r={full_name:f,bio:b,display_name:w};(0,m.Rm)("Sending profile updates",r),s(r),o(t,r),a()},className:"grid grid-cols-2 gap-5 text-primary-8 text-sm",children:[(0,r.jsxs)("div",{className:"col-span-2 py-3 border-b-[1px] border-primary-9",children:[(0,r.jsx)("label",{className:"mb-2 block text-primary-2",children:"Profile photo"}),(0,r.jsx)("div",{children:(0,r.jsx)(A.default,{className:"rounded-full",src:(null==n?void 0:n.avatar_url)||"/profile.jpg",width:80,height:80,alt:""})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"mb-1 block",children:"First Name"}),(0,r.jsx)("input",{className:"block border-[1px] border-primary-10 h-14 w-full rounded-2xl bg-inherit outline-none text-primary-5 placeholder:text-primary-7 indent-4",type:"text",placeholder:"Jon",value:u,onChange:e=>{c(e.target.value)}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"mb-1 block",children:"Last Name"}),(0,r.jsx)("input",{className:"block border-[1px] border-primary-10 h-14 w-full rounded-2xl bg-inherit outline-none text-primary-5 placeholder:text-primary-7 indent-4",type:"text",placeholder:"Doe",value:p,onChange:e=>{h(e.target.value)}})]}),(0,r.jsxs)("div",{className:"col-span-2",children:[(0,r.jsx)("label",{className:"text-primary-4 mb-1 block",children:"Display name"}),(0,r.jsx)("input",{className:"block border-[1px] border-primary-10 h-14 w-full rounded-2xl bg-inherit outline-none text-primary-5 placeholder:text-primary-7 indent-4",type:"text",placeholder:"Jon Doe",value:w,onChange:e=>{j(e.target.value)}})]}),(0,r.jsxs)("div",{className:"col-span-2",children:[(0,r.jsx)("label",{className:"mb-1 block",children:"Email Address"}),(0,r.jsx)("input",{className:"block border-[1px] border-primary-10 h-14 w-full rounded-2xl bg-inherit outline-none text-primary-5 placeholder:text-primary-7 indent-4",type:"text",placeholder:"Jondoe@gmail.com",readOnly:!0,value:C})]}),(0,r.jsxs)("div",{className:"col-span-2",children:[(0,r.jsx)("label",{className:"text-primary-4 mb-1 block",children:"Bio"}),(0,r.jsx)("input",{className:"block border-[1px] border-primary-10 h-14 w-full rounded-2xl bg-inherit outline-none text-primary-5 placeholder:text-primary-7 indent-4",type:"text",placeholder:"Enter your bio",value:b,onChange:e=>{v(e.target.value)}})]}),(0,r.jsxs)("div",{className:"rounded-2xl flex items-center justify-end col-span-2 space-x-5",children:[(0,r.jsx)("button",{onClick:a,type:"button",className:"cursor-pointer transition duration-300 hover:scale-105 px-8 py-3 rounded-full border-[1px] border-primary-10 text-primary-4",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"bg-primary-1 text-black font-semibold cursor-pointer transition duration-300 hover:scale-105 px-8 py-3 rounded-full",children:"Save"})]})]})})}var S=a(72925),Q=a(62198),F=a(65025),O=a(23948),q=a(6135),I=a(55280);let L=(0,P.yt)(O.h,"0x37719927bbf857b4e2c0195aee74e7b3f1161a77"),T=async e=>((0,m.Rm)("Fetching followers for user ".concat(e)),[]);function U(){var e;let[t,a]=(0,l.useState)(!1),[c,p]=(0,l.useState)(!1),[h,f]=(0,l.useState)(!1),[b,C]=(0,l.useState)(""),N=(0,i.useQueryClient)(),_=(0,u.useParams)().id,{data:P,isLoading:D,error:A,isOwnProfile:O,updateUserDataOptimistically:U}=x(_),{userId:K,user:V,loading:z}=(0,y.J)(),{updateViewedProfile:B}=E(),{followeeCount:M,followerCount:Y}=(0,o.k)(_),{data:J}=(0,d.r)(_),{data:W,refetch:H}=(0,F.Q)({contract:L,method:"function balanceOf(address account) returns (uint256)",params:[(null==V?void 0:null===(e=V.wallet)||void 0===e?void 0:e.address)||""]});if((0,l.useEffect)(()=>{P&&M&&M>0&&(async()=>{try{(await T(_)).slice(0,5).forEach(e=>{g(N,e)})}catch(e){(0,m.vV)("Error prefetching followers",e)}})()},[_,M,N,P]),D||z||!V)return(0,r.jsx)(v,{});if(A)return(0,r.jsxs)("p",{children:["Error loading profile data: ",A.message]});let X=()=>{O&&(a(!0),C("Edit Account"))},G=()=>{a(!1),C("")};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row pt-5 w-full mb-12 gap-4",children:[(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("div",{className:"w-28 h-28 md:w-52 md:h-52",children:(0,r.jsx)(I.A,{className:"rounded-full",src:(null==P?void 0:P.avatar_url)||"/profile.jpg",width:200,height:200,alt:"".concat(null==P?void 0:P.full_name,"'s profile picture"),trackPerformance:!0,imageName:"profile-".concat(_)})}),(0,r.jsxs)("div",{className:"block md:hidden",children:[(0,r.jsx)("p",{className:"text-3xl font-medium",children:null==P?void 0:P.full_name}),(0,r.jsxs)("div",{className:"flex my-4 gap-3",children:[O&&(0,r.jsx)("button",{onClick:X,className:"flex justify-center items-center h-9 w-28 text-primary-4 font-medium text-sm topup-btn-gradient rounded-2xl bg-primary-11",children:(0,r.jsx)("p",{className:"text-sm",children:"Edit Account"})}),(0,r.jsx)("button",{className:"flex justify-center items-center h-9 w-12 text-primary-4 font-medium text-sm topup-btn-gradient rounded-2xl bg-primary-11",children:(0,r.jsx)(n.uX,{width:16,height:16,color:"#DADADA"})})]})]})]}),(0,r.jsxs)("div",{className:"flex-grow text-primary-5",children:[(0,r.jsxs)("div",{className:"hidden md:block",children:[(0,r.jsx)("p",{className:"text-3xl font-medium",children:null==P?void 0:P.full_name}),(0,r.jsxs)("div",{className:"flex my-4 gap-3",children:[O&&(0,r.jsx)("button",{onClick:X,className:"flex justify-center items-center h-9 w-28 text-primary-4 font-medium text-sm topup-btn-gradient rounded-2xl bg-primary-11",children:(0,r.jsx)("p",{className:"text-sm",children:"Edit Account"})}),(0,r.jsx)("button",{onClick:()=>f(!0),className:"flex justify-center items-center h-9 w-12 text-primary-4 font-medium text-sm topup-btn-gradient rounded-2xl bg-primary-11",children:(0,r.jsx)(n.uX,{width:16,height:16,color:"#DADADA"})})]})]}),(0,r.jsxs)("div",{className:"flex gap-x-4 my-4",children:[(0,r.jsx)(s.A,{value:(null==M?void 0:M.toString())||"0",title:1===M?"Follower":"Followers"}),(0,r.jsx)(s.A,{value:(null==Y?void 0:Y.toString())||"0",title:"Following",leftBorder:!0}),(0,r.jsx)(s.A,{value:(null==J?void 0:J.toString())||"0",title:1===J?"Like":"Likes",leftBorder:!0})]}),(0,r.jsx)("p",{className:"text-primary-7 my-4",children:" Bio "}),(0,r.jsxs)("p",{className:"text-primary-7 my-4",children:[" ",null==P?void 0:P.bio," "]})]}),(0,r.jsx)(Q.A,{open:c,setOpen:p,refetch:H}),(0,r.jsx)("div",{className:"hidden md:block",children:O&&(0,r.jsxs)("button",{onClick:()=>p(!0),className:"flex gap-2 whitespace-nowrap text-primary-4 font-medium text-sm topup-btn-gradient p-3 rounded-md bg-primary-11",children:[(0,r.jsx)("div",{children:(0,r.jsx)(n.gX,{width:16,height:16,color:"#DADADA"})}),(0,r.jsx)("p",{children:(()=>{var e;let t=(null!==(e=null==P?void 0:P.creditBalance)&&void 0!==e?e:0)+(W?Number((0,q.ck)(W))/3:0);return"".concat(t.toFixed(2)," Credit").concat(1!==t?"s":"")})()})]})})]}),(0,r.jsx)(S.A,{open:h,setOpen:f,link:"https://unreal.art/home/profile/"+_,isProfile:!0}),(0,r.jsxs)(w.A,{title:b,open:t,setOpen:a,titleColor:"Delete Account"===b?"#FF5252":void 0,children:["Edit Account"===b&&(0,r.jsx)(j,{openProfile:()=>C("Edit Profile"),deleteProfile:()=>C("Delete Account")}),"Delete Account"===b&&(0,r.jsx)(k,{closeAction:G}),"Edit Profile"===b&&P&&(0,r.jsx)(R,{profileId:_,closeAction:G})]})]})}},55280:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var r=a(71844),l=a(40178),i=a(58425),n=a(76648);let s=(0,n.memo)(function(e){var t;let{src:a,alt:s,width:o,height:d,trackPerformance:u=!1,imageName:c,priority:m,sizes:p="100vw",loading:h="lazy",quality:f=80,...y}=e,[x,g]=(0,n.useState)(!1),[b,v]=(0,n.useState)(!1),w=c||("string"==typeof a?(null===(t=a.split("/").pop())||void 0===t?void 0:t.split("?")[0])||"unknown-image":"dynamic-image"),j=(0,n.useCallback)(()=>{v(!0),u&&(0,l.Rm)("Image ".concat(w," failed to load"))},[u,w]);return b?(0,r.jsx)(i.default,{src:"/fallback.png",alt:s,width:o,height:d,priority:m,sizes:p,...y}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.default,{src:a,alt:s,width:o,height:d,priority:m,sizes:p,loading:h,quality:f,...y,onLoadingComplete:()=>{g(!0),u&&(0,l.Rm)("Image ".concat(w," loaded successfully"))},onError:j}),!x&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",style:{backgroundColor:"rgba(0,0,0,0.2)",zIndex:10},children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-white"})})]})})},73846:(e,t,a)=>{"use strict";a.d(t,{default:()=>y});var r=a(71844),l=a(76648),i=a(73079),n=a(46626),s=a(69626),o=a(35426),d=a.n(o),u=a(14669),c=a(83672),m=a(72528),p=a(84532),h=a(17792),f=a(22290);function y(){let e=(0,s.useSearchParams)().get("s"),{id:t}=(0,s.useParams)(),{userId:a}=(0,c.J)(),{profileTab:o,initFromUrl:y,setProfileTab:x}=(0,f.g)(),[g,b]=(0,l.useTransition)(),[v,w]=(0,l.useState)(0);(0,l.useEffect)(()=>{if(e){console.log("ProfileView - Initializing from URL:",e),b(()=>{y("profile",e)});let t=d()(u.ew,e.toUpperCase());t>=0&&b(()=>{w(t)})}},[]);let j=(0,l.useCallback)(e=>{b(()=>{var t;w(e);let a=null===(t=u.ew[e])||void 0===t?void 0:t.toLowerCase();a&&x(a.charAt(0).toUpperCase()+a.slice(1).toLowerCase())})},[x]);(0,l.useEffect)(()=>{if(o){let e=d()(u.ew,o.toUpperCase());e>=0&&e!==v&&b(()=>{w(e)})}},[o,v]);let C=(0,l.useMemo)(()=>e||o||"Public",[e,o]),{isLoading:N,isError:_,error:k,data:P,hasNextPage:D,fetchNextPage:E,isFetchingNextPage:A}=(0,m.useInfiniteQuery)({queryKey:["profile_posts",C,t],queryFn:async e=>{let{pageParam:a=0}=e,r=[],l=C.toUpperCase();return{data:r="PUBLIC"===l?await (0,h.qY)(p.N,a,t):"PRIVATE"===l?await (0,h.rE)(p.N,a,t):"LIKED"===l?await (0,h.i4)(p.N,a,t):"PINNED"===l?await (0,h.Oj)(p.N,a,t):"DRAFT"===l?await (0,h.bC)(p.N,a,t):await (0,h.qY)(p.N,a,t),nextCursor:r.length>0?a+1:void 0}},getNextPageParam:e=>e.nextCursor,initialPageParam:0,staleTime:6e4,gcTime:6e5,refetchOnMount:"always",refetchOnWindowFocus:!1}),R=g||N,S=(0,l.useMemo)(()=>({Public:{title:"Public",content:"You have not published anything yet.",subContent:"Tap your inner artist and create something amazing!"},Private:{title:"Private",content:"You don't have any private post.",subContent:"You can go ahead and create one."},Liked:{title:"Liked",content:"You haven't liked anything yet.",subContent:"Find something you love and tap that \uD83E\uDD0D!"},Pinned:{title:"Pinned",content:"You haven't pinned anything yet.",subContent:"Find something you love and pin it!"},Draft:{title:"Draft",content:"You haven't saved anything yet.",subContent:"Create something you love to post later"}}),[]),Q=(0,l.useCallback)(()=>{if(_&&!g)return(0,r.jsx)("div",{className:"text-center text-red-500",children:"message"in k?k.message:"An error occurred"});let e=S[["Public","Private","Liked","Pinned","Draft"][v]];return e?(0,r.jsx)(n.A,{...e,data:P,isLoading:R,hasNextPage:D,fetchNextPage:E,isFetchingNextPage:A}):null},[R,g,_,k,P,v,S,D,E,A]);return(0,r.jsxs)("div",{className:"w-full ",children:[(0,r.jsx)("div",{className:"w-full mb-4",children:(0,r.jsx)(i.A,{currentIndex:v,setCurrentIndex:j,hideDraft:a!==t,section:"profile"})}),(0,r.jsx)("div",{className:"w-full ",children:Q()})]})}},98516:(e,t,a)=>{Promise.resolve().then(a.bind(a,64707)),Promise.resolve().then(a.bind(a,46874)),Promise.resolve().then(a.bind(a,83137)),Promise.resolve().then(a.bind(a,95460)),Promise.resolve().then(a.bind(a,72528)),Promise.resolve().then(a.bind(a,58948)),Promise.resolve().then(a.bind(a,54265)),Promise.resolve().then(a.bind(a,60272)),Promise.resolve().then(a.bind(a,44971)),Promise.resolve().then(a.bind(a,80364)),Promise.resolve().then(a.bind(a,42268)),Promise.resolve().then(a.bind(a,76136)),Promise.resolve().then(a.bind(a,49632)),Promise.resolve().then(a.bind(a,73846)),Promise.resolve().then(a.bind(a,44644))}},e=>{var t=t=>e(e.s=t);e.O(0,[97833,56550,17643,16022,50380,30475,19382,72422,32377,31922,65275,90384,99954,67227,77358],()=>t(98516)),_N_E=e.O()}]);