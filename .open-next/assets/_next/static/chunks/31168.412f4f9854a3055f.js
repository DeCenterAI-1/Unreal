try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="90ff243c-21c1-4508-ba69-2d9d5e6e2b62",e._sentryDebugIdIdentifier="sentry-dbid-90ff243c-21c1-4508-ba69-2d9d5e6e2b62")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964,31168,96042],{964:(e,t,n)=>{n.d(t,{decimals:()=>a});var o=n(81489),s=n(86880);async function a(e){return(0,o.n)(()=>(0,s.rr)(e),{cacheKey:`${e.contract.chain.id}:${e.contract.address}:decimals`,cacheTime:Number.POSITIVE_INFINITY})}},31168:(e,t,n)=>{n.r(t),n.d(t,{default:()=>tf});var o=n(71844),s=n(32840),a=n(76648),r=n(67889),i=n(18533),c=n(48982),d=n(81445),l=n(37892),u=n(41298),m=n(36811),h=n(84216),p=n(4294),x=n(72980),y=n(32451),f=n(21249),g=n(92277),j=n(40851),k=n(76220),w=n(19236),b=n(60933),C=n(21241),T=n(65185),A=n(65854),v=n(17062),S=n(964),E=n(64865),D=n(51146),I=n(28615),W=n(11203),R=n(28303),z=n(69388),B=n(66518),P=n(16097),L=n(96738),O=n(1344),F=n(98121);function N(e){let{payUiOptions:t,supportedDestinations:n,client:s,onContinue:a,payerAccount:d}=e,l=(0,I.QP)(),u=(0,R.z)(),h=t.metadata,f=t.paymentInfo,{data:g}=(0,W.cj)(f.chain),{data:k}=(0,z.vq)({client:s,address:f.sellerAddress}),w=(0,T.I)({queryKey:["amount",f],queryFn:async()=>{let e,t=18;return f.token&&!(0,C.rk)(f.token)&&(t=await (0,S.decimals)({contract:(0,v.P)({address:f.token.address,chain:f.chain,client:s})})),"amountWei"in f?(0,D.ow)(f.amountWei,t):f.amount}}).data;if(!g||void 0===w)return(0,o.jsx)(m.x,{});let b=f.token?{...f.token,icon:f.token?.icon||n.find(e=>e.chain.id===f.chain.id)?.tokens.find(e=>e.address.toLowerCase()===f.token?.address.toLowerCase())?.icon}:{address:r.DG,name:g.nativeCurrency.name,symbol:g.nativeCurrency.symbol,icon:g.icon?.url};return(0,o.jsxs)(x.mc,{p:"lg",children:[(0,o.jsx)(x.rQ,{title:h?.name||"Payment Details"}),(0,o.jsx)(p.h,{y:"lg"}),(0,o.jsxs)(x.mc,{children:[h?.image?(0,o.jsx)(P.E,{client:s,src:h?.image,style:{width:"100%",borderRadius:c.YK.md,backgroundColor:l.colors.tertiaryBg}}):u?(0,o.jsxs)(x.mc,{flex:"row",center:"both",style:{padding:c.YK.md,marginBottom:c.YK.md,borderRadius:c.YK.md,backgroundColor:l.colors.tertiaryBg},children:[(0,o.jsx)(O.j,{size:c.RK.xl,id:u.id,client:s}),(0,o.jsx)("div",{style:{flexGrow:1,borderBottom:"6px dotted",borderColor:l.colors.secondaryIconColor,marginLeft:c.YK.md,marginRight:c.YK.md}}),(0,o.jsx)(B.P,{client:s,size:c.RK.xl,chainIconUrl:g.icon?.url})]}):null,(0,o.jsx)(p.h,{y:"md"}),(0,o.jsxs)(x.mc,{flex:"row",children:[(0,o.jsx)(x.mc,{flex:"column",expand:!0,children:(0,o.jsx)(F.E,{size:"md",color:"primaryText",weight:700,children:"Price"})}),(0,o.jsx)(x.mc,{expand:!0,children:(0,o.jsxs)(x.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,o.jsx)(L.x,{chain:f.chain,client:e.client,size:"sm",token:b}),(0,o.jsxs)(F.E,{color:"primaryText",size:"md",weight:700,children:[String((0,i.Z)(Number(w),6))," ",b.symbol]})]})})]}),(0,o.jsx)(p.h,{y:"md"}),(0,o.jsx)(x.N1,{}),(0,o.jsx)(p.h,{y:"md"}),(0,o.jsxs)(x.mc,{flex:"row",children:[(0,o.jsx)(x.mc,{flex:"column",expand:!0,children:(0,o.jsx)(F.E,{size:"xs",color:"secondaryText",children:"Network"})}),(0,o.jsx)(x.mc,{expand:!0,children:(0,o.jsxs)(x.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,o.jsx)(B.P,{chainIconUrl:g.icon?.url,size:"xs",client:e.client}),(0,o.jsx)(F.E,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:g.name})]})})]}),(0,o.jsx)(p.h,{y:"sm"}),(0,o.jsxs)(x.mc,{flex:"row",children:[(0,o.jsx)(x.mc,{flex:"column",expand:!0,children:(0,o.jsx)(F.E,{size:"xs",color:"secondaryText",children:"Seller"})}),(0,o.jsx)(x.mc,{expand:!0,children:(0,o.jsx)(x.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:(0,o.jsx)(F.E,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:k||(0,E.Wr)(f.sellerAddress)})})})]})]}),(0,o.jsx)(p.h,{y:"xl"}),d?(0,o.jsx)(y.$n,{variant:"accent",fullWidth:!0,onClick:()=>{(0,A.G)({event:"choose_payment_method_direct_payment_mode",client:s,walletAddress:d.address,walletType:u?.id}),a(w,f.chain,b)},children:"Choose Payment Method"}):(0,o.jsx)("div",{children:(0,o.jsx)(j.p,{...e.connectOptions,client:s,theme:l,connectButton:{style:{width:"100%"}}})})]})}var K=n(41604),M=n(23736),q=n(85745),$=n(18748),_=n(99939),H=n(57369),Y=n(96042),U=n(93254),G=n(61980),Q=n(59353),V=n(85623),Z=n(30949);function J(e){let{payUiOptions:t,client:n,payerAccount:s,supportedDestinations:l,onContinue:h}=e,{data:f,error:k,isLoading:w,refetch:b}=(0,W.cj)(t.transaction.chain),S=t.metadata,{data:E,error:O,isLoading:N,refetch:K}=function(e){let{transaction:t,account:n,supportedDestinations:o}=e,[s,i]=(0,a.useState)();return(0,a.useEffect)(()=>{Promise.all([(0,Q.r)(t.value),(0,Q.r)(t.erc20Value),(0,Q.r)(t.to),(0,U.encode)(t)]).then(([e,t,n,o])=>{i({value:e?.toString(),erc20Value:t?.amountWei?.toString(),erc20Currency:t?.tokenAddress,to:n,data:o})})},[t]),(0,T.I)({queryKey:["transaction-cost",t.chain.id,n?.address,s],queryFn:async()=>{if(!n)throw Error("No payer account found");let e=await (0,Q.r)(t.erc20Value);if(e){let[s,a,r]=await Promise.all([(0,V.m)({address:n.address,chain:t.chain,client:t.client,tokenAddress:e.tokenAddress}),(0,Y.getCurrencyMetadata)({contract:(0,v.P)({address:e.tokenAddress,chain:t.chain,client:t.client})}),(0,G.D)(t,n?.address)]),i=e.amountWei;return{token:{address:e.tokenAddress,name:a.name,symbol:a.symbol,icon:o.find(e=>e.chain.id===t.chain.id)?.tokens.find(t=>t.address.toLowerCase()===e.tokenAddress.toLowerCase())?.icon},decimals:a.decimals,walletBalance:s,gasCostWei:r,transactionValueWei:i}}let[s,a,i]=await Promise.all([(0,V.m)({address:n.address,chain:t.chain,client:t.client}),(0,H.getChainMetadata)(t.chain),(0,G.D)(t,n?.address)]),c=await (0,Q.r)(t.value)||0n;return{token:{address:r.DG,name:a.nativeCurrency.name,symbol:a.nativeCurrency.symbol,icon:a.icon?.url},decimals:18,walletBalance:s,gasCostWei:i,transactionValueWei:c}},enabled:!!t&&!!s,refetchInterval:()=>{if(!t.erc20Value)return 3e4}})}({transaction:t.transaction,account:s,supportedDestinations:l}),J=(0,I.QP)(),X=(0,R.z)(),ee=(0,d.L)(),et=(0,z.UH)(X),en=(0,M.X)({address:ee?.address,chain:t.transaction.chain,tokenAddress:(0,C.rk)(E?.token||C.gr)?void 0:E?.token.address,client:e.client},{enabled:!!E});if(N||w)return(0,o.jsx)(m.x,{});if(!ee)return(0,o.jsx)(x.mc,{style:{minHeight:"350px"},fullHeight:!0,flex:"row",center:"both",children:(0,o.jsxs)(x.mc,{animate:"fadein",children:[(0,o.jsx)(p.h,{y:"xxl"}),(0,o.jsx)(x.mc,{flex:"row",center:"x",children:(0,o.jsx)($.l,{size:c.RK["3xl"]})}),(0,o.jsx)(p.h,{y:"lg"}),(0,o.jsx)(F.E,{center:!0,color:"primaryText",size:"md",children:"Please connect a wallet to continue"}),(0,o.jsx)(p.h,{y:"xl"}),(0,o.jsx)(x.mc,{flex:"row",center:"x",style:{width:"100%"},children:(0,o.jsx)(j.p,{client:n,theme:J,...e.connectOptions})})]})});if(O||k)return(0,o.jsx)(x.mc,{style:{minHeight:"350px"},fullHeight:!0,flex:"row",center:"both",children:(0,o.jsx)(u.W,{title:O?.message||k?.message||"Something went wrong",onTryAgain:O?K:b})});if(!E||!f)return(0,o.jsx)(m.x,{});let eo=en.data&&en.data.value<E.transactionValueWei;return(0,o.jsxs)(x.mc,{p:"lg",children:[(0,o.jsx)(x.rQ,{title:S?.name||"Transaction"}),(0,o.jsx)(p.h,{y:"lg"}),(0,o.jsxs)(x.mc,{children:[S?.image?(0,o.jsx)(P.E,{client:n,src:S?.image,style:{width:"100%",borderRadius:c.YK.md,border:`1px solid ${J.colors.borderColor}`,backgroundColor:J.colors.tertiaryBg}}):ee?(0,o.jsxs)(x.mc,{flex:"column",gap:"sm",children:[eo&&(0,o.jsx)(F.E,{size:"sm",color:"danger",style:{textAlign:"center"},children:"Insufficient funds"}),(0,o.jsxs)(x.mc,{flex:"row",style:{justifyContent:"space-between",padding:c.YK.sm,marginBottom:c.YK.sm,borderRadius:c.YK.md,backgroundColor:J.colors.tertiaryBg,border:`1px solid ${J.colors.borderColor}`},children:[(0,o.jsx)(Z.k,{address:ee?.address,iconSize:"md",client:n}),en.data?(0,o.jsxs)(x.mc,{flex:"row",gap:"3xs",center:"y",children:[(0,o.jsx)(F.E,{size:"xs",color:"secondaryText",weight:500,children:(0,_.j)(en.data,!1)}),(0,o.jsx)(g.C,{token:E.token,chain:t.transaction.chain,size:"xs",color:"secondaryText"})]}):(0,o.jsx)(q.E,{width:"70px",height:c.J.xs})]})]}):null,(0,o.jsx)(p.h,{y:"md"}),(0,o.jsxs)(x.mc,{flex:"row",children:[(0,o.jsx)(x.mc,{flex:"column",expand:!0,children:(0,o.jsx)(F.E,{size:"md",color:"primaryText",weight:700,children:"Price"})}),(0,o.jsx)(x.mc,{expand:!0,children:(0,o.jsxs)(x.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,o.jsx)(L.x,{chain:t.transaction.chain,client:e.client,size:"sm",token:E.token}),(0,o.jsxs)(F.E,{color:"primaryText",size:"md",weight:700,children:[String((0,i.Z)(Number((0,D.ow)(E.transactionValueWei,E.decimals)),6))," ",E.token.symbol]})]})})]}),(0,o.jsx)(p.h,{y:"md"}),(0,o.jsx)(x.N1,{}),(0,o.jsx)(p.h,{y:"md"}),(0,o.jsxs)(x.mc,{flex:"row",children:[(0,o.jsx)(x.mc,{flex:"column",expand:!0,children:(0,o.jsx)(F.E,{size:"xs",color:"secondaryText",children:"Gas Fees"})}),(0,o.jsx)(x.mc,{expand:!0,children:(0,o.jsx)(x.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:(0,o.jsx)(F.E,{color:et?"success":"primaryText",size:"xs",children:et?"Sponsored":`${String((0,i.Z)(Number((0,D.ow)(E.gasCostWei,f.nativeCurrency.decimals)),6))} ${f.nativeCurrency.symbol}`})})})]}),(0,o.jsx)(p.h,{y:"sm"}),(0,o.jsxs)(x.mc,{flex:"row",children:[(0,o.jsx)(x.mc,{flex:"column",expand:!0,children:(0,o.jsx)(F.E,{size:"xs",color:"secondaryText",children:"Network"})}),(0,o.jsx)(x.mc,{expand:!0,children:(0,o.jsxs)(x.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,o.jsx)(B.P,{chainIconUrl:f.icon?.url,size:"xs",client:e.client}),(0,o.jsx)(F.E,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:f.name})]})})]})]}),(0,o.jsx)(p.h,{y:"xl"}),s?(0,o.jsx)(y.$n,{variant:"accent",fullWidth:!0,onClick:()=>{let e=E.transactionValueWei;E.token.address!==r.DG||et||(e+=E.gasCostWei),(0,A.G)({event:"choose_payment_method_transaction_mode",client:n,walletAddress:s.address,walletType:X?.id}),h((0,D.ow)(e,E.decimals),t.transaction.chain,E.token)},children:"Choose Payment Method"}):(0,o.jsx)("div",{children:(0,o.jsx)(j.p,{...e.connectOptions,client:n,theme:J,connectButton:{style:{width:"100%"}}})})]})}var X=n(99059),ee=n(90239);function et(e){return(0,o.jsxs)(x.mc,{children:[(0,o.jsx)(x.mc,{p:"lg",children:(0,o.jsx)(x.rQ,{title:"Pay with",onBack:e.onBack})}),(0,o.jsx)(x.N1,{}),(0,o.jsx)(p.h,{y:"lg"}),(0,o.jsx)(x.mc,{flex:"column",gap:"xs",px:"lg",children:ee.qx.map(t=>(0,o.jsxs)(en,{fullWidth:!0,variant:"secondary",onClick:()=>e.onSelect(t),gap:"sm",children:[(0,ee.E4)(t,"lg"),(0,o.jsxs)(x.mc,{flex:"column",gap:"xxs",children:[(0,o.jsx)(F.E,{color:"primaryText",children:t.shorthand}),(0,o.jsx)(F.E,{size:"sm",children:t.name})]})]},t.shorthand))}),(0,o.jsx)(p.h,{y:"lg"})]})}let en=(0,X.A)(y.$n)(()=>{let e=(0,I.QP)();return{background:e.colors.tertiaryBg,justifyContent:"flex-start",gap:c.YK.sm,padding:c.YK.sm,"&:hover":{background:e.colors.secondaryButtonBg,transform:"scale(1.01)"},transition:"background 200ms ease, transform 150ms ease"}});var eo=n(91512),es=n(63928),ea=n(77969),er=n(35962);async function ei(e){try{let t=(0,es.KI)(e.client),n=await t((0,er._5)(),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:(0,ea.A)({toAddress:e.toAddress,fromCurrencySymbol:e.fromCurrencySymbol,toChainId:e.toChainId.toString(),toTokenAddress:e.toTokenAddress,fromAmount:e.fromAmount,toAmount:e.toAmount,maxSlippageBPS:e.maxSlippageBPS,isTestMode:e.isTestMode,purchaseData:e.purchaseData,fromAddress:e.fromAddress,toGasAmountWei:e.toGasAmountWei,preferredProvider:e.preferredProvider,multiHopSupported:!0})});if(!n.ok){let e=await n.json();if(e&&"error"in e)throw e;throw Error(`HTTP error! status: ${n.status}`)}return(await n.json()).result}catch(e){throw console.error("Error getting buy with fiat quote",e),e}}var ec=n(92970);let ed="Unable to get price quote";function el(e){return"object"==typeof e.error&&e.error.code&&"MINIMUM_PURCHASE_AMOUNT"===e.error.code?{code:"MINIMUM_PURCHASE_AMOUNT",message:"Purchase amount is too low"}:{code:"UNABLE_TO_GET_PRICE_QUOTE",message:ed}}var eu=n(30073),em=n(29167),eh=n(21731),ep=n(9137),ex=n(28516),ey=n(22200);function ef(){let e=(0,eu._)(["\n  from {\n    opacity: 0;\n    transform: translateY(100px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n"]);return ef=function(){return e},e}let eg=(0,a.forwardRef)(function(e,t){return(0,o.jsx)(ej,{ref:t,children:(0,o.jsx)(ex.X,{children:(0,o.jsxs)(x.mc,{p:"lg",children:[(0,o.jsx)(ey.w,{children:(0,o.jsx)(y.K0,{type:"button","aria-label":"Close",onClick:e.close,children:(0,o.jsx)(eo.MKb,{width:c.RK.md,height:c.RK.md,style:{color:"inherit"}})})}),e.children]})})})}),ej=(0,ep.jx)(e=>{let t=(0,I.QP)();return{zIndex:1e4,borderTopLeftRadius:c.r8.xl,borderTopRightRadius:c.r8.xl,background:t.colors.modalBg,position:"absolute",bottom:0,left:0,right:0,animation:"".concat(ek," 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.1)"),borderTop:"1px solid ".concat(t.colors.borderColor)}}),ek=(0,em.i7)(ef()),ew=(0,ep.jx)(e=>({backgroundColor:(0,I.QP)().colors.modalOverlayBg,zIndex:9999,position:"absolute",inset:0,animation:"".concat(eh.I0," 400ms cubic-bezier(0.16, 1, 0.3, 1)")}));function eb(){let[e,t]=(0,a.useState)(!1),n=(0,a.useRef)(null),o=(0,a.useRef)(null),s=(0,a.useCallback)(()=>new Promise(e=>{if(n.current){var t;let s={easing:"cubic-bezier(0.175, 0.885, 0.32, 1.1)",fill:"forwards",duration:300},a=n.current.animate([{transform:"translateY(100%)",opacity:0}],s);null===(t=o.current)||void 0===t||t.animate([{opacity:0}],s),a.onfinish=()=>e()}else e()}),[]),r=(0,a.useCallback)(async e=>{e?t(!0):(await s(),t(!1))},[s]);return(0,a.useLayoutEffect)(()=>{if(!e)return;let t=e=>{n.current&&e.target instanceof Node&&!n.current.contains(e.target)&&r(!1)};return requestAnimationFrame(()=>{document.addEventListener("click",t)}),()=>{document.removeEventListener("click",t)}},[e,r]),{drawerRef:n,drawerOverlayRef:o,setIsOpen:r,isOpen:e}}var eC=n(21859);function eT(e){let{estimatedSeconds:t,quoteIsLoading:n}=e;return(0,o.jsxs)(x.mc,{bg:"tertiaryBg",flex:"row",borderColor:"borderColor",style:{borderRadius:c.r8.md,borderTopLeftRadius:0,borderTopRightRadius:0,justifyContent:"space-between",alignItems:"center",borderWidth:"1px",borderStyle:"solid"},children:[(0,o.jsxs)(x.mc,{flex:"row",center:"y",gap:"xxs",color:"accentText",p:"sm",children:[(0,o.jsx)(eo.O4,{width:c.RK.sm,height:c.RK.sm}),n?(0,o.jsx)(q.E,{height:c.J.xs,width:"50px",color:"borderColor"}):(0,o.jsx)(F.E,{size:"xs",color:"secondaryText",children:void 0!==t?`~${function(e){if(e>3600){let t=Math.floor(e/3600),n=Math.floor(e%3600/60);return`${t} Hours ${n} Minutes`}if(e>60){let t=Math.ceil(e/60);return`${t} Minutes`}return`${e}s`}(t)}`:"--"})]}),(0,o.jsxs)(y.$n,{variant:"ghost",onClick:e.onViewFees,gap:"xs",children:[(0,o.jsx)(x.mc,{color:"accentText",flex:"row",center:"both",children:(0,o.jsx)(eA,{size:c.RK.sm})}),(0,o.jsx)(F.E,{size:"xs",color:"secondaryText",children:"View Fees"})]})]})}let eA=e=>(0,o.jsxs)("svg",{width:e.size,height:e.size,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M9.5 1.5H2.5C1.94772 1.5 1.5 1.94772 1.5 2.5V9.5C1.5 10.0523 1.94772 10.5 2.5 10.5H9.5C10.0523 10.5 10.5 10.0523 10.5 9.5V2.5C10.5 1.94772 10.0523 1.5 9.5 1.5Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M4.5 7.5L7.5 4.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]});function ev(e){return(0,o.jsxs)(x.mc,{bg:"tertiaryBg",borderColor:"borderColor",flex:"row",style:{borderRadius:c.r8.md,borderBottomRightRadius:0,borderBottomLeftRadius:0,borderWidth:"1px",borderStyle:"solid",borderBottom:"none",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)(eS,{variant:"ghost",onClick:e.onSelectCurrency,style:{minHeight:"64px",justifyContent:"flex-start",minWidth:"50%"},gap:"sm",children:[(0,ee.E4)(e.currency,"md"),(0,o.jsxs)(x.mc,{flex:"row",center:"y",gap:"xxs",color:"secondaryText",children:[(0,o.jsx)(F.E,{color:"primaryText",children:e.currency.shorthand}),(0,o.jsx)(eo.D3D,{width:c.RK.sm,height:c.RK.sm})]})]}),(0,o.jsx)("div",{style:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:c.YK.xxs,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",justifyContent:"center",paddingRight:c.YK.sm},children:e.isLoading?(0,o.jsx)(q.E,{width:"100px",height:c.J.lg}):(0,o.jsx)(F.E,{size:"lg",color:e.value?"primaryText":"secondaryText",children:e.value?`${e.currency.symbol}${(0,i.Z)(Number(e.value),6)}`:"--"})})]})}let eS=(0,X.A)(y.$n)(()=>({"&[disabled]:hover":{borderColor:"transparent"}}));function eE(e){return(0,o.jsx)(x.mc,{flex:"column",gap:"xs",style:{alignItems:"flex-start"},children:e.quote.processingFees.map(e=>{let t=(0,i.Z)(Number(e.amount),6);return(0,o.jsxs)(x.mc,{flex:"row",gap:"xxs",children:[(0,o.jsxs)(F.E,{color:"primaryText",size:"sm",children:[0===t?"~":"",t," ",e.token.symbol]}),(0,o.jsxs)(F.E,{color:"secondaryText",size:"sm",children:["($",(e.amountUSDCents/100).toFixed(2),")"]})]},`${e.token.chainId}_${e.token.tokenAddress}_${t}`)})})}function eD(e){return(0,o.jsxs)(x.mc,{flex:"column",gap:"xs",children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,o.jsx)(F.E,{inline:!0,color:"secondaryText",children:"Amount"}),(0,o.jsxs)(F.E,{color:"primaryText",inline:!0,children:[(0,i.Z)(Number(e.quote.fromCurrency.amount),2)," ",e.quote.fromCurrency.currencySymbol]})]}),e.quote.processingFees.map((e,t)=>{let n=(0,i.Z)(Number(e.amount),6);return(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,o.jsx)(F.E,{inline:!0,color:"secondaryText",children:"NETWORK"===e.feeType?"Network Fee":"Processing Fee"}),(0,o.jsxs)(F.E,{color:"primaryText",inline:!0,children:[0===n?"~":""," ",n," ",e.currencySymbol]})]},t)}),(0,o.jsx)(p.h,{y:"xxs"}),(0,o.jsx)(x.N1,{}),(0,o.jsx)(p.h,{y:"xxs"}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,o.jsx)(F.E,{inline:!0,color:"secondaryText",children:"Total"}),(0,o.jsxs)(F.E,{color:"primaryText",inline:!0,children:[(0,i.Z)(Number(e.quote.fromCurrencyWithFees.amount),6)," ",e.quote.fromCurrencyWithFees.currencySymbol]})]})]})}let eI=["COINBASE","STRIPE","TRANSAK","KADO"];function eW(e){return(0,o.jsx)(x.mc,{expand:!0,flex:"column",gap:"sm",style:{alignItems:"flex-start"},children:eI.map(t=>(0,o.jsx)(x.mc,{flex:"row",expand:!0,style:{justifyContent:"space-between"},children:(0,o.jsx)(y.$n,{fullWidth:!0,onClick:()=>e.onSelect(t),variant:"link",children:(0,o.jsx)(F.N,{color:e.preferredProvider===t?"primaryText":"secondaryText",size:"sm",hoverColor:"primaryText",children:t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()})})},t))})}function eR(e){var t;let{toToken:n,tokenAmount:s,payer:d,client:l,setScreen:u,toChain:m,showCurrencySelector:h,selectedCurrency:f}=e,j=e.payOptions?.paymentInfo?.sellerAddress||e.payer.account.address,{drawerRef:k,drawerOverlayRef:w,isOpen:b,setIsOpen:A}=eb(),[v,S]=(0,a.useState)("fees"),E=e.payOptions.buyWithFiat,[D,I]=(0,a.useState)(!1!==E?E?.preferredProvider||(localStorage.getItem(ec.pZ)??void 0):void 0),W=(t=!1!==E&&s?{fromCurrencySymbol:f.shorthand,toChainId:m.id,toAddress:j,toTokenAddress:(0,C.rk)(n)?r.DG:n.address,toAmount:s,client:l,isTestMode:E?.testMode,purchaseData:e.payOptions.purchaseData,fromAddress:d.account.address,preferredProvider:D}:void 0,(0,T.I)({queryKey:["useBuyWithFiatQuote",t],queryFn:async()=>{if(!t)throw Error("No params provided");return ei(t)},enabled:!!t,retry:!1})),R=!W.data,z=!W.isLoading&&W.error?el(W.error):void 0;return(0,o.jsxs)(x.mc,{flex:"column",gap:"lg",animate:"fadein",children:[b&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ew,{ref:w}),(0,o.jsxs)(eg,{ref:k,close:()=>A(!1),children:["fees"===v&&W.data&&(0,o.jsxs)("div",{children:[(0,o.jsx)(F.E,{size:"lg",color:"primaryText",children:"Fees"}),(0,o.jsx)(p.h,{y:"lg"}),(0,o.jsx)(eD,{quote:W.data})]}),"providers"===v&&(0,o.jsxs)("div",{children:[(0,o.jsx)(F.E,{size:"lg",color:"primaryText",children:"Providers"}),(0,o.jsx)(p.h,{y:"lg"}),(0,o.jsx)(eW,{preferredProvider:D||W.data?.provider,onSelect:e=>{I(e),localStorage.setItem(ec.pZ,e),A(!1)}})]})]})]}),(0,o.jsxs)(x.mc,{flex:"column",gap:"sm",children:[(0,o.jsx)(F.E,{size:"sm",children:"Pay with credit card"}),(0,o.jsxs)("div",{children:[(0,o.jsx)(ev,{isLoading:W.isLoading,value:W.data?.fromCurrencyWithFees.amount,client:l,currency:f,onSelectCurrency:h}),(0,o.jsxs)(x.mc,{bg:"tertiaryBg",flex:"row",borderColor:"borderColor",style:{paddingLeft:c.YK.md,justifyContent:"space-between",alignItems:"center",borderWidth:"1px",borderStyle:"solid",borderBottom:"none"},children:[(0,o.jsx)(F.E,{size:"xs",color:"secondaryText",children:"Provider"}),(0,o.jsx)(y.$n,{variant:"ghost",onClick:function(){S("providers"),A(!0)},children:(0,o.jsxs)(x.mc,{flex:"row",center:"y",gap:"xxs",color:"secondaryText",children:[(0,o.jsx)(F.E,{size:"xs",children:D?`${D.charAt(0).toUpperCase()+D.slice(1).toLowerCase()}`:W.data?.provider?`${W.data?.provider.charAt(0).toUpperCase()+W.data?.provider.slice(1).toLowerCase()}`:""}),(0,o.jsx)(eo.D3D,{width:c.RK.sm,height:c.RK.sm})]})})]}),(0,o.jsx)(eT,{quoteIsLoading:W.isLoading,estimatedSeconds:W.data?.estimatedDurationSeconds,onViewFees:function(){W.data&&(S("fees"),A(!0))}})]}),z&&(0,o.jsx)("div",{children:z.data?.minimumAmountEth?(0,o.jsxs)(F.E,{color:"danger",size:"sm",center:!0,multiline:!0,children:["Minimum amount is"," ",(0,i.Z)(Number(z.data.minimumAmountEth),6)," ",(0,o.jsx)(g.C,{token:n,chain:m,size:"sm",inline:!0,color:"danger"})]}):(0,o.jsx)(F.E,{color:"danger",size:"sm",center:!0,multiline:!0,children:z.message||ed})})]}),z?.data?.minimumAmountEth?(0,o.jsx)(y.$n,{variant:"accent",fullWidth:!0,onClick:()=>{e.setTokenAmount((0,i.Z)(Number(z.data?.minimumAmountEth),6).toString()),e.setHasEditedAmount(!0)},children:"Set Minimum"}):(0,o.jsx)(y.$n,{variant:R?"outline":"accent","data-disabled":R,disabled:R,fullWidth:!0,onClick:function(){W.data&&u({id:"fiat-flow",quote:W.data})},gap:"xs",children:W.isLoading?(0,o.jsxs)(o.Fragment,{children:["Getting price quote",(0,o.jsx)(eC.y,{size:"sm",color:"accentText"})]}):"Continue"})]})}var ez=n(76757),eB=n(15438),eP=n(29156),eL=n(63876),eO=n(71319),eF=n(31946),eN=n(42015),eK=n(6420),eM=n(824),eq=n(40058),e$=n(86410),e_=n(10271),eH=n(17910),eY=n(4055),eU=n(36544),eG=n(41355),eQ=n(85778),eV=n(73766);function eZ(e){let t=(0,eY.F)(),n=function(e){let t=e=>(0,eq.e)(e)||(0,eM.Y)(e),n=(0,e$.j)(e.wallet)&&e.connectedWallets.some(n=>t(n)&&n.getAccount()?.address?.toLowerCase()===e.wallet.getAdminAccount?.()?.address?.toLowerCase());return t(e.wallet)||n}({wallet:e.payer.wallet,connectedWallets:t}),r=function(e){var t;let n=!function(e){let t=e.toToken.chainId===e.onRampToken.token.chainId,n=(0,E.bv)(e.toToken.tokenAddress)===(0,E.bv)(e.onRampToken.token.tokenAddress);return!(t&&n)}(t=e.quote)?[{action:"buy",token:t.toToken,amount:t.estimatedToAmountMin}]:t.routingToken?[{action:"buy",token:t.onRampToken.token,amount:t.onRampToken.amount},{action:"swap",token:t.routingToken.token,amount:t.routingToken.amount},{action:"bridge",token:t.toToken,amount:t.estimatedToAmountMin}]:[{action:"buy",token:t.onRampToken.token,amount:t.onRampToken.amount},{action:"swap",token:t.toToken,amount:t.estimatedToAmountMin}],[o,r]=(0,a.useState)(0),[i,c]=(0,a.useState)(),[d,u]=(0,a.useState)(null),{uiStatus:m}=function(e){let t=(0,s.jE)(),n=(0,eH.a)({intentId:e.intentId,client:e.client,queryOptions:{enabled:!!e.openedWindow}}),o="actionRequired";switch(n.data?.status){case"ON_RAMP_TRANSFER_COMPLETED":case"CRYPTO_SWAP_COMPLETED":case"CRYPTO_SWAP_REQUIRED":o="completed";break;case"CRYPTO_SWAP_FALLBACK":o="partialSuccess";break;case"ON_RAMP_TRANSFER_FAILED":case"PAYMENT_FAILED":o="failed";break;case"PENDING_PAYMENT":case"ON_RAMP_TRANSFER_IN_PROGRESS":o="pending";break;default:o="actionRequired"}let r=(0,a.useRef)(!1);(0,a.useEffect)(()=>{!r.current&&e.onSuccess&&n.data&&("completed"===o||"partialSuccess"===o)&&(r.current=!0,e.onSuccess(n.data))},[e.onSuccess,n.data,o]),(0,a.useEffect)(()=>{if(e.openedWindow&&("completed"===o||"partialSuccess"===o))try{e.openedWindow&&!e.openedWindow.closed&&e.openedWindow.close()}catch(e){console.warn("Failed to close payment window:",e)}},[e.openedWindow,o]);let i=(0,a.useRef)(!1);return(0,a.useEffect)(()=>{i.current||"completed"!==o||(i.current=!0,(0,l.V)(t))},[o,t]),{uiStatus:o}}({intentId:e.quote.intentId,client:e.client,onSuccess:t=>{1===n.length?e.onSuccess(t):r(e=>e+1)},openedWindow:d}),h=n[o-1],p=n[o],x=function(e){let t=(0,s.jE)();return(0,ez.n)({mutationFn:async t=>{let n;let{fromToken:o,toToken:s,amount:a}=t,r=e.payer.wallet;r.getChain()?.id!==o.chainId&&await r.switchChain((0,H.Q4)(o.chainId));let i=r.getAccount();if(!i)throw Error("Payer wallet has no account");let c=await (0,eL.c)({fromChainId:o.chainId,fromTokenAddress:o.tokenAddress,toAmount:a,toChainId:s.chainId,toTokenAddress:s.tokenAddress,fromAddress:i.address,toAddress:i.address,client:e.client}),d=i.sendBatchTransaction,l=(0,v.P)({client:e.client,address:c.swapDetails.fromToken.tokenAddress,chain:(0,H.Q4)(c.swapDetails.fromToken.chainId)}),u=c.approvalData&&await (0,eB.nB)({contract:l,owner:i.address,spender:c.approvalData.spenderAddress})<BigInt(c.approvalData.amountWei);if(u&&c.approvalData&&!d){(0,A.G)({event:"prompt_swap_approval",client:e.client,walletAddress:i.address,walletType:e.payer.wallet.id,fromToken:c.swapDetails.fromToken.tokenAddress,fromAmount:c.swapDetails.fromAmountWei,toToken:c.swapDetails.toToken.tokenAddress,toAmount:c.swapDetails.toAmountWei,chainId:c.swapDetails.fromToken.chainId,dstChainId:c.swapDetails.toToken.chainId});let t=(0,eP.S)({contract:l,spender:c.approvalData.spenderAddress,amountWei:BigInt(c.approvalData.amountWei)}),n=await (0,eN.sendTransaction)({account:i,transaction:t});await (0,eK.L)({...n,maxBlocksWaitTime:50}),(0,A.G)({event:"swap_approval_success",client:e.client,walletAddress:i.address,walletType:e.payer.wallet.id,fromToken:c.swapDetails.fromToken.tokenAddress,fromAmount:c.swapDetails.fromAmountWei,toToken:c.swapDetails.toToken.tokenAddress,toAmount:c.swapDetails.toAmountWei,chainId:c.swapDetails.fromToken.chainId,dstChainId:c.swapDetails.toToken.chainId})}(0,A.G)({event:"prompt_swap_execution",client:e.client,walletAddress:i.address,walletType:e.payer.wallet.id,fromToken:c.swapDetails.fromToken.tokenAddress,fromAmount:c.swapDetails.fromAmountWei,toToken:c.swapDetails.toToken.tokenAddress,toAmount:c.swapDetails.toAmountWei,chainId:c.swapDetails.fromToken.chainId,dstChainId:c.swapDetails.toToken.chainId});let m=c.transactionRequest;if(d&&c.approvalData&&u){let e=(0,eP.S)({contract:l,spender:c.approvalData.spenderAddress,amountWei:BigInt(c.approvalData.amountWei)});n=await (0,eF.B)({account:i,transactions:[e,m]})}else n=await (0,eN.sendTransaction)({account:i,transaction:m});return await (0,eK.L)({...n,maxBlocksWaitTime:50}),(0,A.G)({event:"swap_execution_success",client:e.client,walletAddress:i.address,walletType:e.payer.wallet.id,fromToken:c.swapDetails.fromToken.tokenAddress,fromAmount:c.swapDetails.fromAmountWei,toToken:c.swapDetails.toToken.tokenAddress,toAmount:c.swapDetails.toAmountWei,chainId:c.swapDetails.fromToken.chainId,dstChainId:c.swapDetails.toToken.chainId}),e.isFiatFlow||(0,eQ.b)({type:"swap",txHash:n.transactionHash,chainId:n.chain.id}),{transactionHash:n.transactionHash,chainId:n.chain.id}},onSuccess:()=>{(0,l.V)(t)}})}({client:e.client,payer:e.payer,isFiatFlow:!0}),{uiStatus:y}=function(e){let t=(0,e_.D)(e.transactionHash&&e.chainId?{client:e.client,transactionHash:e.transactionHash,chainId:e.chainId}:void 0),n="unknown";switch(t.data?.status){case"COMPLETED":n="completed";break;case"FAILED":case"NOT_FOUND":n="failed";break;case"PENDING":n="pending";break;default:n="unknown"}let o=(0,a.useRef)(!1);(0,a.useEffect)(()=>{!o.current&&e.onSuccess&&t.data?.status==="COMPLETED"&&(o.current=!0,e.onSuccess(t.data))},[e.onSuccess,t]);let r=(0,s.jE)(),i=(0,a.useRef)(!1);return(0,a.useEffect)(()=>{"completed"!==n||i.current||(i.current=!0,(0,l.V)(r))},[r,n]),{uiStatus:n}}({client:e.client,transactionHash:i?.hash,chainId:i?.chainId,onSuccess:()=>{o===n.length-1?(0,eO.H)({intentId:e.quote.intentId,client:e.client}).then(e.onSuccess):(c(void 0),x.reset(),r(e=>e+1))}}),f=n.map((e,t)=>{let n="unknown";return 0===t?n=m:t<o?n="completed":t===o&&(n=x.isPending?"pending":x.error?"failed":i?y:"actionRequired"),{index:t,step:e,status:n}}),g=f.some(e=>"pending"===e.status),j=f.every(e=>"completed"===e.status),k=f.some(e=>"failed"===e.status),w=(0,a.useCallback)(async()=>{if(j){e.onDone();return}if(0===o){let t=function(e,t){let n=(window.innerHeight-750)/2,o=(window.innerWidth-500)/2;return window.open(`${e}&theme=${t}`,"thirdweb Pay",`width=500, height=750, top=${n}, left=${o}`)}(e.quote.onRampLink,e.theme);(0,A.G)({event:"open_onramp_popup",client:e.client,walletAddress:e.payer.account.address,walletType:e.payer.wallet.id}),u(t),(0,eQ.b)({type:"fiat",intentId:e.quote.intentId})}else if(h&&p&&!i)try{let e=await x.mutateAsync({fromToken:h.token,toToken:p.token,amount:p.amount});c({hash:e.transactionHash,chainId:e.chainId})}catch(e){console.error("Failed to execute swap:",e)}else k&&(c(void 0),x.reset())},[j,o,i,e.quote,e.onDone,x,e.theme,k,x.reset,e.client,e.payer.account.address,e.payer.wallet.id,p,h]);return(0,a.useEffect)(()=>{e.isAutoMode&&(g||j||k||!(o>0)||!(o<n.length)||i||w())},[e.isAutoMode,o,i,n.length,w,j,k,g]),{steps:f,handleContinue:w,isLoading:g,isDone:j,isFailed:k}}({quote:e.quote,client:e.client,onSuccess:e.onSuccess,onDone:e.onDone,payer:e.payer,theme:e.theme,isAutoMode:n}),i=r.steps[0]?.step.token.chainId;return(0,o.jsxs)(x.mc,{p:"lg",children:[(0,o.jsx)(x.rQ,{title:e.title,onBack:e.onBack}),(0,o.jsx)(p.h,{y:"xl"}),(0,o.jsx)(x.mc,{flex:"column",gap:"xs",center:"y",style:{paddingLeft:c.YK.md},children:(0,o.jsx)(Z.k,{client:e.client,address:e.receiverAddress,iconSize:"md",textSize:"sm",label:"Recipient wallet"})}),(0,o.jsx)(p.h,{y:"md"}),(0,o.jsx)(x.mc,{flex:"column",children:r.steps.map(({step:t,status:n},s)=>(0,o.jsxs)(x.mc,{flex:"column",children:[(0,o.jsx)(eV.C,{state:n,index:s,style:{flex:"1"},children:(0,o.jsx)(eJ,{step:t,client:e.client,payer:e.payer,index:s})}),s<r.steps.length-1&&(0,o.jsx)(eG.T,{})]},t.action))}),(0,o.jsx)(p.h,{y:"md"}),(0,o.jsx)(F.E,{size:"xs",color:"secondaryText",center:!0,style:{padding:`0 ${c.YK.xl}`},children:"Keep this window open until all transactions are complete."}),(0,o.jsx)(p.h,{y:"lg"}),(0,o.jsx)(x.mc,{flex:"column",gap:"md",children:!r.isDone&&i&&i!==e.payer.chain.id?(0,o.jsx)(eU.b,{fullWidth:!0,variant:"accent",switchChain:async()=>{await e.payer.wallet.switchChain((0,H.Q4)(i))}}):(0,o.jsxs)(y.$n,{variant:"accent",gap:"sm",fullWidth:!0,onClick:r.handleContinue,disabled:r.isLoading,children:[r.isLoading?"Processing":r.isDone?e.transactionMode?"Continue Transaction":"Done":r.isFailed?"Retry":"Continue",r.isLoading&&(0,o.jsx)(eC.y,{size:"sm",color:"primaryText"})]})})]})}function eJ(e){let{step:t,client:n}=e,s=(0,W.Kj)((0,H.Q4)(t.token.chainId));return(0,o.jsx)(x.mc,{flex:"column",gap:"xs",py:"3xs",children:(0,o.jsxs)(x.mc,{flex:"row",center:"y",gap:"sm",style:{display:"flex",justifyContent:"space-between",flexWrap:"nowrap"},children:[(0,o.jsx)(K.f,{chain:(0,H.Q4)(t.token.chainId),client:n,size:"md",token:{address:t.token.tokenAddress}}),(0,o.jsxs)(x.mc,{flex:"column",gap:"3xs",center:"y",style:{flex:"1"},children:[(0,o.jsx)(F.E,{size:"sm",color:"primaryText",children:t.action.charAt(0).toUpperCase()+t.action.slice(1)}),(0,o.jsxs)(x.mc,{flex:"row",gap:"xs",center:"y",style:{display:"flex",justifyContent:"space-between",flexWrap:"nowrap"},children:[(0,o.jsxs)(x.mc,{flex:"row",gap:"xxs",center:"y",style:{flex:"1 1 60%",minWidth:0,maxWidth:"60%",overflow:"hidden",flexWrap:"nowrap"},children:[(0,o.jsx)(F.E,{size:"sm",color:"primaryText",children:(0,i.Z)(Number(t.amount),5)}),(0,o.jsx)(g.C,{token:{address:t.token.tokenAddress,name:t.token.name||"",symbol:t.token.symbol||""},chain:(0,H.Q4)(t.token.chainId),size:"sm",color:"secondaryText"})]}),(0,o.jsx)(x.mc,{flex:"row",gap:"xs",center:"y",style:{flex:"1 1 40%",maxWidth:"40%",minWidth:0,justifyContent:"flex-end",flexWrap:"nowrap"},children:(0,o.jsx)(F.E,{size:"xs",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s.name})})]})]})]})})}let eX=(0,H.xH)({id:137,name:"Polygon",nativeCurrency:{name:"POL",symbol:"POL",decimals:18},blockExplorers:[{name:"PolygonScan",url:"https://polygonscan.com",apiUrl:"https://api.polygonscan.com/api"}]});var e0=n(97192),e1=n(13281),e2=n(95311),e5=n(49138);function e4(e){let t=(0,e1.o)(e.tokenAmount,500),n=(0,T.I)({queryKey:["cryptoToFiat",e.chain.id,(0,C.me)(e.token),t],queryFn:()=>(0,e5.c)({client:e.client,chain:e.chain,fromTokenAddress:(0,C.me)(e.token),fromAmount:Number(t),to:"USD"})});return n.isLoading?(0,o.jsx)(q.E,{width:"50px",height:c.J.lg}):n.data?.result?(0,o.jsxs)(F.E,{...e,children:["$",(0,i.Z)(n.data.result,2).toFixed(2)]}):null}function e6(e){var t;let n;return(0,o.jsxs)(x.mc,{children:[(0,o.jsx)("div",{onClick:e=>{e.currentTarget.querySelector("input")?.focus()},children:(0,o.jsxs)(x.mc,{flex:"row",center:"both",gap:"xs",style:{flexWrap:"nowrap"},children:[(0,o.jsx)(f.pd,{variant:"outline",pattern:"^[0-9]*[.,]?[0-9]*$",inputMode:"decimal",tabIndex:-1,placeholder:"0",type:"text","data-placeholder":""===e.value,value:e.value||"0",disabled:e.freezeAmount,onClick:t=>{""===e.value&&t.currentTarget.setSelectionRange(t.currentTarget.value.length,t.currentTarget.value.length)},onChange:t=>{let n=t.target.value;(n=n.replace(",",".")).startsWith(".")&&(n=`0${n}`),!Number.isNaN(Number(n))&&(n.startsWith("0")&&!n.startsWith("0.")?e.onChange(n.slice(1)):e.onChange(n))},style:{border:"none",fontSize:(t=e.value).length>10?"26px":t.length>6?"34px":"50px",boxShadow:"none",borderRadius:"0",padding:"0",paddingBlock:"2px",fontWeight:600,textAlign:"right",width:(n=e.value.replace(".","").length,e.value.includes(".")&&(n+=.3),`calc(${Math.max(1,n)}ch + 6px)`),maxWidth:"calc(100% - 100px)"}}),(0,o.jsx)(g.C,{token:e.token,chain:e.chain,size:"lg",color:"secondaryText"})]})}),(0,o.jsx)(x.mc,{flex:"row",center:"both",style:{height:c.J.xl},children:(0,o.jsx)(e4,{tokenAmount:e.value,token:e.token,chain:e.chain,client:e.client,size:"md"})}),!e.hideTokenSelector&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(p.h,{y:"md"}),(0,o.jsx)(x.mc,{flex:"row",center:"x",children:(0,o.jsx)(e2.g,{token:e.token,chain:e.chain,client:e.client,onSelectToken:e.onSelectToken,freezeChainAndToken:e.freezeChainAndToken})})]})]})}var e9=n(39465);function e8(e){let t=(0,I.QP)(),n=(0,M.X)({address:e.payerAccount.address,chain:e.chain,tokenAddress:(0,C.rk)(e.token)?void 0:e.token?.address,client:e.client},{enabled:!!e.chain&&!!e.token});return(0,o.jsxs)(x.mc,{bg:"tertiaryBg",style:{borderRadius:c.r8.lg,border:`1px solid ${t.colors.borderColor}`,...e.swapRequired?{borderBottom:"none",borderBottomLeftRadius:0,borderBottomRightRadius:0}:{}},children:[(0,o.jsxs)(x.mc,{flex:"row",gap:"sm",style:{justifyContent:"space-between",padding:c.YK.sm,borderBottom:`1px solid ${t.colors.borderColor}`},children:[(0,o.jsx)(Z.k,{client:e.client,address:e.payerAccount.address}),e.token&&e.chain&&n.data?(0,o.jsxs)(x.mc,{flex:"row",gap:"3xs",center:"y",children:[(0,o.jsx)(F.E,{size:"xs",color:"secondaryText",weight:500,children:(0,_.j)(n.data,!1,4)}),(0,o.jsx)(g.C,{token:e.token,chain:e.chain,size:"xs",color:"secondaryText"})]}):e.token&&e.chain&&n.isLoading?(0,o.jsx)(q.E,{width:"70px",height:c.J.xs}):null]}),(0,o.jsx)(e2.g,{token:e.token,chain:e.chain,client:e.client,isLoading:e.isLoading,value:e.value,onSelectToken:e.onSelectToken,style:{border:"none",borderRadius:0,borderBottomLeftRadius:e.token&&e.chain&&e.swapRequired?0:c.r8.lg,borderBottomRightRadius:e.token&&e.chain&&e.swapRequired?0:c.r8.lg}})]})}function e3(e){var t;let{setScreen:n,payer:s,client:c,toChain:d,tokenAmount:l,toToken:u,fromChain:m,fromToken:h,payOptions:f,disableTokenSelection:j}=e,k=e.payOptions?.paymentInfo?.sellerAddress||e.activeAccount.address,{drawerRef:w,drawerOverlayRef:b,isOpen:A,setIsOpen:S}=eb(),[E,D]=(0,a.useState)("fees"),I=(0,M.X)({address:s.account.address,chain:m,tokenAddress:(0,C.rk)(h)?void 0:h?.address,client:c},{enabled:!!m&&!!h}),W=(0,C.rk)(h)?r.DG:h?.address?.toLowerCase(),R=(0,C.rk)(u)?r.DG:u.address.toLowerCase(),z=!!l&&!!m&&!!W&&(m?.id!==d.id||W!==R),B=(t=m&&h&&z?{fromAddress:s.account.address,toAddress:k,fromChainId:m.id,fromTokenAddress:(0,C.rk)(h)?r.DG:h.address,toChainId:d.id,toTokenAddress:(0,C.rk)(u)?r.DG:u.address,toAmount:l,client:c,purchaseData:f.purchaseData}:void 0,(0,T.I)({staleTime:3e4,refetchInterval:3e4,gcTime:3e4,queryKey:["buyWithCryptoQuote",t],refetchInterval:2e4,queryFn:()=>{if(!t)throw Error("Swap params are required");return(0,eL.c)(t)},enabled:!!t,retry:!1})),P=(0,T.I)({queryKey:["allowance",s.account.address,B.data?.approvalData],queryFn:()=>B.data?.approvalData?(0,eB.nB)({contract:(0,v.P)({client:e.client,address:B.data.swapDetails.fromToken.tokenAddress,chain:(0,H.Q4)(B.data.swapDetails.fromToken.chainId)}),spender:B.data.approvalData.spenderAddress,owner:e.payer.account.address}):null,enabled:!!B.data?.approvalData,refetchOnMount:!0}),L=z?B.data?.swapDetails.fromAmount:l,O=!!L&&!!I.data&&Number(I.data.displayValue)<Number(L),N=!m||!h||z&&!B.data||O||P.isLoading,K=e.payer.wallet.getChain()?.id!==m?.id,q=!B.isLoading&&B.error?el(B.error):void 0;return(0,o.jsxs)(x.mc,{flex:"column",gap:"lg",animate:"fadein",children:[A&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ew,{ref:b}),(0,o.jsx)(eg,{ref:w,close:()=>S(!1),children:"fees"===E&&B.data&&(0,o.jsxs)("div",{children:[(0,o.jsx)(F.E,{size:"lg",color:"primaryText",children:"Fees"}),(0,o.jsx)(p.h,{y:"lg"}),(0,o.jsx)(eE,{quote:B.data})]})})]}),(0,o.jsxs)(x.mc,{flex:"column",gap:"sm",children:[(0,o.jsxs)(x.mc,{flex:"row",gap:"xxs",center:"y",children:[(0,o.jsx)(F.E,{size:"sm",children:"Pay with"}),h&&m?(0,o.jsx)(g.C,{token:h,chain:m,size:"sm",color:"secondaryText"}):"crypto"]}),(0,o.jsxs)("div",{children:[(0,o.jsx)(e8,{value:L||"",chain:m,token:h,isLoading:B.isLoading&&!L,client:c,freezeChainAndTokenSelection:j,payerAccount:e.payer.account,swapRequired:z,onSelectToken:e.showFromTokenSelector}),z&&m&&h&&(0,o.jsx)(eT,{quoteIsLoading:B.isLoading,estimatedSeconds:B.data?.swapDetails.estimated.durationSeconds,onViewFees:function(){B.data&&(S(!0),D("fees"))}})]}),q&&(0,o.jsx)("div",{children:q.data?.minimumAmountEth?(0,o.jsxs)(F.E,{color:"danger",size:"xs",center:!0,multiline:!0,children:["Minimum amount is"," ",(0,i.Z)(Number(q.data.minimumAmountEth),6)," ",(0,o.jsx)(g.C,{token:u,chain:d,size:"sm",inline:!0,color:"danger"})]}):(0,o.jsx)(F.E,{color:"danger",size:"xs",center:!0,multiline:!0,children:q.message||ed})}),!q&&O&&(0,o.jsx)("div",{children:(0,o.jsx)(F.E,{color:"danger",size:"xs",center:!0,multiline:!0,children:"Insufficient funds"})})]}),q?.data?.minimumAmountEth?(0,o.jsx)(y.$n,{variant:"accent",fullWidth:!0,onClick:()=>{e.setTokenAmount((0,i.Z)(Number(q.data?.minimumAmountEth),6).toString()),e.setHasEditedAmount(!0)},children:"Set Minimum"}):O||q?(0,o.jsx)(y.$n,{variant:"accent",fullWidth:!0,onClick:()=>e.showFromTokenSelector(),children:"Pay with another token"}):!K||!m||B.isLoading||P.isLoading||O||B.error?(0,o.jsx)(y.$n,{variant:N?"outline":"accent",fullWidth:!0,"data-disabled":N,disabled:N,onClick:async()=>{N||function(){if("direct_payment"!==e.payOptions.mode&&"fund_wallet"!==e.payOptions.mode||O||z){if("transaction"===e.payOptions.mode&&!O&&!z){s.account.address!==k?n({id:"transfer-flow"}):e.onDone();return}}else n({id:"transfer-flow"});B.data&&n({id:"swap-flow",quote:B.data,approvalAmount:P.data??void 0})}()},gap:"xs",children:B.isLoading?(0,o.jsxs)(o.Fragment,{children:["Getting price quote",(0,o.jsx)(eC.y,{size:"sm",color:"accentText"})]}):"Continue"}):(0,o.jsx)(eU.b,{variant:"accent",fullWidth:!0,switchChain:async()=>{await e.payer.wallet.switchChain(m)}})]})}var e7=n(5838),te=n(70246);function tt(e){let t=(0,eY.F)(),n=(0,d.L)(),s=(0,W.cj)(e.toChain),a=(0,I.QP)(),i=(0,T.I)({queryKey:["wallets-and-balances",e.sourceSupportedTokens,e.toChain.id,e.toToken,e.tokenAmount,e.mode,n?.address,t.map(e=>e.getAccount()?.address)],queryFn:async()=>{let o=new Map,a=t.flatMap(t=>{let a=t.getAccount();if(!a)return[];let i={id:t.id,address:a.address};o.set(i,[]);let c=(0,C.rk)(e.toToken)?{address:r.DG,name:s.data?.nativeCurrency.name||"",symbol:s.data?.nativeCurrency.symbol||"",icon:s.data?.icon?.url}:e.toToken;return Object.entries({...e.sourceSupportedTokens,[e.toChain.id]:[c,...e.sourceSupportedTokens?.[e.toChain.id]||[]]}).flatMap(([s,r])=>r.map(async r=>{try{let t=(0,H.Q4)(Number(s)),d=await (0,V.m)({address:a.address,chain:t,tokenAddress:(0,C.rk)(r)?void 0:r.address,client:e.client});if(r.address===c.address&&t.id===e.toChain.id?("fund_wallet"!==e.mode||a.address!==n?.address)&&Number(d.displayValue)>Number(e.tokenAmount):d.value>0n){let n=o.get(i)||[];n.push({balance:d,chain:t,token:r}),n.sort((t,n)=>t.chain.id===e.toChain.id&&t.token.address===c.address?-1:n.chain.id===e.toChain.id&&n.token.address===c.address?1:t.chain.id===e.toChain.id?-1:n.chain.id===e.toChain.id?1:t.chain.id>n.chain.id?1:-1)}}catch(e){console.error(`Failed to fetch balance for wallet ${t.id} on chain ${s} for token ${r.symbol}:`,e)}}))});return await Promise.all(a),o},enabled:!!e.sourceSupportedTokens&&!!s.data});if(i.isLoading||!i.data)return(0,o.jsx)(m.x,{});let l=Array.from(i.data.entries()||[]).filter(([t])=>!e.hiddenWallets?.includes(t.id)).filter(([,e])=>e.some(e=>e.balance.value>0));return(0,o.jsxs)(x.mc,{animate:"fadein",style:{minHeight:"200px"},children:[0===l.length?(0,o.jsx)(x.mc,{flex:"column",gap:"xs",py:"lg",children:(0,o.jsxs)(F.E,{size:"xs",color:"secondaryText",center:!0,children:["No suitable payment token found",(0,o.jsx)("br",{}),"in connected wallets"]})}):(0,o.jsxs)(x.mc,{flex:"column",gap:"xs",children:[(0,o.jsx)(F.E,{size:"sm",children:"Select payment token"}),(0,o.jsx)(p.h,{y:"xs"})]}),(0,o.jsx)(x.mc,{scrollY:!0,style:{maxHeight:"350px"},children:(0,o.jsxs)(x.mc,{flex:"column",gap:"sm",children:[l.map(([n,s])=>{let a=n.address,r=t.find(e=>e.getAccount()?.address===a);return r?(0,o.jsx)(tn,{wallet:r,balances:s,client:e.client,address:a,onClick:e.onSelectToken},n.id):null}),l.length>0&&(0,o.jsx)(te.l,{text:"OR"}),(0,o.jsx)(y.$n,{variant:"secondary",fullWidth:!0,onClick:e.onConnect,bg:"tertiaryBg",style:{border:`1px solid ${a.colors.borderColor}`,padding:c.YK.sm},children:(0,o.jsxs)(x.mc,{flex:"row",gap:"sm",center:"y",expand:!0,color:"secondaryIconColor",children:[(0,o.jsx)($.l,{size:c.RK.md}),(0,o.jsx)(F.E,{size:"sm",color:"primaryText",children:"Pay with another wallet"})]})}),e.fiatSupported&&(0,o.jsx)(y.$n,{variant:"secondary",fullWidth:!0,onClick:e.onPayWithFiat,bg:"tertiaryBg",style:{border:`1px solid ${a.colors.borderColor}`,padding:c.YK.sm},children:(0,o.jsxs)(x.mc,{flex:"row",gap:"sm",center:"y",expand:!0,color:"secondaryIconColor",children:[(0,o.jsx)(eo.IJm,{width:c.RK.md,height:c.RK.md}),(0,o.jsx)(F.E,{size:"sm",color:"primaryText",children:"Pay with credit card"})]})})]})})]})}function tn(e){let t=(0,I.QP)(),n=e.balances,s=(0,d.L)(),{disconnect:a}=(0,e7.u)(),r=s?.address===e.address;return(0,o.jsxs)(x.mc,{flex:"column",style:{borderRadius:c.r8.lg,border:`1px solid ${t.colors.borderColor}`},children:[(0,o.jsxs)(x.mc,{flex:"row",gap:"sm",bg:"tertiaryBg",style:{justifyContent:"space-between",borderTopRightRadius:c.r8.lg,borderTopLeftRadius:c.r8.lg,padding:c.YK.sm,paddingRight:c.YK.xs,borderBottom:`1px solid ${t.colors.borderColor}`},children:[(0,o.jsx)(Z.k,{...e}),!r&&(0,o.jsx)(y.$n,{variant:"ghost",onClick:()=>a(e.wallet),style:{padding:c.YK.xxs,color:t.colors.secondaryText},children:(0,o.jsx)(eo.MKb,{width:c.RK.sm,height:c.RK.sm})})]}),(0,o.jsx)(x.mc,{flex:"column",children:e.balances.length>0?n.map((s,a)=>(0,o.jsx)(to,{client:e.client,onClick:()=>e.onClick(e.wallet,s.token,s.chain),tokenBalance:s,wallet:e.wallet,style:{borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomRightRadius:a===n.length-1?c.r8.lg:0,borderBottomLeftRadius:a===n.length-1?c.r8.lg:0,borderBottom:a===n.length-1?"none":`1px solid ${t.colors.borderColor}`}},`${s.token.address}-${s.chain.id}`)):(0,o.jsx)(x.mc,{style:{padding:c.YK.sm},children:(0,o.jsx)(F.E,{size:"sm",color:"secondaryText",children:"Insufficient funds"})})})]})}function to(e){let{tokenBalance:t,wallet:n,onClick:s,client:a,style:r}=e,i=(0,W.Kj)(t.chain);return(0,o.jsxs)(ts,{onClick:()=>s(t.token,n),variant:"secondary",style:{...r,display:"flex",justifyContent:"space-between",minWidth:0},children:[(0,o.jsxs)(x.mc,{flex:"row",center:"y",gap:"sm",style:{flex:"1 1 50%",minWidth:0,maxWidth:"50%",overflow:"hidden",flexWrap:"nowrap"},children:[(0,o.jsx)(L.x,{token:t.token,chain:t.chain,size:"md",client:a}),(0,o.jsxs)(x.mc,{flex:"column",gap:"4xs",style:{minWidth:0},children:[(0,o.jsx)(F.E,{size:"xs",color:"primaryText",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.token.symbol}),i&&(0,o.jsx)(F.E,{size:"xs",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:i.name})]})]}),(0,o.jsxs)(x.mc,{flex:"row",center:"y",gap:"4xs",color:"secondaryText",style:{flex:"1 1 50%",maxWidth:"50%",minWidth:0,justifyContent:"flex-end",flexWrap:"nowrap"},children:[(0,o.jsxs)(x.mc,{flex:"column",color:"secondaryText",gap:"4xs",style:{alignItems:"flex-end",minWidth:0,overflow:"hidden"},children:[(0,o.jsx)(F.E,{size:"xs",color:"primaryText",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(0,_.j)(t.balance,!0,2)}),(0,o.jsx)(e4,{tokenAmount:t.balance.displayValue,token:t.token,chain:t.chain,client:a,size:"xs"})]}),(0,o.jsx)(eo.vKP,{width:c.RK.md,height:c.RK.md,style:{flexShrink:0}})]})]})}let ts=(0,X.A)(y.$n)(e=>{let t=(0,I.QP)();return{background:"transparent",justifyContent:"space-between",flexWrap:"nowrap",flexDirection:"row",padding:c.YK.sm,paddingRight:c.YK.xs,gap:c.YK.sm,"&:hover":{background:t.colors.secondaryButtonBg,transform:"scale(1.01)"},transition:"background 200ms ease, transform 150ms ease",...e.style}});var ta=n(65495),tr=n(4050);async function ti(e){try{let t=(0,es.KI)(e.client),n=await t((0,er.gy)(),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:(0,ea.A)({fromAddress:e.fromAddress,toAddress:e.toAddress,chainId:e.chainId,tokenAddress:e.tokenAddress,amount:e.amount,purchaseData:e.purchaseData})});if(!n.ok){let e=await n.json();if(e&&"error"in e)throw e;throw Error(`HTTP error! status: ${n.status}`)}let o=(await n.json()).result;return{transactionRequest:{chain:(0,H.Q4)(o.transactionRequest.chainId),client:e.client,data:o.transactionRequest.data,to:o.transactionRequest.to,value:BigInt(o.transactionRequest.value),gas:BigInt(o.transactionRequest.gasLimit)},approvalData:o.approval,fromAddress:o.fromAddress,toAddress:o.toAddress,paymentToken:o.paymentToken,processingFee:o.processingFee,estimatedGasCostUSDCents:o.estimatedGasCostUSDCents,client:e.client}}catch(e){throw console.error("Error getting buy with crypto transfer",e),e}}var tc=n(27298),td=n(84282),tl=n(6221),tu=n(50291),tm=n(42967),th=n(7403);function tp(e){let{title:t,onBack:n,receiverAddress:s,client:i,payer:d,onDone:l,chain:u,token:m,tokenAmount:h,transactionMode:f,setTransactionHash:g,payOptions:j}=e,[k,w]=(0,a.useState)("transfer"),[b,T]=(0,a.useState)({id:"idle"});return(0,o.jsxs)(x.mc,{p:"lg",children:[(0,o.jsx)(x.rQ,{title:t,onBack:n}),(0,o.jsx)(p.h,{y:"xl"}),f?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tl.g,{steps:2,currentStep:"transfer"===k?1:2}),(0,o.jsx)(p.h,{y:"sm"}),(0,o.jsx)(F.E,{size:"sm",children:"transfer"===k?"Step 1 of 2 - Transfer funds":"Step 2 of 2 - Finalize transaction"}),(0,o.jsx)(p.h,{y:"md"})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(F.E,{size:"sm",children:"Confirm payment"}),(0,o.jsx)(p.h,{y:"md"})]}),(0,o.jsx)(th.a,{sender:d.account.address,receiver:s,client:i,fromToken:m,fromChain:u,toToken:m,toChain:u,fromAmount:h,toAmount:h}),(0,o.jsx)(p.h,{y:"lg"}),f&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(p.h,{y:"sm"}),(0,o.jsxs)(x.mc,{gap:"sm",flex:"row",style:{justifyContent:"space-between"},center:"y",color:"accentText",children:[(0,o.jsx)(tu.p,{isDone:"execute"===k,isActive:"transfer"===k,label:"transfer"===k?"Transfer":"Done"}),(0,o.jsx)(tm.w,{}),(0,o.jsx)(tu.p,{isDone:!1,label:"Finalize",isActive:"execute"===k})]}),(0,o.jsx)(p.h,{y:"lg"})]}),"error"===b.id&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(x.mc,{flex:"row",gap:"xs",center:"both",color:"danger",children:(0,o.jsx)(F.E,{color:"danger",size:"sm",style:{textAlign:"center"},children:"transfer"===k?`${b.error||"Failed to Transfer"}`:"Failed to Execute"})}),(0,o.jsx)(p.h,{y:"md"})]}),!f&&"execute"===k&&"done"===b.id&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(x.mc,{flex:"row",gap:"xs",center:"both",color:"success",children:[(0,o.jsx)(eo.KaV,{width:c.RK.sm,height:c.RK.sm}),(0,o.jsx)(F.E,{color:"success",size:"sm",children:"Payment completed"})]}),(0,o.jsx)(p.h,{y:"md"})]}),d.chain.id!==u.id?(0,o.jsx)(eU.b,{fullWidth:!0,variant:"accent",switchChain:async()=>{await e.payer.wallet.switchChain(u)}}):(0,o.jsxs)(y.$n,{variant:"accent",fullWidth:!0,disabled:"pending"===b.id,onClick:async()=>{if("execute"===k){l();return}try{if(T({id:"pending"}),f){let t=(0,C.rk)(m)?(0,td.prepareTransaction)({client:i,chain:u,to:s,value:(0,D.fq)(h)}):(0,tr.k)({contract:(0,v.P)({address:m.address,chain:u,client:i}),to:s,amount:h}),[n,o]=await Promise.all([(0,tc.E)({account:e.payer.account,transaction:t}),(0,Y.getCurrencyMetadata)({contract:(0,v.P)({address:(0,C.rk)(m)?r.DG:m.address,chain:u,client:i})})]);e.onSuccess?.(function(e){let{token:t,chain:n,tokenMetadata:o,tokenAmount:s,fromAddress:a,toAddress:i,transaction:c}=e;return{status:"COMPLETED",subStatus:"SUCCESS",swapType:"TRANSFER",quote:{createdAt:new Date().toISOString(),fromToken:{chainId:n.id,tokenAddress:(0,C.rk)(t)?r.DG:t.address,decimals:o.decimals,symbol:o.symbol,name:o.name,priceUSDCents:0},toToken:{chainId:n.id,tokenAddress:(0,C.rk)(t)?r.DG:t.address,decimals:o.decimals,symbol:o.symbol,name:o.name,priceUSDCents:0},fromAmountWei:(0,D.fq)(s).toString(),fromAmount:s,toAmountWei:(0,D.fq)(s).toString(),toAmount:s,toAmountMin:s,toAmountMinWei:(0,D.fq)(s).toString(),estimated:{feesUSDCents:0,gasCostUSDCents:0,slippageBPS:0,toAmountMinUSDCents:0,toAmountUSDCents:0,fromAmountUSDCents:0,durationSeconds:0}},fromAddress:a,toAddress:i,source:{transactionHash:c.transactionHash,amount:s,amountWei:(0,D.fq)(s).toString(),amountUSDCents:0,completedAt:new Date().toISOString(),token:{chainId:n.id,tokenAddress:(0,C.rk)(t)?r.DG:t.address,decimals:o.decimals,symbol:o.symbol,name:o.name,priceUSDCents:0}}}}({token:m,chain:u,tokenMetadata:o,tokenAmount:h,fromAddress:d.account.address,toAddress:s,transaction:n})),w("execute"),T({id:"idle"})}else{let t=await ti({client:i,fromAddress:d.account.address,toAddress:s,chainId:u.id,tokenAddress:(0,C.rk)(m)?r.DG:m.address,amount:h,purchaseData:j?.purchaseData});if(t.approvalData&&await (0,eB.nB)({contract:(0,v.P)({client:i,address:t.approvalData.tokenAddress,chain:(0,H.Q4)(t.approvalData.chainId)}),spender:t.approvalData.spenderAddress,owner:d.account.address})<BigInt(t.approvalData.amountWei)){w("approve");let n=(0,eP.S)({contract:(0,v.P)({client:i,address:t.approvalData.tokenAddress,chain:(0,H.Q4)(t.approvalData.chainId)}),spender:t.approvalData.spenderAddress,amountWei:BigInt(t.approvalData.amountWei)});await (0,tc.E)({account:e.payer.account,transaction:n})}w("transfer");let n=t.transactionRequest,o=await (0,eN.sendTransaction)({account:e.payer.account,transaction:n});g(o.transactionHash),T({id:"idle"})}}catch(e){console.error(e),T({id:"error",error:"error"in e?e.error?.message:e?.message})}},gap:"xs",children:["execute"===k&&("done"===b.id?"Done":"Continue"),"transfer"===k&&("pending"===b.id?"Confirming":"Confirm"),"approve"===k&&("pending"===b.id?"Approving":"Approve"),"pending"===b.id&&(0,o.jsx)(eC.y,{size:"sm",color:"accentButtonText"})]})]})}function tx(e){let[t,n]=(0,a.useState)();return t?(0,o.jsx)(ta.S,{title:e.title,onBack:e.onBack,onTryAgain:e.onTryAgain,swapTxHash:t,fromChain:e.chain,client:e.client,onDone:e.onDone,transactionMode:!1,isEmbed:e.isEmbed,quote:void 0,onSuccess:e.onSuccess}):(0,o.jsx)(tp,{...e,setTransactionHash:n})}var ty=n(90862);function tf(e){let t=e.payOptions.buyWithCrypto?e.payOptions.buyWithCrypto.testMode:void 0,n=(0,ty.Xw)(e.client,t);return n.isError?(0,o.jsx)(x.mc,{style:{minHeight:"350px"},fullHeight:!0,flex:"row",center:"both",children:(0,o.jsx)(u.W,{title:"Something went wrong",onTryAgain:n.refetch})}):n.data?(0,o.jsx)(tg,{...e,supportedDestinations:n.data}):(0,o.jsx)(m.x,{})}function tg(e){let{client:t,supportedDestinations:n,connectLocale:i,payOptions:c}=e,u=(0,d.L)(),{payer:m,setPayer:h}=function(){let e=(0,R.z)(),t=(0,d.L)(),n=(0,e0.w)(),[o,s]=(0,a.useState)();return(0,a.useEffect)(()=>{let e=o?.wallet;function t(){if(!e){s(void 0);return}let t=e.getAccount(),n=e.getChain();t&&n?s({account:t,chain:n,wallet:e}):s(void 0)}if(e){let n=e.subscribe("chainChanged",t),o=e.subscribe("accountChanged",t);return()=>{n(),o()}}},[o]),{payer:o||(t&&n&&e?{account:t,chain:n,wallet:e}:void 0),setPayer:s}}(),[p,y]=(0,a.useState)({id:"main"}),{tokenAmount:f,setTokenAmount:g,toChain:j,setToChain:k,deferredTokenAmount:T,toToken:A,setToToken:v}=function(e){let{payOptions:t,supportedDestinations:n}=e,o=t?.prefillBuy,s=(0,e0.w)(),r=o?.amount||"",[i,c]=(0,a.useState)(r),d=(0,e1.o)(i,300);(0,a.useEffect)(()=>{o?.amount&&c(o.amount),o?.chain&&u(o.chain),o?.token&&h(o.token)},[o?.amount,o?.chain,o?.token]);let[l,u]=(0,a.useState)(o?.chain||"transaction"===t.mode&&t.transaction?.chain||"direct_payment"===t.mode&&t.paymentInfo?.chain||n.find(e=>e.chain.id===s?.id)?.chain||n[0]?.chain||eX),[m,h]=(0,a.useState)(o?.token||"direct_payment"===t.mode&&t.paymentInfo.token||C.gr);return{toChain:l,setToChain:u,toToken:m,setToToken:h,tokenAmount:i,setTokenAmount:c,deferredTokenAmount:d}}({payOptions:c,supportedDestinations:n}),[S,E]=(0,a.useState)(!1),D=(0,a.useCallback)(()=>{y({id:"main"}),e.onDone()},[e.onDone]),I=(0,ty.mC)({client:e.client,destinationChainId:j.id,destinationTokenAddress:(0,C.rk)(A)?r.DG:A.address}),W=(0,a.useMemo)(()=>tb(n,c,e.supportedTokens),[e.supportedTokens,n,c]),z=(0,a.useMemo)(()=>{if(I.data)return tb(I.data,c,e.supportedTokens)},[e.supportedTokens,I.data,c]),{fromChain:B,setFromChain:P,fromToken:L,setFromToken:O}=function(e){let{payOptions:t}=e,[n,o]=(0,a.useState)(),s=!1!==t.buyWithCrypto&&t.buyWithCrypto?.prefillSource?.chain||"transaction"===t.mode&&t.transaction?.chain||"direct_payment"===t.mode&&t.paymentInfo?.chain,[r,i]=(0,a.useState)(),c=!1!==t.buyWithCrypto&&t.buyWithCrypto?.prefillSource?.token||"direct_payment"===t.mode&&t.paymentInfo.token;return{fromChain:n||s||void 0,setFromChain:o,fromToken:r||c||void 0,setFromToken:i}}({payOptions:c,supportedSources:I.data||[]}),{selectedCurrency:F,setSelectedCurrency:N}=function(e){let{payOptions:t}=e,n=(!1!==t.buyWithFiat?t.buyWithFiat?.prefillSource?.currency:void 0)||function(){try{let e=Intl.DateTimeFormat().resolvedOptions().timeZone.toLowerCase();if(e.includes("london"))return"GBP";if(e.includes("europe"))return"EUR";if(e.includes("japan"))return"JPY";if(e.includes("canada"))return"CAD";if(e.includes("australia"))return"AUD";if(e.includes("new zealand"))return"NZD";return"USD"}catch{return"USD"}}(),[o,s]=(0,a.useState)(ee.qx.find(e=>e.shorthand===n)||ee.a2);return{selectedCurrency:o,setSelectedCurrency:s}}({payOptions:c}),K=function(e){let{payOptions:t,supportedDestinations:n,toChain:o,toToken:s}=e,{fiat:a,swap:i}=function(){let e=n.find(e=>e.chain.id===o.id);if(!e)return{fiat:!1,swap:!1};let t=(0,C.rk)(s)?r.DG:s.address,a=e.tokens.find(e=>e.address.toLowerCase()===t.toLowerCase());return a?{fiat:a.buyWithFiatEnabled,swap:a.buyWithCryptoEnabled}:{fiat:!0,swap:!0}}();return{buyWithFiatEnabled:!1!==t.buyWithFiat&&a,buyWithCryptoEnabled:!1!==t.buyWithCrypto&&i}}({payOptions:e.payOptions,supportedDestinations:e.supportedDestinations,toChain:j,toToken:A}),M=!1===K.buyWithCryptoEnabled&&!1===K.buyWithFiatEnabled,q=(0,s.jE)(),$=(0,a.useCallback)(t=>{e.payOptions.onPurchaseSuccess?.({type:"crypto",status:t}),(0,l.V)(q)},[e.payOptions.onPurchaseSuccess,q]),_=(0,a.useCallback)(t=>{e.payOptions.onPurchaseSuccess?.({type:"fiat",status:t}),(0,l.V)(q)},[e.payOptions.onPurchaseSuccess,q]);if("connect-payer-wallet"===p.id)return(0,o.jsx)(b.r,{accountAbstraction:e.connectOptions?.accountAbstraction,appMetadata:e.connectOptions?.appMetadata,chain:e.connectOptions?.chain,chains:e.connectOptions?.chains,client:e.client,connectLocale:e.connectLocale,isEmbed:e.isEmbed,onBack:()=>y(p.backScreen),onSelect:e=>{let t=e.getAccount(),n=e.getChain();e&&t&&n&&h({account:t,chain:n,wallet:e})},hiddenWallets:e.hiddenWallets,recommendedWallets:e.connectOptions?.recommendedWallets,showAllWallets:e.connectOptions?.showAllWallets===void 0||e.connectOptions?.showAllWallets,walletConnect:e.connectOptions?.walletConnect,wallets:e.connectOptions?.wallets?.filter(e=>"inApp"!==e.id)});if("swap-flow"===p.id&&m)return(0,o.jsx)(e9.K,{title:e.title,transactionMode:"transaction"===c.mode,isEmbed:e.isEmbed,client:t,onBack:()=>{y({id:"buy-with-crypto"})},buyWithCryptoQuote:p.quote,payer:m,isFiatFlow:!1,onDone:D,onTryAgain:()=>{y({id:"buy-with-crypto"})},onSuccess:$,approvalAmount:p.approvalAmount});if("fiat-flow"===p.id&&m){let n=e.payOptions?.paymentInfo?.sellerAddress||m.account.address;return(0,o.jsx)(eZ,{title:e.title,transactionMode:"transaction"===c.mode,quote:p.quote,onBack:()=>{y({id:"buy-with-fiat"})},client:t,testMode:!1!==e.payOptions.buyWithFiat&&e.payOptions.buyWithFiat?.testMode===!0,theme:"string"==typeof e.theme?e.theme:e.theme.type,onDone:D,isEmbed:e.isEmbed,payer:m,receiverAddress:n,onSuccess:_})}if("transfer-flow"===p.id&&m&&u){let t=e.payOptions?.paymentInfo?.sellerAddress||u.address;return(0,o.jsx)(tx,{title:e.title,onBack:()=>y({id:"buy-with-crypto"}),payer:m,client:e.client,chain:j,token:A,tokenAmount:f,receiverAddress:t,transactionMode:"transaction"===e.payOptions.mode,payOptions:c,isEmbed:e.isEmbed,onDone:D,onTryAgain:()=>{y({id:"buy-with-crypto"})},onSuccess:$})}if("select-currency"===p.id){let e=()=>y(p.backScreen);return(0,o.jsx)(et,{onSelect:t=>{e(),N(t)},onBack:e})}if("select-to-token"===p.id){let s=n.map(e=>e.chain),a=()=>y(p.backScreen),d=c?.prefillBuy?.allowEdits;return d?.token===!1?(0,o.jsx)(tC,{chains:s,client:e.client,connectLocale:e.connectLocale,setChain:k,goBack:a}):(0,o.jsx)(w.T,{onBack:a,tokenList:((j?.id?W[j.id]:void 0)||[]).filter(e=>e.address!==r.DG),onTokenSelect:e=>{v(e),a()},chain:j,chainSelection:d?.chain!==!1?{chains:s,select:e=>{k(e)}}:void 0,connectLocale:i,client:t,modalTitle:e.title})}return(0,o.jsx)(x.mc,{animate:"fadein",children:(0,o.jsxs)("div",{children:["main"===p.id&&(0,o.jsx)(tk,{title:e.title,payerAccount:m?.account,client:t,onSelectBuyToken:()=>y({id:"select-to-token",backScreen:p}),payOptions:c,setTokenAmount:g,setToChain:k,setToToken:v,setFromChain:P,setFromToken:O,toChain:j,toToken:A,tokenAmount:f,connectOptions:e.connectOptions,setScreen:y,supportedDestinations:n,onBack:e.onBack,theme:e.theme,hasEditedAmount:S,setHasEditedAmount:E,enabledPaymentMethods:K}),("select-payment-method"===p.id||"buy-with-crypto"===p.id||"buy-with-fiat"===p.id||"select-from-token"===p.id)&&m&&(0,o.jsxs)(tw,{disabled:"prefillBuy"in c&&c.prefillBuy?.allowEdits?.amount===!1||"fund_wallet"!==c.mode,title:e.title,selectedChain:j,selectedToken:A,tokenAmount:f,setTokenAmount:g,client:t,onBack:()=>{"buy-with-crypto"===p.id||"buy-with-fiat"===p.id?y({id:"select-from-token",backScreen:{id:"main"}}):"select-from-token"===p.id?y(p.backScreen):y({id:"main"})},children:["buy-with-crypto"===p.id&&u&&(0,o.jsx)(e3,{setScreen:y,tokenAmount:T,toChain:j,toToken:A,fromChain:B,fromToken:L,showFromTokenSelector:()=>{y({id:"select-from-token",backScreen:p})},payer:m,client:t,isEmbed:e.isEmbed,onDone:D,payOptions:c,connectLocale:i,connectOptions:e.connectOptions,setPayer:h,activeAccount:u,setTokenAmount:g,setHasEditedAmount:E,disableTokenSelection:!0===M||!1!==c.buyWithCrypto&&c.buyWithCrypto?.prefillSource?.allowEdits?.chain===!1&&c.buyWithCrypto?.prefillSource?.allowEdits?.token===!1}),"buy-with-fiat"===p.id&&(0,o.jsx)(eR,{setScreen:y,tokenAmount:T,toChain:j,toToken:A,selectedCurrency:F,client:t,isEmbed:e.isEmbed,onDone:D,payOptions:c,theme:e.theme,showCurrencySelector:()=>{y({id:"select-currency",backScreen:p})},payer:m,setTokenAmount:g,setHasEditedAmount:E}),"select-from-token"===p.id&&I.data&&z&&(0,o.jsx)(tt,{fiatSupported:!1!==e.payOptions.buyWithFiat,client:e.client,sourceTokens:z,sourceSupportedTokens:z,toChain:j,toToken:A,tokenAmount:f,mode:c.mode,hiddenWallets:e.hiddenWallets,onConnect:()=>{y({id:"connect-payer-wallet",backScreen:p})},onPayWithFiat:()=>{y({id:"buy-with-fiat"})},onSelectToken:(e,t,n)=>{let o=e.getAccount();o&&(h({account:o,chain:n,wallet:e}),O(t),P(n)),y({id:"buy-with-crypto"})}})]})]})})}function tj(e){return(0,o.jsx)("div",{children:(0,o.jsxs)(x.mc,{flex:"row",gap:"sm",center:"y",style:{justifyContent:"space-between"},children:[(0,o.jsxs)(x.mc,{flex:"row",gap:"xxs",center:"y",children:[(0,o.jsx)(f.pd,{variant:"outline",pattern:"^[0-9]*[.,]?[0-9]*$",inputMode:"decimal",tabIndex:-1,placeholder:"0",type:"text","data-placeholder":""===e.tokenAmount,value:e.tokenAmount||"0",disabled:e.disabled,onClick:t=>{""===e.tokenAmount&&t.currentTarget.setSelectionRange(t.currentTarget.value.length,t.currentTarget.value.length)},onChange:t=>{let n=t.target.value;(n=n.replace(",",".")).startsWith(".")&&(n=`0${n}`),!(n.length>10||Number.isNaN(Number(n)))&&(n.startsWith("0")&&!n.startsWith("0.")?e.setTokenAmount(n.slice(1)):e.setTokenAmount(n))},style:{border:"none",fontSize:c.J.lg,boxShadow:"none",borderRadius:"0",padding:"0",paddingBlock:"2px",fontWeight:600,textAlign:"left",width:(()=>{let t=(0,i.Z)(Number(e.tokenAmount),5).toString(),n=t.replace(".","").length;return t.includes(".")&&(n+=.3),`calc(${Math.max(1,n)}ch + 2px)`})()}}),(0,o.jsxs)(x.mc,{flex:"row",gap:"xxs",center:"y",children:[(0,o.jsx)(g.C,{token:e.selectedToken,chain:e.selectedChain,size:"md",color:"secondaryText"}),(0,o.jsx)(K.f,{chain:e.selectedChain,client:e.client,size:"sm",token:e.selectedToken})]}),(0,o.jsx)(e4,{chain:e.selectedChain,client:e.client,tokenAmount:e.tokenAmount,token:e.selectedToken,size:"sm"})]}),(0,o.jsx)(h.R,{chain:e.selectedChain,client:e.client,size:"sm",short:!0})]})})}function tk(e){let{setTokenAmount:t,setToChain:n,setToToken:s,setFromChain:a,setFromToken:r,payerAccount:i,client:c,tokenAmount:d,payOptions:l,toToken:u,toChain:m,supportedDestinations:h,enabledPaymentMethods:f}=e,{buyWithCryptoEnabled:g,buyWithFiatEnabled:k}=f,w=!d;switch(l.mode){case"transaction":return(0,o.jsx)(J,{supportedDestinations:h,payUiOptions:l,payerAccount:i,connectOptions:e.connectOptions,client:c,onContinue:(o,i,c)=>{t(o),n(i),a(i),r(c),s(c),k&&!g?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-from-token",backScreen:{id:"main"}})}});case"direct_payment":return(0,o.jsx)(N,{client:c,payUiOptions:l,payerAccount:i,connectOptions:e.connectOptions,supportedDestinations:h,onContinue:(o,i,c)=>{t(o),n(i),a(i),r(c),s(c),k&&!g?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-from-token",backScreen:{id:"main"}})}});default:return(0,o.jsxs)(x.mc,{p:"lg",children:[(0,o.jsx)(x.rQ,{title:e.title,onBack:e.onBack}),(0,o.jsx)(p.h,{y:"xl"}),(0,o.jsx)(e6,{value:d,onChange:async n=>{e.setHasEditedAmount(!0),t(n)},freezeAmount:l.prefillBuy?.allowEdits?.amount===!1,freezeChainAndToken:l.prefillBuy?.allowEdits?.chain===!1&&l.prefillBuy?.allowEdits?.token===!1||!1!==l.buyWithCrypto&&l.buyWithCrypto?.prefillSource?.allowEdits?.token===!1&&l.buyWithCrypto?.prefillSource?.allowEdits?.chain===!1,token:u,chain:m,onSelectToken:e.onSelectBuyToken,client:e.client}),(0,o.jsx)(p.h,{y:"md"}),(0,o.jsx)(x.mc,{flex:"column",gap:"sm",children:i?(0,o.jsx)(y.$n,{variant:"accent",fullWidth:!0,disabled:w,"data-disabled":w,onClick:()=>{k&&!g?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-from-token",backScreen:{id:"main"}})},children:"Continue"}):(0,o.jsx)("div",{children:(0,o.jsx)(j.p,{...e.connectOptions,client:e.client,theme:e.theme,connectButton:{style:{width:"100%"}}})})})]})}}function tw(e){return(0,o.jsxs)(x.mc,{children:[(0,o.jsx)(x.mc,{p:"lg",children:(0,o.jsx)(x.rQ,{title:e.title,onBack:e.onBack})}),(0,o.jsxs)(x.mc,{px:"lg",style:{paddingBottom:c.YK.lg},children:[(0,o.jsx)(p.h,{y:"xs"}),(0,o.jsx)(tj,{selectedToken:e.selectedToken,selectedChain:e.selectedChain,tokenAmount:e.tokenAmount,setTokenAmount:e.setTokenAmount,client:e.client,disabled:e.disabled}),(0,o.jsx)(p.h,{y:"sm"}),(0,o.jsx)(x.N1,{}),(0,o.jsx)(p.h,{y:"sm"}),e.children]})]})}function tb(e,t,n){if(n)return n;let o={},s=!1===t.buyWithFiat,a=!1===t.buyWithCrypto;for(let t of e)o[t.chain.id]=t.tokens.filter(e=>void 0===e.buyWithCryptoEnabled&&void 0===e.buyWithFiatEnabled||!!e.buyWithCryptoEnabled&&!!e.buyWithFiatEnabled||(!!e.buyWithCryptoEnabled||!s)&&(!!e.buyWithFiatEnabled||!a));return o}function tC(e){return(0,o.jsx)(k.Hh,{client:e.client,connectLocale:e.connectLocale,showTabs:!1,onBack:e.goBack,chains:e.chains,closeModal:e.goBack,networkSelector:{renderChain:t=>(0,o.jsx)(k.O$,{chain:t.chain,confirming:!1,switchingFailed:!1,onClick:()=>{e.setChain(t.chain),e.goBack()},client:e.client,connectLocale:e.connectLocale})}})}},86880:(e,t,n)=>{n.d(t,{rr:()=>r});var o=n(92921);let s=[],a=[{type:"uint8"}];async function r(e){return(0,o.readContract)({contract:e.contract,method:["0x313ce567",s,a],params:[]})}},96042:(e,t,n)=>{n.d(t,{getCurrencyMetadata:()=>x});var o=n(67889),s=n(81489),a=n(92921);let r=[],i=[{type:"string"}];async function c(e){return(0,a.readContract)({contract:e.contract,method:["0x06fdde03",r,i],params:[]})}async function d(e){return(0,s.n)(()=>c(e),{cacheKey:`${e.contract.chain.id}:${e.contract.address}:name`,cacheTime:Number.POSITIVE_INFINITY})}let l=[],u=[{type:"string"}];async function m(e){return(0,a.readContract)({contract:e.contract,method:["0x95d89b41",l,u],params:[]})}async function h(e){return(0,s.n)(()=>m(e),{cacheKey:`${e.contract.chain.id}:${e.contract.address}:symbol`,cacheTime:Number.POSITIVE_INFINITY})}var p=n(86880);async function x(e){if((0,o.dw)(e.contract.address))return{name:"Ether",symbol:"ETH",decimals:18,...e.contract.chain.nativeCurrency};try{let[t,n,o]=await Promise.all([d(e).catch(()=>""),h(e),(0,p.rr)(e)]);return{name:t,symbol:n,decimals:o}}catch{throw Error("Invalid currency token")}}}}]);