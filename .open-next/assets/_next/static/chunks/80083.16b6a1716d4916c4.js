try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="6b8a0773-d626-4e6e-aa02-4919e9abaf2a",e._sentryDebugIdIdentifier="sentry-dbid-6b8a0773-d626-4e6e-aa02-4919e9abaf2a")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[80083],{29001:(e,t,a)=>{a.d(t,{HM:()=>d,Lc:()=>p,Mi:()=>c,zi:()=>u});var r=a(94543),n=a(92921),i=a(28969),s=a(84828),o=a(81489);async function c(e){let{factoryContract:t,predictAddressOverride:a,adminAddress:r,accountSalt:c,accountAddress:d}=e;if(a)return a(t,r);if(d)return d;if(!r)throw Error("Account address is required to predict the smart wallet address.");return(0,o.n)(async()=>{let e=c&&(0,i.q)(c)?c:(0,s.i3)(c??"");return(0,n.readContract)({contract:t,method:"function getAddress(address, bytes) returns (address)",params:[r,e]})},{cacheKey:`${e.factoryContract.chain.id}-${e.factoryContract.address}-${e.adminAddress}-${e.accountSalt}`,cacheTime:864e5})}function d(e){let{adminAddress:t,factoryContract:a,createAccountOverride:n,accountSalt:o}=e;if(n)return n(a,t);let c=o&&(0,i.q)(o)?o:(0,s.i3)(o??"");return(0,r.m)({contract:a,method:"function createAccount(address, bytes) returns (address)",params:[t,c]})}function p(e){let{accountContract:t,transaction:a,executeOverride:n}=e;return n?n(t,a):(0,r.m)({contract:t,method:"function execute(address, uint256, bytes)",params:[a.to||"",a.value||0n,a.data||"0x"],gas:a.gas?a.gas+21000n:void 0})}function u(e){let{accountContract:t,transactions:a,executeBatchOverride:n}=e;return n?n(t,a):(0,r.m)({contract:t,method:"function executeBatch(address[], uint256[], bytes[])",params:[a.map(e=>e.to||""),a.map(e=>e.value||0n),a.map(e=>e.data||"0x")]})}},80083:(e,t,a)=>{a.d(t,{connectSmartAccount:()=>e1,disconnectSmartAccount:()=>e6});var r=a(93940),n=a(57369),i=a(17062),s=a(15438),o=a(29156),c=a(67889),d=a(11755),p=a(51146),u=a(92921);let l=[{type:"address",name:"signer"}],m=[{type:"tuple",name:"permissions",components:[{type:"address",name:"signer"},{type:"address[]",name:"approvedTargets"},{type:"uint256",name:"nativeTokenLimitPerTransaction"},{type:"uint128",name:"startTimestamp"},{type:"uint128",name:"endTimestamp"}]}];async function y(e){return(0,u.readContract)({contract:e.contract,method:["0xf15d424e",l,m],params:[e.signer]})}var f=a(94543),v=a(8636);let h=[{type:"tuple",name:"req",components:[{type:"address",name:"signer"},{type:"uint8",name:"isAdmin"},{type:"address[]",name:"approvedTargets"},{type:"uint256",name:"nativeTokenLimitPerTransaction"},{type:"uint128",name:"permissionStartTimestamp"},{type:"uint128",name:"permissionEndTimestamp"},{type:"uint128",name:"reqValidityStartTimestamp"},{type:"uint128",name:"reqValidityEndTimestamp"},{type:"bytes32",name:"uid"}]},{type:"bytes",name:"signature"}],g=[];var w=a(17316);function G(){return new Date(Date.now()+31536e7)}function A(e){return(0,w.Dg)(Math.floor(e.getTime()/1e3))}var b=a(47836);let L=[{name:"signer",type:"address"},{name:"isAdmin",type:"uint8"},{name:"approvedTargets",type:"address[]"},{name:"nativeTokenLimitPerTransaction",type:"uint256"},{name:"permissionStartTimestamp",type:"uint128"},{name:"permissionEndTimestamp",type:"uint128"},{name:"reqValidityStartTimestamp",type:"uint128"},{name:"reqValidityEndTimestamp",type:"uint128"},{name:"uid",type:"bytes32"}];async function P(e){let{account:t,contract:a,req:r}=e,n=await t.signTypedData({domain:{name:"Account",version:"1",verifyingContract:a.address,chainId:a.chain.id},primaryType:"SignerPermissionRequest",types:{SignerPermissionRequest:L},message:r});return{req:r,signature:n}}async function x(e){let{target:t,permissions:a}=e;return{approvedTargets:"*"===a.approvedTargets?[c.cF]:a.approvedTargets,nativeTokenLimitPerTransaction:(0,p.fq)(a.nativeTokenLimitPerTransaction?.toString()||"0"),permissionStartTimestamp:A(a.permissionStartTimestamp||new Date(0)),permissionEndTimestamp:A(a.permissionEndTimestamp||G()),reqValidityStartTimestamp:0n,reqValidityEndTimestamp:A(G()),uid:await (0,b.O)(),isAdmin:0,signer:t}}async function T(e){var t,a;let{accountContract:r,sessionKeyAddress:n,newPermissions:i}=e;if(!await (0,d.isContractDeployed)(r))return!0;let s=await y({contract:r,signer:n});return!!(s.endTimestamp&&s.endTimestamp<Math.floor(new Date().getTime()/1e3)||(t=s.approvedTargets,!("*"===(a=i.approvedTargets)&&1===t.length&&t[0]===c.cF||"*"!==a&&a.map(e=>e.toLowerCase()).every(e=>t.map(e=>e.toLowerCase()).includes(e))))||(0,p.fq)(i.nativeTokenLimitPerTransaction?.toString()??"0")>s.nativeTokenLimitPerTransaction)}var O=a(42015),I=a(85442),V=a(14588),D=a(64865),C=a(64179),U=a(59353),k=a(45390);let E=2n**96n-1n;var B=a(87407),M=a(18368),$=a(15190),S=a(175),F=a(24798),H=a(21448),j=a(42580);let N=j.k;var q=a(93076),_=a(85324),R=a(53220),z=a(44545);let K="/docs/contract/decodeEventLog";var W=a(7644),Z=a(51781);class Q extends Z.C{constructor(e){super(`Filter type "${e}" is not supported.`,{name:"FilterTypeNotSupportedError"})}}var J=a(10565),X=a(56766),Y=a(99449);let ee="/docs/contract/encodeEventTopics";function et({param:e,value:t}){if("string"===e.type||"bytes"===e.type)return(0,H.S)((0,F.ZJ)(t));if("tuple"===e.type||e.type.match(/^(.*)\[(\d+)?\]$/))throw new Q(e.type);return(0,J.h)([e],[t])}function ea(e){let t;let{signature:a}=e;return{abiEvent:t=a&&"object"==typeof a&&"type"in a&&"event"===a.type?a:(0,W.$)(a),hash:(0,j.k)(t),topics:function(e){let{abi:t,eventName:a,args:r}=e,n=t[0];if(a){let e=function(e){let t;let{abi:a,args:r=[],name:n}=e,i=(0,X.q)(n,{strict:!1}),s=a.filter(e=>i?"function"===e.type?(0,Y.V)(e)===n:"event"===e.type&&N(e)===n:"name"in e&&e.name===n);if(0!==s.length){if(1===s.length)return s[0];for(let e of s){if("inputs"in e){if(!r||0===r.length){if(!e.inputs||0===e.inputs.length)return e;continue}if(e.inputs&&0!==e.inputs.length&&e.inputs.length===r.length&&r.every((t,a)=>{let r="inputs"in e&&e.inputs[a];return!!r&&function e(t,a){let r=typeof t,n=a.type;switch(n){case"address":return(0,S.P)(t,{strict:!1});case"bool":return"boolean"===r;case"function":case"string":return"string"===r;default:if("tuple"===n&&"components"in a)return Object.values(a.components).every((a,r)=>e(Object.values(t)[r],a));if(/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(n))return"number"===r||"bigint"===r;if(/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(n))return"string"===r||t instanceof Uint8Array;if(/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(n))return Array.isArray(t)&&t.every(t=>e(t,{...a,type:n.replace(/(\[[0-9]{0,}\])$/,"")}));return!1}}(t,r)})){if(t&&"inputs"in t&&t.inputs){let a=function e(t,a,r){for(let n in t){let i=t[n],s=a[n];if("tuple"===i.type&&"tuple"===s.type&&"components"in i&&"components"in s)return e(i.components,s.components,r[n]);let o=[i.type,s.type];if(o.includes("address")&&o.includes("bytes20")||(o.includes("address")&&o.includes("string")||o.includes("address")&&o.includes("bytes"))&&(0,S.P)(r[n],{strict:!1}))return o}}(e.inputs,t.inputs,r);if(a)throw new M.nM({abiItem:e,type:a[0]},{abiItem:t,type:a[1]})}t=e}}}return t||s[0]}}({abi:t,name:a});if(!e)throw new M.M_(a,{docsPath:ee});n=e}if("event"!==n.type)throw new M.M_(void 0,{docsPath:ee});let i=N((0,z.B)(n)),s=[];if(r&&"inputs"in n){let e=n.inputs?.filter(e=>"indexed"in e&&e.indexed),t=Array.isArray(r)?r:Object.values(r).length>0?e?.map(e=>r[e.name])??[]:[];t.length>0&&(s=e?.map((e,a)=>Array.isArray(t[a])?t[a].map((r,n)=>et({param:e,value:t[a][n]})):void 0!==t[a]&&null!==t[a]?et({param:e,value:t[a]}):null)??[])}return[i,...s]}({abi:[t],args:e.filters})}}var er=a(84828),en=a(63928),ei=a(77969),es=a(88541),eo=a(28969);let ec=()=>{let e=BigInt(Math.floor(0x100000000*Math.random())),t=BigInt(Math.floor(0x100000000*Math.random())),a=BigInt(Math.floor(0x100000000*Math.random())),r=BigInt(Math.floor(0x100000000*Math.random())),n=BigInt(Math.floor(0x100000000*Math.random())),i=BigInt(Math.floor(0x100000000*Math.random()));return e<<BigInt(160)|t<<BigInt(128)|a<<BigInt(96)|r<<BigInt(64)|n<<BigInt(32)|i};function ed(e){return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,null==t||(0,eo.q)(t)?t:(0,er.nj)(t)]))}async function ep(e){return eh({...e,operation:"eth_sendUserOperation",params:[ed(e.userOp),e.options.entrypointAddress??es.uh]})}async function eu(e,t){let a=await eh({...e,operation:"eth_estimateUserOperationGas",params:[ed(e.userOp),e.options.entrypointAddress??es.uh,t??{}]});return{preVerificationGas:(0,er.uU)(a.preVerificationGas),verificationGas:void 0!==a.verificationGas?(0,er.uU)(a.verificationGas):void 0,verificationGasLimit:(0,er.uU)(a.verificationGasLimit),callGasLimit:(0,er.uU)(a.callGasLimit)+es.L8,paymasterVerificationGasLimit:void 0!==a.paymasterVerificationGasLimit?(0,er.uU)(a.paymasterVerificationGasLimit):void 0,paymasterPostOpGasLimit:void 0!==a.paymasterPostOpGasLimit?(0,er.uU)(a.paymasterPostOpGasLimit):void 0}}async function el(e){let t=await eh({...e,operation:"thirdweb_getUserOperationGasPrice",params:[]});return{maxPriorityFeePerGas:(0,er.uU)(t.maxPriorityFeePerGas),maxFeePerGas:(0,er.uU)(t.maxFeePerGas)}}async function em(e){let t=await ey(e);if(t){if(!1===t.success){let e=function(e){let{logs:t,events:a,strict:r}=e;return function(e){let{abi:t,args:a,logs:r,strict:n=!0}=e,i=(()=>{if(e.eventName)return Array.isArray(e.eventName)?e.eventName:[e.eventName]})();return r.map(e=>{try{let r=t.find(t=>"event"===t.type&&e.topics[0]===N(t));if(!r)return null;let s=function(e){let{abi:t,data:a,strict:r,topics:n}=e,i=r??!0,[s,...o]=n;if(!s)throw new M._z({docsPath:K});let c=1===t.length?t[0]:t.find(e=>"event"===e.type&&s===N((0,z.B)(e)));if(!(c&&"name"in c)||"event"!==c.type)throw new M.kE(s,{docsPath:K});let{name:d,inputs:p}=c,u=p?.some(e=>!("name"in e&&e.name)),l=u?[]:{},m=p.filter(e=>"indexed"in e&&e.indexed);for(let e=0;e<m.length;e++){let t=m[e],a=o[e];if(!a)throw new M.l3({abiItem:c,param:t});l[u?e:t.name||e]=function({param:e,value:t}){return"string"===e.type||"bytes"===e.type||"tuple"===e.type||e.type.match(/^(.*)\[(\d+)?\]$/)?t:((0,R.n)([e],t)||[])[0]}({param:t,value:a})}let y=p.filter(e=>!("indexed"in e&&e.indexed));if(y.length>0){if(a&&"0x"!==a)try{let e=(0,R.n)(y,a);if(e){if(u)l=[...l,...e];else for(let t=0;t<y.length;t++)l[y[t].name]=e[t]}}catch(e){if(i){if(e instanceof M.Iy||e instanceof _.SK)throw new M.fo({abiItem:c,data:a,params:y,size:(0,q.E)(a)});throw e}}else if(i)throw new M.fo({abiItem:c,data:"0x",params:y,size:0})}return{eventName:d,args:Object.values(l).length>0?l:void 0}}({...e,abi:[r],strict:n});if(i&&!i.includes(s.eventName)||!function(e){let{args:t,inputs:a,matchArgs:r}=e;if(!r)return!0;if(!t)return!1;function n(e,t,a){try{if("address"===e.type)return function(e,t){if(!(0,S.P)(e,{strict:!1}))throw new $.M({address:e});if(!(0,S.P)(t,{strict:!1}))throw new $.M({address:t});return e.toLowerCase()===t.toLowerCase()}(t,a);if("string"===e.type||"bytes"===e.type)return(0,H.S)((0,F.ZJ)(t))===a;return t===a}catch{return!1}}return Array.isArray(t)&&Array.isArray(r)?r.every((e,r)=>{if(null==e)return!0;let i=a[r];return!!i&&(Array.isArray(e)?e:[e]).some(e=>n(i,e,t[r]))}):!("object"!=typeof t||Array.isArray(t)||"object"!=typeof r||Array.isArray(r))&&Object.entries(r).every(([e,r])=>{if(null==r)return!0;let i=a.find(t=>t.name===e);return!!i&&(Array.isArray(r)?r:[r]).some(a=>n(i,a,t[e]))})}({args:s.args,inputs:r.inputs,matchArgs:a}))return null;return{...s,...e}}catch(r){let t,a;if(r instanceof M.kE)return null;if(r instanceof M.fo||r instanceof M.l3){if(n)return null;t=r.abiItem.name,a=r.abiItem.inputs?.some(e=>!("name"in e&&e.name))}return{...e,args:a?[]:{},eventName:t}}}).filter(Boolean)}({logs:t,abi:a.map(e=>e.abiEvent),strict:r})}({events:[function(e={}){return ea({signature:"event UserOperationRevertReason(bytes32 indexed userOpHash, address indexed sender, uint256 nonce, bytes revertReason)",filters:e})}(),function(e={}){return ea({signature:"event PostOpRevertReason(bytes32 indexed userOpHash, address indexed sender, uint256 nonce, bytes revertReason)",filters:e})}()],logs:t.logs}),a=e[0]?.args?.revertReason;if(!a)throw Error(`UserOp failed at txHash: ${t.receipt.transactionHash}`);let r=(0,B.W)({data:a});throw Error(`UserOp failed with reason: '${r.args.join(",")}' at txHash: ${t.receipt.transactionHash}`)}return t.receipt}}async function ey(e){let t=await eh({options:e,operation:"eth_getUserOperationReceipt",params:[e.userOpHash]});if(t)return function(e){let{receipt:t}=e,a={...t,transactionHash:t.transactionHash,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,contractAddress:t.contractAddress?t.contractAddress:null,cumulativeGasUsed:t.cumulativeGasUsed?BigInt(t.cumulativeGasUsed):null,effectiveGasPrice:t.effectiveGasPrice?BigInt(t.effectiveGasPrice):null,gasUsed:t.gasUsed?BigInt(t.gasUsed):null,logs:t.logs,to:t.to?t.to:null,transactionIndex:t.transactionIndex,status:t.status,type:t.type};return t.blobGasPrice&&(a.blobGasPrice=BigInt(t.blobGasPrice)),t.blobGasUsed&&(a.blobGasUsed=BigInt(t.blobGasUsed)),{...e,receipt:a,userOpHash:e.userOpHash,actualGasCost:BigInt(e.actualGasCost),actualGasUsed:BigInt(e.actualGasUsed),nonce:BigInt(e.nonce)}}(t)}async function ef(e){let t=await eh({options:e.options,operation:"zk_paymasterData",params:[e.transaction]});return{paymaster:t.paymaster,paymasterInput:t.paymasterInput}}async function ev(e){return{transactionHash:(await eh({options:e.options,operation:"zk_broadcastTransaction",params:[{...e.transaction,signedTransaction:e.signedTransaction}]})).transactionHash}}async function eh(e){let{options:t,operation:a,params:r}=e,n=t.bundlerUrl??(0,es.RZ)(t.chain),i=(0,en.KI)(t.client),s=await i(n,{method:"POST",headers:{"Content-Type":"application/json"},body:(0,ei.A)({jsonrpc:"2.0",id:1,method:a,params:r})}),o=await s.json();if(!s.ok||o.error){let e=o.error||s.statusText;"object"==typeof e&&(e=(0,ei.A)(e));let t=o.code||"UNKNOWN";throw Error(`${a} error: ${e}
Status: ${s.status}
Code: ${t}`)}return o.result}var eg=a(29001),ew=a(76172),eG=a(90017);let eA=[{type:"address",name:"sender"},{type:"uint192",name:"key"}],eb=[{type:"uint256",name:"nonce"}];async function eL(e){return(0,u.readContract)({contract:e.contract,method:["0x35567e1a",eA,eb],params:[e.sender,e.key]})}let eP=[{type:"tuple",name:"userOp",components:[{type:"address",name:"sender"},{type:"uint256",name:"nonce"},{type:"bytes",name:"initCode"},{type:"bytes",name:"callData"},{type:"uint256",name:"callGasLimit"},{type:"uint256",name:"verificationGasLimit"},{type:"uint256",name:"preVerificationGas"},{type:"uint256",name:"maxFeePerGas"},{type:"uint256",name:"maxPriorityFeePerGas"},{type:"bytes",name:"paymasterAndData"},{type:"bytes",name:"signature"}]}],ex=[{type:"bytes32"}];async function eT(e){return(0,u.readContract)({contract:e.contract,method:["0xa6193531",eP,ex],params:[e.userOp]})}let eO=[{type:"tuple",name:"userOp",components:[{type:"address",name:"sender"},{type:"uint256",name:"nonce"},{type:"bytes",name:"initCode"},{type:"bytes",name:"callData"},{type:"bytes32",name:"accountGasLimits"},{type:"uint256",name:"preVerificationGas"},{type:"bytes32",name:"gasFees"},{type:"bytes",name:"paymasterAndData"},{type:"bytes",name:"signature"}]}],eI=[{type:"bytes32"}];async function eV(e){return(0,u.readContract)({contract:e.contract,method:["0x22cdde4c",eO,eI],params:[e.userOp]})}var eD=a(25418),eC=a(93254),eU=a(20128),ek=a(6648),eE=a(34085),eB=a(2714),eM=a(96840);let e$=e=>({sender:e.sender,nonce:BigInt(e.nonce),initCode:function(e){return e.factory?(0,eG.xW)([e.factory,e.factoryData||"0x"]):"0x"}(e),callData:e.callData,accountGasLimits:function(e){return(0,eG.xW)([(0,eB.eV)((0,eM.nj)(BigInt(e.verificationGasLimit)),{size:16}),(0,eB.eV)((0,eM.nj)(BigInt(e.callGasLimit)),{size:16})])}(e),preVerificationGas:BigInt(e.preVerificationGas),gasFees:function(e){return(0,eG.xW)([(0,eB.eV)((0,eM.nj)(BigInt(e.maxPriorityFeePerGas)),{size:16}),(0,eB.eV)((0,eM.nj)(BigInt(e.maxFeePerGas)),{size:16})])}(e),paymasterAndData:function(e){return e.paymaster?(0,eG.xW)([e.paymaster,(0,eB.eV)((0,eM.nj)(BigInt(e.paymasterVerificationGasLimit||0)),{size:16}),(0,eB.eV)((0,eM.nj)(BigInt(e.paymasterPostOpGasLimit||0)),{size:16}),e.paymasterData||"0x"]):"0x"}(e),signature:e.signature});async function eS(e){let{userOp:t,paymasterOverride:a,client:r,chain:n,entrypointAddress:i}=e;if(a)return a(t);let s=i??es.uh,o=(0,es.RZ)(n),c={jsonrpc:"2.0",id:1,method:"pm_sponsorUserOperation",params:[ed(t),s]},d=(0,en.KI)(r),p=await d(o,{method:"POST",headers:{"Content-Type":"application/json"},body:(0,ei.A)(c)}),u=await p.json();if(!p.ok){let e=u.error||p.statusText,t=u.code||"UNKNOWN";throw Error(`Paymaster error: ${e}
Status: ${p.status}
Code: ${t}`)}if(u.result)return"string"==typeof u.result?{paymasterAndData:u.result}:(u.result.policyId&&u.result.reason&&console.warn(`Paymaster policy rejected this transaction with reason: ${u.result.reason} (policyId: ${u.result.policyId})`),{paymasterAndData:u.result.paymasterAndData,verificationGasLimit:u.result.verificationGasLimit?(0,er.uU)(u.result.verificationGasLimit):void 0,preVerificationGas:u.result.preVerificationGas?(0,er.uU)(u.result.preVerificationGas):void 0,callGasLimit:u.result.callGasLimit?(0,er.uU)(u.result.callGasLimit):void 0,paymaster:u.result.paymaster,paymasterData:u.result.paymasterData,paymasterVerificationGasLimit:u.result.paymasterVerificationGasLimit?(0,er.uU)(u.result.paymasterVerificationGasLimit):void 0,paymasterPostOpGasLimit:u.result.paymasterPostOpGasLimit?(0,er.uU)(u.result.paymasterPostOpGasLimit):void 0});let l=u.error?.message||u.error||p.statusText||"unknown error";throw Error(`Paymaster error from ${o}: ${l}`)}let eF=new Set,eH=e=>`${e.chain.id}:${e.address}`,ej=e=>{eF.add(eH(e))},eN=e=>{eF.delete(eH(e))},eq=e=>eF.has(eH(e));async function e_(e){let t=e.timeoutMs||12e4,a=e.intervalMs||1e3,r=Date.now()+t;for(;Date.now()<r;){let t=await em(e);if(t)return t;await new Promise(e=>setTimeout(e,a))}throw Error(`Timeout waiting for userOp to be mined on chain ${e.chain.id} with UserOp hash: ${e.userOpHash}`)}async function eR(e){let{transaction:t,accountContract:a,factoryContract:r,adminAddress:n,overrides:i,sponsorGas:s,waitForDeployment:o=!0,isDeployedOverride:c}=e,p=t.chain,u=t.client,l={client:u,chain:p,bundlerUrl:i?.bundlerUrl,entrypointAddress:i?.entrypointAddress},m=(0,es.Fn)(e.overrides?.entrypointAddress||es.uh),[y,f,v,h,g]=await Promise.all(["boolean"==typeof c?c:(0,d.isContractDeployed)(a).then(e=>e||eq(a)),(0,eC.encode)(t),(0,U.r)(t.gas),ez({executeTx:t,bundlerOptions:l,chain:p,client:u}),eX({accountContract:a,chain:p,client:u,entrypointAddress:i?.entrypointAddress,getNonceOverride:i?.getAccountNonce})]),{maxFeePerGas:w,maxPriorityFeePerGas:G}=h;return"v0.7"===m?eK({bundlerOptions:l,factoryContract:r,accountContract:a,adminAddress:n,sponsorGas:s,overrides:i,isDeployed:y,nonce:g,callData:f,callGasLimit:v,maxFeePerGas:w,maxPriorityFeePerGas:G,waitForDeployment:o}):eW({bundlerOptions:l,factoryContract:r,accountContract:a,adminAddress:n,sponsorGas:s,overrides:i,isDeployed:y,nonce:g,callData:f,callGasLimit:v,maxFeePerGas:w,maxPriorityFeePerGas:G,waitForDeployment:o})}async function ez(e){let{executeTx:t,bundlerOptions:a,chain:r,client:n}=e,{maxFeePerGas:i,maxPriorityFeePerGas:s}=t,o=a?.bundlerUrl??(0,es.RZ)(r);if((0,en.Lj)(o)){let e=await el({options:a});i=e.maxFeePerGas,s=e.maxPriorityFeePerGas}else{let[e,t]=await Promise.all([(0,U.r)(i),(0,U.r)(s)]);if(e&&t)i=e,s=t;else{let a=await (0,eD.G)(n,r);s=t??a.maxPriorityFeePerGas??0n,i=e??a.maxFeePerGas??0n}}return{maxFeePerGas:i,maxPriorityFeePerGas:s}}async function eK(e){let t,a;let{bundlerOptions:r,isDeployed:n,factoryContract:i,accountContract:s,adminAddress:o,sponsorGas:c,overrides:d,nonce:p,callData:u,callGasLimit:l,maxFeePerGas:m,maxPriorityFeePerGas:y,waitForDeployment:f}=e,{chain:v,client:h}=r;n?(a="0x",f&&await eY(s)):(t=i.address,a=await (0,eC.encode)((0,eg.HM)({factoryContract:i,adminAddress:o,accountSalt:d?.accountSalt,createAccountOverride:d?.createAccount})),f&&ej(s));let g={sender:s.address,nonce:p,callData:u,maxFeePerGas:m,maxPriorityFeePerGas:y,callGasLimit:l??0n,verificationGasLimit:0n,preVerificationGas:0n,factory:t,factoryData:a,paymaster:void 0,paymasterData:"0x",paymasterVerificationGasLimit:0n,paymasterPostOpGasLimit:0n,signature:es.km};if(c){let e=await eS({userOp:g,chain:v,client:h,entrypointAddress:d?.entrypointAddress,paymasterOverride:d?.paymaster});if(e.paymaster&&e.paymasterData&&(g.paymaster=e.paymaster,g.paymasterData=e.paymasterData),e.callGasLimit&&e.verificationGasLimit&&e.preVerificationGas&&e.paymasterPostOpGasLimit&&e.paymasterVerificationGasLimit)g.callGasLimit=e.callGasLimit,g.verificationGasLimit=e.verificationGasLimit,g.preVerificationGas=e.preVerificationGas,g.paymasterPostOpGasLimit=e.paymasterPostOpGasLimit,g.paymasterVerificationGasLimit=e.paymasterVerificationGasLimit;else{let e=d?.tokenPaymaster?{[d.tokenPaymaster.tokenAddress]:{stateDiff:{[(0,eE.S)((0,eU.hd)([{type:"address"},{type:"uint256"}],[s.address,d.tokenPaymaster.balanceStorageSlot]))]:(0,er.nj)(ew.EA,{size:32})}}}:void 0,t=await eu({userOp:g,options:r},e);g.callGasLimit=t.callGasLimit,g.verificationGasLimit=t.verificationGasLimit,g.preVerificationGas=t.preVerificationGas,g.paymasterPostOpGasLimit=d?.tokenPaymaster?500000n:t.paymasterPostOpGasLimit||0n,g.paymasterVerificationGasLimit=t.paymasterVerificationGasLimit||0n;let a=await eS({userOp:g,chain:v,client:h,entrypointAddress:d?.entrypointAddress,paymasterOverride:d?.paymaster});a.paymaster&&a.paymasterData&&(g.paymaster=a.paymaster,g.paymasterData=a.paymasterData)}}else{let e=await eu({userOp:g,options:r});g.callGasLimit=e.callGasLimit,g.verificationGasLimit=e.verificationGasLimit,g.preVerificationGas=e.preVerificationGas,g.paymasterPostOpGasLimit=e.paymasterPostOpGasLimit||0n,g.paymasterVerificationGasLimit=e.paymasterVerificationGasLimit||0n}return{...g,signature:"0x"}}async function eW(e){let t;let{bundlerOptions:a,isDeployed:r,factoryContract:n,accountContract:i,adminAddress:s,sponsorGas:o,overrides:c,nonce:d,callData:p,callGasLimit:u,maxFeePerGas:l,maxPriorityFeePerGas:m,waitForDeployment:y}=e,{chain:f,client:v}=a;r?(t="0x",y&&await eY(i)):(t=await eJ({factoryContract:n,adminAddress:s,accountSalt:c?.accountSalt,createAccountOverride:c?.createAccount}),y&&ej(i));let h={sender:i.address,nonce:d,initCode:t,callData:p,maxFeePerGas:l,maxPriorityFeePerGas:m,callGasLimit:u??0n,verificationGasLimit:0n,preVerificationGas:0n,paymasterAndData:"0x",signature:es.km};if(o){let e=await eS({userOp:h,chain:f,client:v,entrypointAddress:c?.entrypointAddress,paymasterOverride:c?.paymaster}),t="paymasterAndData"in e?e.paymasterAndData:"0x";if(t&&"0x"!==t&&(h.paymasterAndData=t),e.callGasLimit&&e.verificationGasLimit&&e.preVerificationGas)h.callGasLimit=e.callGasLimit,h.verificationGasLimit=e.verificationGasLimit,h.preVerificationGas=e.preVerificationGas;else{let e=await eu({userOp:h,options:a});if(h.callGasLimit=e.callGasLimit,h.verificationGasLimit=e.verificationGasLimit,h.preVerificationGas=e.preVerificationGas,t&&"0x"!==t){let e=await eS({userOp:h,chain:f,client:v,entrypointAddress:c?.entrypointAddress,paymasterOverride:c?.paymaster}),t="paymasterAndData"in e?e.paymasterAndData:"0x";t&&"0x"!==t&&(h.paymasterAndData=t)}}}else{let e=await eu({userOp:h,options:a});h.callGasLimit=e.callGasLimit,h.verificationGasLimit=e.verificationGasLimit,h.preVerificationGas=e.preVerificationGas}return{...h,signature:"0x"}}async function eZ(e){let{userOp:t,chain:a,entrypointAddress:r,adminAccount:n}=e,i=await eQ({client:e.client,userOp:t,chain:a,entrypointAddress:r});if(n.signMessage){let e=await n.signMessage({message:{raw:(0,ek.aT)(i)},originalMessage:(0,ei.A)(t),chainId:a.id});return{...t,signature:e}}throw Error("signMessage not implemented in signingAccount")}async function eQ(e){let t;let{userOp:a,chain:r,entrypointAddress:n}=e;if("v0.7"===(0,es.Fn)(n||es.uh)){let s=e$(a);t=await eV({contract:(0,i.P)({address:n||es.nF,chain:r,client:e.client}),userOp:s})}else t=await eT({contract:(0,i.P)({address:n||es.uh,chain:r,client:e.client}),userOp:a});return t}async function eJ(e){let{factoryContract:t,adminAddress:a,accountSalt:r,createAccountOverride:n}=e,i=(0,eg.HM)({factoryContract:t,adminAddress:a,accountSalt:r,createAccountOverride:n});return(0,eG.xW)([t.address,await (0,eC.encode)(i)])}async function eX(e){let{accountContract:t,chain:a,client:r,entrypointAddress:n,getNonceOverride:s}=e;return s?s(t):await eL({contract:(0,i.P)({address:n||es.uh,chain:a,client:r}),key:ec(),sender:t.address})}async function eY(e){let t=Date.now();for(;eq(e);){if(Date.now()-t>6e4)throw eN(e),Error("Account deployment is taking too long (over 1 minute). Please try again.");await new Promise(e=>setTimeout(e,500))}}let e0=new WeakMap,e2=new WeakMap;async function e1(e,t){let{personalAccount:a,client:s,chain:o}=e;if(!a)throw Error("No personal account provided for smart account connection");let c=o??t.chain,d="gasless"in t?t.gasless:t.sponsorGas;if(await (0,C.k)(c))return[function(e){let{creationOptions:t,connectionOptions:a,chain:i}=e,s={address:a.personalAccount.address,async sendTransaction(o){let c={data:o.data,to:o.to??void 0,value:o.value??0n,chain:(0,n.Q4)(o.chainId),client:a.client,eip712:o.eip712},d=await (0,V.f)({account:s,transaction:c});if(e.sponsorGas&&!d.paymaster){let e=await ef({options:{client:a.client,chain:i,bundlerUrl:t.overrides?.bundlerUrl,entrypointAddress:t.overrides?.entrypointAddress},transaction:d});d={...d,...e}}let p=await (0,V.a)({account:s,chainId:i.id,eip712Transaction:d}),u=await ev({options:{client:a.client,chain:i,bundlerUrl:t.overrides?.bundlerUrl,entrypointAddress:t.overrides?.entrypointAddress},transaction:d,signedTransaction:p});return(0,r.E)({client:a.client,chainId:i.id,transactionHash:u.transactionHash,walletAddress:s.address,walletType:"smart",contractAddress:o.to??void 0}),{transactionHash:u.transactionHash,client:a.client,chain:i}},signMessage:async({message:e})=>a.personalAccount.signMessage({message:e}),async signTypedData(e){let t=(0,k.y)(e);return a.personalAccount.signTypedData(t)},onTransactionRequested:async e=>a.personalAccount.onTransactionRequested?.(e)};return s}({creationOptions:t,connectionOptions:e,chain:c,sponsorGas:d}),c];if(t.factoryAddress&&!t.overrides?.entrypointAddress){let e=await e9(t.factoryAddress,s,c);e&&(t.overrides={...t.overrides,entrypointAddress:e})}t.overrides?.tokenPaymaster&&!t.overrides?.entrypointAddress&&(t.overrides={...t.overrides,entrypointAddress:es.nF});let p=t.factoryAddress??(0,es.Fd)(t.overrides?.entrypointAddress),u=(0,i.P)({client:s,address:p,chain:c}),l=await (0,eg.Mi)({factoryContract:u,adminAddress:a.address,predictAddressOverride:t.overrides?.predictAddress,accountSalt:t.overrides?.accountSalt,accountAddress:t.overrides?.accountAddress}).then(e=>e).catch(e=>{throw Error(`Failed to get account address with factory contract ${u.address} on chain ID ${c.id}: ${e?.message||"unknown error"}`,{cause:e})}),m=(0,i.P)({client:s,address:l,chain:c}),y=await e4({...t,chain:c,sponsorGas:d,personalAccount:a,accountContract:m,factoryContract:u,client:s});if(e0.set(a,y),e2.set(y,a),t.sessionKey&&await T({accountContract:m,sessionKeyAddress:t.sessionKey.address,newPermissions:t.sessionKey.permissions})){let e=function(e){let{contract:t,sessionKeyAddress:a,account:r,permissions:n}=e;return function(e){let t=(0,v.O)(async()=>"asyncParams"in e?await e.asyncParams():e);return(0,f.m)({contract:e.contract,method:["0x5892e236",h,g],params:async()=>{let e=await t();return[e.req,e.signature]},value:async()=>(await t()).overrides?.value,accessList:async()=>(await t()).overrides?.accessList,gas:async()=>(await t()).overrides?.gas,gasPrice:async()=>(await t()).overrides?.gasPrice,maxFeePerGas:async()=>(await t()).overrides?.maxFeePerGas,maxPriorityFeePerGas:async()=>(await t()).overrides?.maxPriorityFeePerGas,nonce:async()=>(await t()).overrides?.nonce,extraGas:async()=>(await t()).overrides?.extraGas,erc20Value:async()=>(await t()).overrides?.erc20Value})}({contract:t,async asyncParams(){let{req:e,signature:i}=await P({account:r,contract:t,req:await x({target:a,permissions:n})});return{signature:i,req:e}}})}({account:a,contract:m,permissions:t.sessionKey.permissions,sessionKeyAddress:t.sessionKey.address});await (0,O.sendTransaction)({account:y,transaction:e})}return[y,c]}async function e6(e){let t=e2.get(e);t&&(e0.delete(t),e2.delete(e))}async function e4(e){let t=e.overrides?.tokenPaymaster;if(t&&"v0.7"!==(0,es.Fn)(e.overrides?.entrypointAddress||es.uh))throw Error("Token paymaster is only supported for entrypoint version v0.7");let s=e.accountContract,o={address:(0,D.bv)(s.address),async sendTransaction(a){let c;if(t){await e8({accountContract:s,erc20Paymaster:t,options:e});let a=async()=>({paymaster:t.paymasterAddress,paymasterData:"0x"});c=e.overrides?.paymaster||a}else c=e.overrides?.paymaster;a.chainId!==s.chain.id&&(s=(0,i.P)({address:o.address,chain:(0,n.Q4)(a.chainId),client:e.client}));let d=(0,eg.Lc)({accountContract:s,transaction:a,executeOverride:e.overrides?.execute}),p=(0,n.Q4)(a.chainId),u=await e5({executeTx:d,options:{...e,chain:p,accountContract:s,overrides:{...e.overrides,paymaster:c}}});return(0,r.E)({client:e.client,chainId:p.id,transactionHash:u.transactionHash,walletAddress:e.accountContract.address,walletType:"smart",contractAddress:a.to??void 0}),u},async sendBatchTransaction(t){let a=(0,eg.zi)({accountContract:s,transactions:t,executeBatchOverride:e.overrides?.executeBatch});if(0===t.length)throw Error("No transactions to send");let i=t[0];if(!i)throw Error("No transactions to send");let o=(0,n.Q4)(i.chainId),c=await e5({executeTx:a,options:{...e,chain:o,accountContract:s}});return(0,r.E)({client:e.client,chainId:o.id,transactionHash:c.transactionHash,walletAddress:e.accountContract.address,walletType:"smart",contractAddress:t[0]?.to??void 0}),c},async signMessage({message:t}){if(e.overrides?.signMessage)return e.overrides.signMessage({adminAccount:e.personalAccount,factoryContract:e.factoryContract,accountContract:s,message:t});let{smartAccountSignMessage:r}=await Promise.all([a.e(19321),a.e(2445)]).then(a.bind(a,2445));return r({accountContract:s,factoryContract:e.factoryContract,options:e,message:t})},async signTypedData(t){if(e.overrides?.signTypedData)return e.overrides.signTypedData({adminAccount:e.personalAccount,factoryContract:e.factoryContract,accountContract:s,typedData:t});let{smartAccountSignTypedData:r}=await Promise.all([a.e(19321),a.e(2445)]).then(a.bind(a,2445));return r({accountContract:s,factoryContract:e.factoryContract,options:e,typedData:t})},onTransactionRequested:async t=>e.personalAccount.onTransactionRequested?.(t)};return o}async function e8(e){let{accountContract:t,erc20Paymaster:a,options:r}=e,n=a.tokenAddress,c=(0,i.P)({address:n,chain:t.chain,client:t.client});if(await (0,s.nB)({contract:c,owner:t.address,spender:a.paymasterAddress})>0n)return;let d=(0,o.S)({contract:c,spender:a.paymasterAddress,amountWei:E-1n}),p=await (0,I.$)({transaction:d,from:t.address}),u=(0,eg.Lc)({accountContract:t,transaction:p,executeOverride:r.overrides?.execute});await e5({executeTx:u,options:{...r,overrides:{...r.overrides,tokenPaymaster:void 0}}})}async function e5(e){let{executeTx:t,options:a}=e;try{let e=await eR({transaction:t,factoryContract:a.factoryContract,accountContract:a.accountContract,adminAddress:a.personalAccount.address,sponsorGas:a.sponsorGas,overrides:a.overrides}),n=await eZ({client:a.client,chain:a.chain,adminAccount:a.personalAccount,entrypointAddress:a.overrides?.entrypointAddress,userOp:e}),i={chain:a.chain,client:a.client,bundlerUrl:a.overrides?.bundlerUrl,entrypointAddress:a.overrides?.entrypointAddress},s=await ep({options:i,userOp:n}),o=await e_({...i,userOpHash:s});return(0,r.E)({client:a.client,chainId:a.chain.id,transactionHash:o.transactionHash,walletAddress:a.accountContract.address,walletType:"smart",contractAddress:await (0,U.r)(t.to??void 0)}),{client:a.client,chain:a.chain,transactionHash:o.transactionHash}}finally{eN(a.accountContract)}}async function e9(e,t,a){let r=(0,i.P)({address:e,client:t,chain:a});try{return await (0,u.readContract)({contract:r,method:"function entrypoint() public view returns (address)"})}catch{return}}}}]);