try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="806b87b7-73b7-42f1-b1d8-626fb169b0b0",e._sentryDebugIdIdentifier="sentry-dbid-806b87b7-73b7-42f1-b1d8-626fb169b0b0")}catch(e){}exports.id=10772,exports.ids=[10772],exports.modules={10772:(e,t,s)=>{"use strict";s.d(t,{EthereumProvider:()=>tE,OPTIONAL_EVENTS:()=>tp,OPTIONAL_METHODS:()=>th});var i=s(94735),r=s.n(i),n=s(6426),a=s(43089),o=s(66394),c=s(13243),h=s.n(c),l=s(84466),p=s(27924),u=Object.defineProperty,d=Object.defineProperties,f=Object.getOwnPropertyDescriptors,m=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,b=(e,t,s)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,y=(e,t)=>{for(var s in t||(t={}))g.call(t,s)&&b(e,s,t[s]);if(m)for(var s of m(t))v.call(t,s)&&b(e,s,t[s]);return e},P=(e,t)=>d(e,f(t));let w={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};class C{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new i.EventEmitter,this.isAvailable=!1,this.registering=!1,!(0,p.isHttpUrl)(e))throw Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{let t=(0,l.h)(e),s=await (await h()(this.url,P(y({},w),{body:t}))).json();this.onPayload({data:s})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!(0,p.isHttpUrl)(e))throw Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){let e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((e,t)=>{this.events.once("register_error",e=>{this.resetMaxListeners(),t(e)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return t(Error("HTTP connection is missing or invalid"));e()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){let t=(0,l.h)({id:1,jsonrpc:"2.0",method:"test",params:[]});await h()(e,P(y({},w),{body:t}))}this.onOpen()}catch(t){let e=this.parseError(t);throw this.events.emit("register_error",e),this.onClose(),e}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;let t="string"==typeof e.data?(0,l.j)(e.data):e.data;this.events.emit("payload",t)}onError(e,t){let s=this.parseError(t),i=s.message||s.toString(),r=(0,p.formatJsonRpcError)(e,i);this.events.emit("payload",r)}parseError(e,t=this.url){return(0,p.parseConnectionError)(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}}var I=s(88015);let O="error",E="wc@2:universal_provider:",j="https://rpc.walletconnect.org/v1/",A="generic",S=`${j}bundler`,$={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function H(){}function T(e){return null==e||"object"!=typeof e&&"function"!=typeof e}function _(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function q(e){return"object"==typeof e&&null!==e}function D(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function N(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}let R="[object String]",x="[object Number]",M="[object Boolean]",U="[object Arguments]";function L(e,t,s,i=new Map,r){let n=r?.(e,t,s,i);if(null!=n)return n;if(T(e))return e;if(i.has(e))return i.get(e);if(Array.isArray(e)){let t=Array(e.length);i.set(e,t);for(let n=0;n<e.length;n++)t[n]=L(e[n],n,s,i,r);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){let t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){let t=new Map;for(let[n,a]of(i.set(e,t),e))t.set(n,L(a,n,s,i,r));return t}if(e instanceof Set){let t=new Set;for(let n of(i.set(e,t),e))t.add(L(n,void 0,s,i,r));return t}if("u">typeof Buffer&&Buffer.isBuffer(e))return e.subarray();if(_(e)){let t=new(Object.getPrototypeOf(e)).constructor(e.length);i.set(e,t);for(let n=0;n<e.length;n++)t[n]=L(e[n],n,s,i,r);return t}if(e instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){let t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return i.set(e,t),k(t,e,s,i,r),t}if("u">typeof File&&e instanceof File){let t=new File([e],e.name,{type:e.type});return i.set(e,t),k(t,e,s,i,r),t}if(e instanceof Blob){let t=new Blob([e],{type:e.type});return i.set(e,t),k(t,e,s,i,r),t}if(e instanceof Error){let t=new e.constructor;return i.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,k(t,e,s,i,r),t}if("object"==typeof e&&function(e){switch(N(e)){case U:case"[object Array]":case"[object ArrayBuffer]":case"[object DataView]":case M:case"[object Date]":case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Map]":case x:case"[object Object]":case"[object RegExp]":case"[object Set]":case R:case"[object Symbol]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return!0;default:return!1}}(e)){let t=Object.create(Object.getPrototypeOf(e));return i.set(e,t),k(t,e,s,i,r),t}return e}function k(e,t,s=e,i,r){let n=[...Object.keys(t),...D(t)];for(let a=0;a<n.length;a++){let o=n[a],c=Object.getOwnPropertyDescriptor(e,o);(null==c||c.writable)&&(e[o]=L(t[o],o,s,i,r))}}function B(e){return L(e,void 0,e,new Map,(t,s,i,r)=>{let n=void 0;if(null!=n)return n;if("object"==typeof e)switch(Object.prototype.toString.call(e)){case x:case R:case M:{let t=new e.constructor(e?.valueOf());return k(t,e),t}case U:{let t={};return k(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}})}function F(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===N(e)}var z=Object.defineProperty,G=Object.defineProperties,J=Object.getOwnPropertyDescriptors,V=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable,K=(e,t,s)=>t in e?z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Y=(e,t)=>{for(var s in t||(t={}))W.call(t,s)&&K(e,s,t[s]);if(V)for(var s of V(t))Q.call(t,s)&&K(e,s,t[s]);return e},Z=(e,t)=>G(e,J(t));function X(e,t,s){var i;let r=(0,n._Yb)(e);return(null==(i=t.rpcMap)?void 0:i[r.reference])||`${j}?chainId=${r.namespace}:${r.reference}&projectId=${s}`}function ee(e){return e.includes(":")?e.split(":")[1]:e}function et(e){return e.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function es(e={},t={}){return function(e,...t){return function(e,...t){let s=t.slice(0,-1),i=t[t.length-1],r=e;for(let e=0;e<s.length;e++)r=function e(t,s,i,r){if(T(t)&&(t=Object(t)),null==s||"object"!=typeof s)return t;if(r.has(s))return function(e){if(T(e))return e;if(Array.isArray(e)||_(e)||e instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);let t=Object.getPrototypeOf(e),s=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new s(e);if(e instanceof RegExp){let t=new s(e);return t.lastIndex=e.lastIndex,t}if(e instanceof DataView)return new s(e.buffer.slice(0));if(e instanceof Error){let t=new s(e.message);return t.stack=e.stack,t.name=e.name,t.cause=e.cause,t}return"u">typeof File&&e instanceof File?new s([e],e.name,{type:e.type,lastModified:e.lastModified}):"object"==typeof e?Object.assign(Object.create(t),e):e}(r.get(s));if(r.set(s,t),Array.isArray(s)){s=s.slice();for(let e=0;e<s.length;e++)s[e]=s[e]??void 0}let n=[...Object.keys(s),...D(s)];for(let a=0;a<n.length;a++){let o=n[a],c=s[o],h=t[o];if(F(c)&&(c={...c}),F(h)&&(h={...h}),"u">typeof Buffer&&Buffer.isBuffer(c)&&(c=B(c)),Array.isArray(c)){if("object"==typeof h&&null!=h){let e=[],t=Reflect.ownKeys(h);for(let s=0;s<t.length;s++){let i=t[s];e[i]=h[i]}h=e}else h=[]}let l=i(h,c,o,t,s,r);null!=l?t[o]=l:Array.isArray(c)||q(h)&&q(c)?t[o]=e(h,c,i,r):null==h&&function(e){if("object"!=typeof e||null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){let t=e[Symbol.toStringTag];return!!(null!=t&&Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable)&&e.toString()===`[object ${t}]`}let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(c)?t[o]=e({},c,i,r):null==h&&_(c)?t[o]=B(c):(void 0===h||void 0!==c)&&(t[o]=c)}return t}(r,s[e],i,new Map);return r}(e,...t,H)}(ei(e),ei(t))}function ei(e){var t,s,i,r;let a={};if(!(0,n.aF0)(e))return a;for(let[o,c]of Object.entries(e)){let e=(0,n.nWe)(o)?[o]:c.chains,h=c.methods||[],l=c.events||[],p=c.rpcMap||{},u=(0,n.kob)(o);a[u]=Z(Y(Y({},a[u]),c),{chains:(0,n.TRk)(e,null==(t=a[u])?void 0:t.chains),methods:(0,n.TRk)(h,null==(s=a[u])?void 0:s.methods),events:(0,n.TRk)(l,null==(i=a[u])?void 0:i.events),rpcMap:Y(Y({},p),null==(r=a[u])?void 0:r.rpcMap)})}return a}function er(e){return e.includes(":")?e.split(":")[2]:e}function en(e){let t={};for(let[s,i]of Object.entries(e)){let e=i.methods||[],r=i.events||[],a=i.accounts||[],o=(0,n.nWe)(s)?[s]:i.chains?i.chains:et(i.accounts);t[s]={chains:o,methods:e,events:r,accounts:a}}return t}function ea(e){return"number"==typeof e?e:e.includes("0x")?parseInt(e,16):isNaN(Number(e=e.includes(":")?e.split(":")[1]:e))?e:Number(e)}let eo={},ec=e=>eo[e],eh=(e,t)=>{eo[e]=t};var el=Object.defineProperty,ep=(e,t,s)=>t in e?el(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,eu=(e,t,s)=>ep(e,"symbol"!=typeof t?t+"":t,s);class ed{constructor(e){eu(this,"name","polkadot"),eu(this,"client"),eu(this,"httpProviders"),eu(this,"events"),eu(this,"namespace"),eu(this,"chainId"),this.namespace=e.namespace,this.events=ec("events"),this.client=ec("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var s;let i=ee(t);e[i]=this.createHttpProvider(i,null==(s=this.namespace.rpcMap)?void 0:s[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){let s=t||X(e,this.namespace,this.client.core.projectId);if(!s)throw Error(`No RPC url provided for chainId: ${e}`);return new I.F(new C(s,ec("disableProviderPing")))}}var ef=Object.defineProperty,em=Object.defineProperties,eg=Object.getOwnPropertyDescriptors,ev=Object.getOwnPropertySymbols,eb=Object.prototype.hasOwnProperty,ey=Object.prototype.propertyIsEnumerable,eP=(e,t,s)=>t in e?ef(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ew=(e,t)=>{for(var s in t||(t={}))eb.call(t,s)&&eP(e,s,t[s]);if(ev)for(var s of ev(t))ey.call(t,s)&&eP(e,s,t[s]);return e},eC=(e,t)=>em(e,eg(t)),eI=(e,t,s)=>eP(e,"symbol"!=typeof t?t+"":t,s);class eO{constructor(e){eI(this,"name","eip155"),eI(this,"client"),eI(this,"chainId"),eI(this,"namespace"),eI(this,"httpProviders"),eI(this,"events"),this.namespace=e.namespace,this.events=ec("events"),this.client=ec("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){let s=t||X(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw Error(`No RPC url provided for chainId: ${e}`);return new I.F(new C(s,ec("disableProviderPing")))}setHttpProvider(e,t){let s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var s;let i=parseInt(ee(t));e[i]=this.createHttpProvider(i,null==(s=this.namespace.rpcMap)?void 0:s[t])}),e}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(){let e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let i=e.request.params?null==(t=e.request.params[0])?void 0:t.chainId:"0x0",r=parseInt(i=i.startsWith("0x")?i:`0x${i}`,16);if(this.isChainApproved(r))this.setDefaultChain(`${r}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:i}]},chainId:null==(s=this.namespace.chains)?void 0:s[0]}),this.setDefaultChain(`${r}`);else throw Error(`Failed to switch to chain 'eip155:${r}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,s,i;let r=null==(s=null==(t=e.request)?void 0:t.params)?void 0:s[0];if(!r)throw Error("Missing address parameter in `wallet_getCapabilities` request");let n=this.client.session.get(e.topic),a=(null==(i=n?.sessionProperties)?void 0:i.capabilities)||{};if(null!=a&&a[r])return a?.[r];let o=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:eC(ew({},n.sessionProperties||{}),{capabilities:eC(ew({},a||{}),{[r]:o})})})}catch(e){console.warn("Failed to update session with capabilities",e)}return o}async getCallStatus(e){var t,s;let i=this.client.session.get(e.topic),r=null==(t=i.sessionProperties)?void 0:t.bundler_name;if(r){let t=this.getBundlerUrl(e.chainId,r);try{return await this.getUserOperationReceipt(t,e)}catch(e){console.warn("Failed to fetch call status from bundler",e,t)}}let n=null==(s=i.sessionProperties)?void 0:s.bundler_url;if(n)try{return await this.getUserOperationReceipt(n,e)}catch(e){console.warn("Failed to fetch call status from custom bundler",e,n)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var s;let i=new URL(e),r=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,p.formatJsonRpcRequest)("eth_getUserOperationReceipt",[null==(s=t.request.params)?void 0:s[0]]))});if(!r.ok)throw Error(`Failed to fetch user operation receipt - ${r.status}`);return await r.json()}getBundlerUrl(e,t){return`${S}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var eE=Object.defineProperty,ej=(e,t,s)=>t in e?eE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,eA=(e,t,s)=>ej(e,"symbol"!=typeof t?t+"":t,s);class eS{constructor(e){eA(this,"name","solana"),eA(this,"client"),eA(this,"httpProviders"),eA(this,"events"),eA(this,"namespace"),eA(this,"chainId"),this.namespace=e.namespace,this.events=ec("events"),this.client=ec("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var s;let i=ee(t);e[i]=this.createHttpProvider(i,null==(s=this.namespace.rpcMap)?void 0:s[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){let s=t||X(e,this.namespace,this.client.core.projectId);if(!s)throw Error(`No RPC url provided for chainId: ${e}`);return new I.F(new C(s,ec("disableProviderPing")))}}var e$=Object.defineProperty,eH=(e,t,s)=>t in e?e$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,eT=(e,t,s)=>eH(e,"symbol"!=typeof t?t+"":t,s);class e_{constructor(e){eT(this,"name","cosmos"),eT(this,"client"),eT(this,"httpProviders"),eT(this,"events"),eT(this,"namespace"),eT(this,"chainId"),this.namespace=e.namespace,this.events=ec("events"),this.client=ec("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var s;let i=ee(t);e[i]=this.createHttpProvider(i,null==(s=this.namespace.rpcMap)?void 0:s[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){let s=t||X(e,this.namespace,this.client.core.projectId);if(!s)throw Error(`No RPC url provided for chainId: ${e}`);return new I.F(new C(s,ec("disableProviderPing")))}}var eq=Object.defineProperty,eD=(e,t,s)=>t in e?eq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,eN=(e,t,s)=>eD(e,"symbol"!=typeof t?t+"":t,s);class eR{constructor(e){eN(this,"name","algorand"),eN(this,"client"),eN(this,"httpProviders"),eN(this,"events"),eN(this,"namespace"),eN(this,"chainId"),this.namespace=e.namespace,this.events=ec("events"),this.client=ec("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){let s=t||X(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,null==(s=this.namespace.rpcMap)?void 0:s[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){let s=t||X(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new I.F(new C(s,ec("disableProviderPing")))}}var ex=Object.defineProperty,eM=(e,t,s)=>t in e?ex(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,eU=(e,t,s)=>eM(e,"symbol"!=typeof t?t+"":t,s);class eL{constructor(e){eU(this,"name","cip34"),eU(this,"client"),eU(this,"httpProviders"),eU(this,"events"),eU(this,"namespace"),eU(this,"chainId"),this.namespace=e.namespace,this.events=ec("events"),this.client=ec("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{let s=this.getCardanoRPCUrl(t),i=ee(t);e[i]=this.createHttpProvider(i,s)}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){let t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){let s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){let s=t||this.getCardanoRPCUrl(e);if(!s)throw Error(`No RPC url provided for chainId: ${e}`);return new I.F(new C(s,ec("disableProviderPing")))}}var ek=Object.defineProperty,eB=(e,t,s)=>t in e?ek(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,eF=(e,t,s)=>eB(e,"symbol"!=typeof t?t+"":t,s);class ez{constructor(e){eF(this,"name","elrond"),eF(this,"client"),eF(this,"httpProviders"),eF(this,"events"),eF(this,"namespace"),eF(this,"chainId"),this.namespace=e.namespace,this.events=ec("events"),this.client=ec("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var s;let i=ee(t);e[i]=this.createHttpProvider(i,null==(s=this.namespace.rpcMap)?void 0:s[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){let s=t||X(e,this.namespace,this.client.core.projectId);if(!s)throw Error(`No RPC url provided for chainId: ${e}`);return new I.F(new C(s,ec("disableProviderPing")))}}var eG=Object.defineProperty,eJ=(e,t,s)=>t in e?eG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,eV=(e,t,s)=>eJ(e,"symbol"!=typeof t?t+"":t,s);class eW{constructor(e){eV(this,"name","multiversx"),eV(this,"client"),eV(this,"httpProviders"),eV(this,"events"),eV(this,"namespace"),eV(this,"chainId"),this.namespace=e.namespace,this.events=ec("events"),this.client=ec("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var s;let i=ee(t);e[i]=this.createHttpProvider(i,null==(s=this.namespace.rpcMap)?void 0:s[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){let s=t||X(e,this.namespace,this.client.core.projectId);if(!s)throw Error(`No RPC url provided for chainId: ${e}`);return new I.F(new C(s,ec("disableProviderPing")))}}var eQ=Object.defineProperty,eK=(e,t,s)=>t in e?eQ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,eY=(e,t,s)=>eK(e,"symbol"!=typeof t?t+"":t,s);class eZ{constructor(e){eY(this,"name","near"),eY(this,"client"),eY(this,"httpProviders"),eY(this,"events"),eY(this,"namespace"),eY(this,"chainId"),this.namespace=e.namespace,this.events=ec("events"),this.client=ec("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){let s=t||X(`${this.name}:${e}`,this.namespace);if(!s)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,null==(s=this.namespace.rpcMap)?void 0:s[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){let s=t||X(e,this.namespace);return typeof s>"u"?void 0:new I.F(new C(s,ec("disableProviderPing")))}}var eX=Object.defineProperty,e0=(e,t,s)=>t in e?eX(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,e1=(e,t,s)=>e0(e,"symbol"!=typeof t?t+"":t,s);class e2{constructor(e){e1(this,"name","tezos"),e1(this,"client"),e1(this,"httpProviders"),e1(this,"events"),e1(this,"namespace"),e1(this,"chainId"),this.namespace=e.namespace,this.events=ec("events"),this.client=ec("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){let s=t||X(`${this.name}:${e}`,this.namespace);if(!s)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){let s=t||X(e,this.namespace);return typeof s>"u"?void 0:new I.F(new C(s))}}var e3=Object.defineProperty,e8=(e,t,s)=>t in e?e3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,e7=(e,t,s)=>e8(e,"symbol"!=typeof t?t+"":t,s);class e6{constructor(e){e7(this,"name",A),e7(this,"client"),e7(this,"httpProviders"),e7(this,"events"),e7(this,"namespace"),e7(this,"chainId"),this.namespace=e.namespace,this.events=ec("events"),this.client=ec("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit($.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){var e,t;let s={};return null==(t=null==(e=this.namespace)?void 0:e.accounts)||t.forEach(e=>{let t=(0,n._Yb)(e);s[`${t.namespace}:${t.reference}`]=this.createHttpProvider(e)}),s}getHttpProvider(e){let t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){let s=t||X(e,this.namespace,this.client.core.projectId);if(!s)throw Error(`No RPC url provided for chainId: ${e}`);return new I.F(new C(s,ec("disableProviderPing")))}}var e4=Object.defineProperty,e5=Object.defineProperties,e9=Object.getOwnPropertyDescriptors,te=Object.getOwnPropertySymbols,tt=Object.prototype.hasOwnProperty,ts=Object.prototype.propertyIsEnumerable,ti=(e,t,s)=>t in e?e4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,tr=(e,t)=>{for(var s in t||(t={}))tt.call(t,s)&&ti(e,s,t[s]);if(te)for(var s of te(t))ts.call(t,s)&&ti(e,s,t[s]);return e},tn=(e,t)=>e5(e,e9(t)),ta=(e,t,s)=>ti(e,"symbol"!=typeof t?t+"":t,s);class to{constructor(e){ta(this,"client"),ta(this,"namespaces"),ta(this,"optionalNamespaces"),ta(this,"sessionProperties"),ta(this,"scopedProperties"),ta(this,"events",new(r())),ta(this,"rpcProviders",{}),ta(this,"session"),ta(this,"providerOpts"),ta(this,"logger"),ta(this,"uri"),ta(this,"disableProviderPing",!1),this.providerOpts=e,this.logger="u">typeof e?.logger&&"string"!=typeof e?.logger?e.logger:(0,o.h6)((0,o.iP)({level:e?.logger||O})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){let t=new to(e);return await t.initialize(),t}async request(e,t,s){let[i,r]=this.validateChain(t);if(!this.session)throw Error("Please call connect() before request()");return await this.getProvider(i).request({request:tr({},e),chainId:`${i}:${r}`,topic:this.session.topic,expiry:s})}sendAsync(e,t,s,i){let r=new Date().getTime();this.request(e,s,i).then(e=>t(null,(0,p.formatJsonRpcResult)(r,e))).catch(e=>t(e,void 0))}async enable(){if(!this.client)throw Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(e=this.session)?void 0:e.topic,reason:(0,n.Hjj)("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();let{uri:s,response:i}=await this.client.authenticate(e,t);s&&(this.uri=s,this.events.emit("display_uri",s));let r=await i();if(this.session=r.session,this.session){let e=en(this.session.namespaces);this.namespaces=es(this.namespaces,e),await this.persist("namespaces",this.namespaces),this.onConnect()}return r}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){let{uri:t,approval:s}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));let i=await s();this.session=i;let r=en(i.namespaces);return this.namespaces=es(this.namespaces,r),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;let[s,i]=this.validateChain(e),r=this.getProvider(s);r.name===A?r.setDefaultChain(`${s}:${i}`,t):r.setDefaultChain(i,t)}catch(e){if(!/Please call connect/.test(e.message))throw e}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");let t=this.client.pairing.getAll();if((0,n.OP1)(t)){for(let s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await a.Ay.init({core:this.providerOpts.core,logger:this.providerOpts.logger||O,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(s){throw this.logger.error("Failed to get session",s),Error(`The provided session: ${null==(t=null==(e=this.providerOpts)?void 0:e.session)?void 0:t.topic} doesn't exist in the Sign client`)}else{let e=this.client.session.getAll();this.session=e[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw Error("Sign Client not initialized");if(!this.session)throw Error("Session not initialized. Please call connect() before enable()");let e=[...new Set(Object.keys(this.session.namespaces).map(e=>(0,n.kob)(e)))];eh("client",this.client),eh("events",this.events),eh("disableProviderPing",this.disableProviderPing),e.forEach(e=>{if(!this.session)return;let t=function(e,t){let s=Object.keys(t.namespaces).filter(t=>t.includes(e));if(!s.length)return[];let i=[];return s.forEach(e=>{let s=t.namespaces[e].accounts;i.push(...s)}),i}(e,this.session),s=et(t),i=tn(tr({},es(this.namespaces,this.optionalNamespaces)[e]),{accounts:t,chains:s});switch(e){case"eip155":this.rpcProviders[e]=new eO({namespace:i});break;case"algorand":this.rpcProviders[e]=new eR({namespace:i});break;case"solana":this.rpcProviders[e]=new eS({namespace:i});break;case"cosmos":this.rpcProviders[e]=new e_({namespace:i});break;case"polkadot":this.rpcProviders[e]=new ed({namespace:i});break;case"cip34":this.rpcProviders[e]=new eL({namespace:i});break;case"elrond":this.rpcProviders[e]=new ez({namespace:i});break;case"multiversx":this.rpcProviders[e]=new eW({namespace:i});break;case"near":this.rpcProviders[e]=new eZ({namespace:i});break;case"tezos":this.rpcProviders[e]=new e2({namespace:i});break;default:this.rpcProviders[A]?this.rpcProviders[A].updateNamespace(i):this.rpcProviders[A]=new e6({namespace:i})}})}registerEventListeners(){if(typeof this.client>"u")throw Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;let{topic:s}=e;s===(null==(t=this.session)?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;let{params:s,topic:i}=e;if(i!==(null==(t=this.session)?void 0:t.topic))return;let{event:r}=s;if("accountsChanged"===r.name){let e=r.data;e&&(0,n.OP1)(e)&&this.events.emit("accountsChanged",e.map(er))}else if("chainChanged"===r.name){let e=s.chainId,t=s.event.data,i=(0,n.kob)(e),r=ea(e)!==ea(t)?`${i}:${ea(t)}`:e;this.onChainChanged(r)}else this.events.emit(r.name,r.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s,i;if(e!==(null==(s=this.session)?void 0:s.topic))return;let{namespaces:r}=t,n=null==(i=this.client)?void 0:i.session.get(e);this.session=tn(tr({},n),{namespaces:r}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===(null==(t=this.session)?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",tn(tr({},(0,n.Hjj)("USER_DISCONNECTED")),{data:e.topic})))}),this.on($.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[A]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace(null==(t=this.session)?void 0:t.namespaces[e])})}setNamespaces(e){let{namespaces:t,optionalNamespaces:s,sessionProperties:i,scopedProperties:r}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=i,this.scopedProperties=r}validateChain(e){let[t,s]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(e=>(0,n.kob)(e)).includes(t))throw Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];let i=(0,n.kob)(Object.keys(this.namespaces)[0]),r=this.rpcProviders[i].getDefaultChain();return[i,r]}async requestAccounts(){let[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;let[s,i]=this.validateChain(e);i&&(t||this.getProvider(s).setDefaultChain(i),this.namespaces[s]?this.namespaces[s].defaultChain=i:this.namespaces[`${s}:${i}`]?this.namespaces[`${s}:${i}`].defaultChain=i:this.namespaces[`${s}:${i}`]={defaultChain:i},this.events.emit("chainChanged",i),await this.persist("namespaces",this.namespaces))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var s;let i=(null==(s=this.session)?void 0:s.topic)||"";await this.client.core.storage.setItem(`${E}/${e}${i}`,t)}async getFromStore(e){var t;let s=(null==(t=this.session)?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${E}/${e}${s}`)}async deleteFromStore(e){var t;let s=(null==(t=this.session)?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${E}/${e}${s}`)}async cleanupStorage(){var e;try{if((null==(e=this.client)?void 0:e.session.length)>0)return;for(let e of(await this.client.core.storage.getKeys()))e.startsWith(E)&&await this.client.core.storage.removeItem(e)}catch(e){this.logger.warn("Failed to cleanup storage",e)}}}let tc=["eth_sendTransaction","personal_sign"],th=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],tl=["chainChanged","accountsChanged"],tp=["chainChanged","accountsChanged","message","disconnect","connect"];var tu=Object.defineProperty,td=Object.defineProperties,tf=Object.getOwnPropertyDescriptors,tm=Object.getOwnPropertySymbols,tg=Object.prototype.hasOwnProperty,tv=Object.prototype.propertyIsEnumerable,tb=(e,t,s)=>t in e?tu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ty=(e,t)=>{for(var s in t||(t={}))tg.call(t,s)&&tb(e,s,t[s]);if(tm)for(var s of tm(t))tv.call(t,s)&&tb(e,s,t[s]);return e},tP=(e,t)=>td(e,tf(t)),tw=(e,t,s)=>tb(e,"symbol"!=typeof t?t+"":t,s);function tC(e){return Number(e[0].split(":")[1])}function tI(e){return`0x${e.toString(16)}`}class tO{constructor(){tw(this,"events",new i.EventEmitter),tw(this,"namespace","eip155"),tw(this,"accounts",[]),tw(this,"signer"),tw(this,"chainId",1),tw(this,"modal"),tw(this,"rpc"),tw(this,"STORAGE_KEY","wc@2:ethereum_provider:"),tw(this,"on",(e,t)=>(this.events.on(e,t),this)),tw(this,"once",(e,t)=>(this.events.once(e,t),this)),tw(this,"removeListener",(e,t)=>(this.events.removeListener(e,t),this)),tw(this,"off",(e,t)=>(this.events.off(e,t),this)),tw(this,"parseAccount",e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e),this.signer={},this.rpc={}}static async init(e){let t=new tO;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,s){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),s)}get connected(){return!!this.signer.client&&this.signer.client.core.relayer.connected}get connecting(){return!!this.signer.client&&this.signer.client.core.relayer.connecting}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);let{required:t,optional:s}=function(e){let{chains:t,optionalChains:s,methods:i,optionalMethods:r,events:a,optionalEvents:o,rpcMap:c}=e;if(!(0,n.OP1)(t))throw Error("Invalid chains");let h={chains:t,methods:i||tc,events:a||tl,rpcMap:ty({},t.length?{[tC(t)]:c[tC(t)]}:{})},l=a?.filter(e=>!tl.includes(e)),p=i?.filter(e=>!tc.includes(e));if(!s&&!o&&!r&&!(null!=l&&l.length)&&!(null!=p&&p.length))return{required:t.length?h:void 0};let u={chains:[...new Set(l?.length&&p?.length||!s?h.chains.concat(s||[]):s)],methods:[...new Set(h.methods.concat(null!=r&&r.length?r:th))],events:[...new Set(h.events.concat(null!=o&&o.length?o:tp))],rpcMap:c};return{required:t.length?h:void 0,optional:s.length?u:void 0}}(this.rpc);try{let i=await new Promise(async(i,r)=>{var n;this.rpc.showQrModal&&(null==(n=this.modal)||n.subscribeModal(e=>{e.open||this.signer.session||(this.signer.abortPairingAttempt(),r(Error("Connection request reset. Please try again.")))}));let a=null!=e&&e.scopedProperties?{[this.namespace]:e.scopedProperties}:void 0;await this.signer.connect(tP(ty({namespaces:ty({},t&&{[this.namespace]:t})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e?.pairingTopic,scopedProperties:a})).then(e=>{i(e)}).catch(e=>{r(Error(e.message))})});if(!i)return;let r=(0,n.Zz7)(i.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:r),this.setAccounts(r),this.events.emit("connect",{chainId:tI(this.chainId)})}catch(e){throw this.signer.logger.error(e),e}finally{this.modal&&this.modal.closeModal()}}async authenticate(e,t){if(!this.signer.client)throw Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:e?.chains});try{let s=await new Promise(async(s,i)=>{var r;this.rpc.showQrModal&&(null==(r=this.modal)||r.subscribeModal(e=>{e.open||this.signer.session||(this.signer.abortPairingAttempt(),i(Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(tP(ty({},e),{chains:this.rpc.chains}),t).then(e=>{s(e)}).catch(e=>{i(Error(e.message))})}),i=s.session;if(i){let e=(0,n.Zz7)(i.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:e),this.setAccounts(e),this.events.emit("connect",{chainId:tI(this.chainId)})}return s}catch(e){throw this.signer.logger.error(e),e}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{let{params:t}=e,{event:s}=t;"accountsChanged"===s.name?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):"chainChanged"===s.name?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{let t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",tI(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",tP(ty({},(0,n.Hjj)("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,s;this.rpc.showQrModal&&(null==(t=this.modal)||t.closeModal(),null==(s=this.modal)||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return"string"==typeof e&&e.startsWith(`${this.namespace}:`)}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){let t=e.filter(e=>this.isCompatibleChainId(e)).map(e=>this.parseChainId(e));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",tI(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){let t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){let[t,s,i]=e.split(":");return{chainId:`${t}:${s}`,address:i}}setAccounts(e){this.accounts=e.filter(e=>this.parseChainId(this.parseAccountId(e).chainId)===this.chainId).map(e=>this.parseAccountId(e).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;let i=null!=(t=e?.chains)?t:[],r=null!=(s=e?.optionalChains)?s:[],n=i.concat(r);if(!n.length)throw Error("No chains specified in either `chains` or `optionalChains`");let a=i.length?e?.methods||tc:[],o=i.length?e?.events||tl:[],c=e?.optionalMethods||[],h=e?.optionalEvents||[],l=e?.rpcMap||this.buildRpcMap(n,e.projectId),p=e?.qrModalOptions||void 0;return{chains:i?.map(e=>this.formatChainId(e)),optionalChains:r.map(e=>this.formatChainId(e)),methods:a,events:o,optionalMethods:c,optionalEvents:h,rpcMap:l,showQrModal:!!(null!=e&&e.showQrModal),qrModalOptions:p,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){let s={};return e.forEach(e=>{s[e]=this.getRpcUrl(e,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?tC(this.rpc.chains):tC(this.rpc.optionalChains),this.signer=await to.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storage:e.storage,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled,logger:e.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let e;try{let{WalletConnectModal:t}=await s.e(34305).then(s.bind(s,34305));e=t}catch{throw Error("To use QR modal, please install @walletconnect/modal package")}if(e)try{this.modal=new e(ty({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(e){throw this.signer.logger.error(e),Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;let{chains:t,optionalChains:s,rpcMap:i}=e;t&&(0,n.OP1)(t)&&(this.rpc.chains=t.map(e=>this.formatChainId(e)),t.forEach(e=>{this.rpc.rpcMap[e]=i?.[e]||this.getRpcUrl(e)})),s&&(0,n.OP1)(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s?.map(e=>this.formatChainId(e)),s.forEach(e=>{this.rpc.rpcMap[e]=i?.[e]||this.getRpcUrl(e)}))}getRpcUrl(e,t){var s;return(null==(s=this.rpc.rpcMap)?void 0:s[e])||`https://rpc.walletconnect.org/v1/?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{let e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t?.accounts),this.setAccounts(t?.accounts)}catch(e){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(e),await this.disconnect().catch(e=>this.signer.logger.warn(e))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return"string"==typeof e||e instanceof String?[this.parseAccount(e)]:e.map(e=>this.parseAccount(e))}}let tE=tO},13243:(e,t,s)=>{let i=s(19883),r=i.default||i,n=function(e,t){return/^\/\//.test(e)&&(e="https:"+e),r.call(this,e,t)};n.ponyfill=!0,e.exports=t=n,t.fetch=n,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,t.default=n},19883:(e,t,s)=>{"use strict";let i;s.r(t),s.d(t,{AbortError:()=>J,FetchError:()=>f,Headers:()=>H,Request:()=>G,Response:()=>x,default:()=>Z});var r=s(27910),n=s(81630),a=s(79551),o=s(98163),c=s(55591),h=s(74075);let l=r.Readable,p=Symbol("buffer"),u=Symbol("type");class d{constructor(){this[u]="";let e=arguments[0],t=arguments[1],s=[];if(e){let t=Number(e.length);for(let i=0;i<t;i++){let t;let r=e[i];(t=r instanceof Buffer?r:ArrayBuffer.isView(r)?Buffer.from(r.buffer,r.byteOffset,r.byteLength):r instanceof ArrayBuffer?Buffer.from(r):r instanceof d?r[p]:Buffer.from("string"==typeof r?r:String(r))).length,s.push(t)}}this[p]=Buffer.concat(s);let i=t&&void 0!==t.type&&String(t.type).toLowerCase();i&&!/[^\u0020-\u007E]/.test(i)&&(this[u]=i)}get size(){return this[p].length}get type(){return this[u]}text(){return Promise.resolve(this[p].toString())}arrayBuffer(){let e=this[p];return Promise.resolve(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength))}stream(){let e=new l;return e._read=function(){},e.push(this[p]),e.push(null),e}toString(){return"[object Blob]"}slice(){let e,t;let s=this.size,i=arguments[0],r=arguments[1];e=void 0===i?0:i<0?Math.max(s+i,0):Math.min(i,s);let n=Math.max((void 0===r?s:r<0?Math.max(s+r,0):Math.min(r,s))-e,0),a=this[p].slice(e,e+n),o=new d([],{type:arguments[2]});return o[p]=a,o}}function f(e,t,s){Error.call(this,e),this.message=e,this.type=t,s&&(this.code=this.errno=s.code),Error.captureStackTrace(this,this.constructor)}Object.defineProperties(d.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(d.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),f.prototype=Object.create(Error.prototype),f.prototype.constructor=f,f.prototype.name="FetchError";try{i=require("encoding").convert}catch(e){}let m=Symbol("Body internals"),g=r.PassThrough;function v(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=s.size,n=s.timeout;null==e?e=null:y(e)?e=Buffer.from(e.toString()):P(e)||Buffer.isBuffer(e)||("[object ArrayBuffer]"===Object.prototype.toString.call(e)?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof r||(e=Buffer.from(String(e)))),this[m]={body:e,disturbed:!1,error:null},this.size=void 0===i?0:i,this.timeout=void 0===n?0:n,e instanceof r&&e.on("error",function(e){let s="AbortError"===e.name?e:new f(`Invalid response body while trying to fetch ${t.url}: ${e.message}`,"system",e);t[m].error=s})}function b(){var e=this;if(this[m].disturbed)return v.Promise.reject(TypeError(`body used already for: ${this.url}`));if(this[m].disturbed=!0,this[m].error)return v.Promise.reject(this[m].error);let t=this.body;if(null===t)return v.Promise.resolve(Buffer.alloc(0));if(P(t)&&(t=t.stream()),Buffer.isBuffer(t))return v.Promise.resolve(t);if(!(t instanceof r))return v.Promise.resolve(Buffer.alloc(0));let s=[],i=0,n=!1;return new v.Promise(function(r,a){let o;e.timeout&&(o=setTimeout(function(){n=!0,a(new f(`Response timeout while trying to fetch ${e.url} (over ${e.timeout}ms)`,"body-timeout"))},e.timeout)),t.on("error",function(t){"AbortError"===t.name?(n=!0,a(t)):a(new f(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t))}),t.on("data",function(t){if(!n&&null!==t){if(e.size&&i+t.length>e.size){n=!0,a(new f(`content size at ${e.url} over limit: ${e.size}`,"max-size"));return}i+=t.length,s.push(t)}}),t.on("end",function(){if(!n){clearTimeout(o);try{r(Buffer.concat(s,i))}catch(t){a(new f(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t))}}})})}function y(e){return"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&("URLSearchParams"===e.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(e)||"function"==typeof e.sort)}function P(e){return"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}function w(e){let t,s;let i=e.body;if(e.bodyUsed)throw Error("cannot clone body after it is used");return i instanceof r&&"function"!=typeof i.getBoundary&&(t=new g,s=new g,i.pipe(t),i.pipe(s),e[m].body=t,i=s),i}function C(e){if(null===e)return null;if("string"==typeof e)return"text/plain;charset=UTF-8";if(y(e))return"application/x-www-form-urlencoded;charset=UTF-8";if(P(e))return e.type||null;if(Buffer.isBuffer(e))return null;else if("[object ArrayBuffer]"===Object.prototype.toString.call(e))return null;else if(ArrayBuffer.isView(e))return null;else if("function"==typeof e.getBoundary)return`multipart/form-data;boundary=${e.getBoundary()}`;else if(e instanceof r)return null;else return"text/plain;charset=UTF-8"}function I(e){let t=e.body;return null===t?0:P(t)?t.size:Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync?t._lengthRetrievers&&0==t._lengthRetrievers.length||t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null:null}v.prototype={get body(){return this[m].body},get bodyUsed(){return this[m].disturbed},arrayBuffer(){return b.call(this).then(function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)})},blob(){let e=this.headers&&this.headers.get("content-type")||"";return b.call(this).then(function(t){return Object.assign(new d([],{type:e.toLowerCase()}),{[p]:t})})},json(){var e=this;return b.call(this).then(function(t){try{return JSON.parse(t.toString())}catch(t){return v.Promise.reject(new f(`invalid json response body at ${e.url} reason: ${t.message}`,"invalid-json"))}})},text(){return b.call(this).then(function(e){return e.toString()})},buffer(){return b.call(this)},textConverted(){var e=this;return b.call(this).then(function(t){return function(e,t){let s,r;if("function"!=typeof i)throw Error("The package `encoding` must be installed to use the textConverted() function");let n=t.get("content-type"),a="utf-8";return n&&(s=/charset=([^;]*)/i.exec(n)),r=e.slice(0,1024).toString(),!s&&r&&(s=/<meta.+?charset=(['"])(.+?)\1/i.exec(r)),!s&&r&&(!(s=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(r))&&(s=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(r))&&s.pop(),s&&(s=/charset=(.*)/i.exec(s.pop()))),!s&&r&&(s=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(r)),s&&("gb2312"===(a=s.pop())||"gbk"===a)&&(a="gb18030"),i(e,"UTF-8",a).toString()}(t,e.headers)})}},Object.defineProperties(v.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),v.mixIn=function(e){for(let t of Object.getOwnPropertyNames(v.prototype))if(!(t in e)){let s=Object.getOwnPropertyDescriptor(v.prototype,t);Object.defineProperty(e,t,s)}},v.Promise=global.Promise;let O=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,E=/[^\t\x20-\x7e\x80-\xff]/;function j(e){if(e=`${e}`,O.test(e)||""===e)throw TypeError(`${e} is not a legal HTTP header name`)}function A(e){if(e=`${e}`,E.test(e))throw TypeError(`${e} is not a legal HTTP header value`)}function S(e,t){for(let s in t=t.toLowerCase(),e)if(s.toLowerCase()===t)return s}let $=Symbol("map");class H{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[$]=Object.create(null),e instanceof H){let t=e.raw();for(let e of Object.keys(t))for(let s of t[e])this.append(e,s);return}if(null==e);else if("object"==typeof e){let t=e[Symbol.iterator];if(null!=t){if("function"!=typeof t)throw TypeError("Header pairs must be iterable");let s=[];for(let t of e){if("object"!=typeof t||"function"!=typeof t[Symbol.iterator])throw TypeError("Each header pair must be iterable");s.push(Array.from(t))}for(let e of s){if(2!==e.length)throw TypeError("Each header pair must be a name/value tuple");this.append(e[0],e[1])}}else for(let t of Object.keys(e)){let s=e[t];this.append(t,s)}}else throw TypeError("Provided initializer must be an object")}get(e){j(e=`${e}`);let t=S(this[$],e);return void 0===t?null:this[$][t].join(", ")}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,s=T(this),i=0;for(;i<s.length;){var r=s[i];let n=r[0],a=r[1];e.call(t,a,n,this),s=T(this),i++}}set(e,t){e=`${e}`,t=`${t}`,j(e),A(t);let s=S(this[$],e);this[$][void 0!==s?s:e]=[t]}append(e,t){e=`${e}`,t=`${t}`,j(e),A(t);let s=S(this[$],e);void 0!==s?this[$][s].push(t):this[$][e]=[t]}has(e){return j(e=`${e}`),void 0!==S(this[$],e)}delete(e){j(e=`${e}`);let t=S(this[$],e);void 0!==t&&delete this[$][t]}raw(){return this[$]}keys(){return q(this,"key")}values(){return q(this,"value")}[Symbol.iterator](){return q(this,"key+value")}}function T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key+value";return Object.keys(e[$]).sort().map("key"===t?function(e){return e.toLowerCase()}:"value"===t?function(t){return e[$][t].join(", ")}:function(t){return[t.toLowerCase(),e[$][t].join(", ")]})}H.prototype.entries=H.prototype[Symbol.iterator],Object.defineProperty(H.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(H.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});let _=Symbol("internal");function q(e,t){let s=Object.create(D);return s[_]={target:e,kind:t,index:0},s}let D=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==D)throw TypeError("Value of `this` is not a HeadersIterator");var e=this[_];let t=e.target,s=e.kind,i=e.index,r=T(t,s);return i>=r.length?{value:void 0,done:!0}:(this[_].index=i+1,{value:r[i],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));Object.defineProperty(D,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});let N=Symbol("Response internals"),R=n.STATUS_CODES;class x{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v.call(this,e,t);let s=t.status||200,i=new H(t.headers);if(null!=e&&!i.has("Content-Type")){let t=C(e);t&&i.append("Content-Type",t)}this[N]={url:t.url,status:s,statusText:t.statusText||R[s],headers:i,counter:t.counter}}get url(){return this[N].url||""}get status(){return this[N].status}get ok(){return this[N].status>=200&&this[N].status<300}get redirected(){return this[N].counter>0}get statusText(){return this[N].statusText}get headers(){return this[N].headers}clone(){return new x(w(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}v.mixIn(x.prototype),Object.defineProperties(x.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(x.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});let M=Symbol("Request internals"),U=a.URL||o.URL,L=a.parse,k=a.format;function B(e){return/^[a-zA-Z][a-zA-Z\d+\-.]*:/.exec(e)&&(e=new U(e).toString()),L(e)}let F="destroy"in r.Readable.prototype;function z(e){return"object"==typeof e&&"object"==typeof e[M]}class G{constructor(e){let t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};z(e)?t=B(e.url):(t=e&&e.href?B(e.href):B(`${e}`),e={});let i=s.method||e.method||"GET";if(i=i.toUpperCase(),(null!=s.body||z(e)&&null!==e.body)&&("GET"===i||"HEAD"===i))throw TypeError("Request with GET/HEAD method cannot have body");let r=null!=s.body?s.body:z(e)&&null!==e.body?w(e):null;v.call(this,r,{timeout:s.timeout||e.timeout||0,size:s.size||e.size||0});let n=new H(s.headers||e.headers||{});if(null!=r&&!n.has("Content-Type")){let e=C(r);e&&n.append("Content-Type",e)}let a=z(e)?e.signal:null;if("signal"in s&&(a=s.signal),null!=a&&!function(e){let t=e&&"object"==typeof e&&Object.getPrototypeOf(e);return!!(t&&"AbortSignal"===t.constructor.name)}(a))throw TypeError("Expected signal to be an instanceof AbortSignal");this[M]={method:i,redirect:s.redirect||e.redirect||"follow",headers:n,parsedURL:t,signal:a},this.follow=void 0!==s.follow?s.follow:void 0!==e.follow?e.follow:20,this.compress=void 0!==s.compress?s.compress:void 0===e.compress||e.compress,this.counter=s.counter||e.counter||0,this.agent=s.agent||e.agent}get method(){return this[M].method}get url(){return k(this[M].parsedURL)}get headers(){return this[M].headers}get redirect(){return this[M].redirect}get signal(){return this[M].signal}clone(){return new G(this)}}function J(e){Error.call(this,e),this.type="aborted",this.message=e,Error.captureStackTrace(this,this.constructor)}v.mixIn(G.prototype),Object.defineProperty(G.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(G.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),J.prototype=Object.create(Error.prototype),J.prototype.constructor=J,J.prototype.name="AbortError";let V=a.URL||o.URL,W=r.PassThrough,Q=function(e,t){let s=new V(t).hostname,i=new V(e).hostname;return s===i||"."===s[s.length-i.length-1]&&s.endsWith(i)};function K(e,t){if(!K.Promise)throw Error("native promise missing, set fetch.Promise to your favorite alternative");return v.Promise=K.Promise,new K.Promise(function(s,i){var a,o;let l,p;let u=new G(e,t),d=function(e){let t=e[M].parsedURL,s=new H(e[M].headers);if(s.has("Accept")||s.set("Accept","*/*"),!t.protocol||!t.hostname)throw TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(t.protocol))throw TypeError("Only HTTP(S) protocols are supported");if(e.signal&&e.body instanceof r.Readable&&!F)throw Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let i=null;if(null==e.body&&/^(POST|PUT)$/i.test(e.method)&&(i="0"),null!=e.body){let t=I(e);"number"==typeof t&&(i=String(t))}i&&s.set("Content-Length",i),s.has("User-Agent")||s.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),e.compress&&!s.has("Accept-Encoding")&&s.set("Accept-Encoding","gzip,deflate");let n=e.agent;return"function"==typeof n&&(n=n(t)),Object.assign({},t,{method:e.method,headers:function(e){let t=Object.assign({__proto__:null},e[$]),s=S(e[$],"Host");return void 0!==s&&(t[s]=t[s][0]),t}(s),agent:n})}(u),m=("https:"===d.protocol?c:n).request,g=u.signal,v=null,b=function(){let e=new J("The user aborted a request.");i(e),u.body&&u.body instanceof r.Readable&&Y(u.body,e),v&&v.body&&v.body.emit("error",e)};if(g&&g.aborted){b();return}let y=function(){b(),C()},w=m(d);function C(){w.abort(),g&&g.removeEventListener("abort",y),clearTimeout(l)}g&&g.addEventListener("abort",y),u.timeout&&w.once("socket",function(e){l=setTimeout(function(){i(new f(`network timeout at: ${u.url}`,"request-timeout")),C()},u.timeout)}),w.on("error",function(e){i(new f(`request to ${u.url} failed, reason: ${e.message}`,"system",e)),v&&v.body&&Y(v.body,e),C()}),a=w,o=function(e){(!g||!g.aborted)&&v&&v.body&&Y(v.body,e)},a.on("socket",function(e){p=e}),a.on("response",function(e){let t=e.headers;"chunked"!==t["transfer-encoding"]||t["content-length"]||e.once("close",function(e){if(p&&p.listenerCount("data")>0&&!e){let e=Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",o(e)}})}),14>parseInt(process.version.substring(1))&&w.on("socket",function(e){e.addListener("close",function(t){let s=e.listenerCount("data")>0;if(v&&s&&!t&&!(g&&g.aborted)){let e=Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",v.body.emit("error",e)}})}),w.on("response",function(e){clearTimeout(l);let t=function(e){let t=new H;for(let s of Object.keys(e))if(!O.test(s)){if(Array.isArray(e[s]))for(let i of e[s])!E.test(i)&&(void 0===t[$][s]?t[$][s]=[i]:t[$][s].push(i));else E.test(e[s])||(t[$][s]=[e[s]])}return t}(e.headers);if(K.isRedirect(e.statusCode)){let n=t.get("Location"),a=null;try{a=null===n?null:new V(n,u.url).toString()}catch(e){if("manual"!==u.redirect){i(new f(`uri requested responds with an invalid redirect URL: ${n}`,"invalid-redirect")),C();return}}switch(u.redirect){case"error":i(new f(`uri requested responds with a redirect, redirect mode is set to error: ${u.url}`,"no-redirect")),C();return;case"manual":if(null!==a)try{t.set("Location",a)}catch(e){i(e)}break;case"follow":var r;if(null===a)break;if(u.counter>=u.follow){i(new f(`maximum redirect reached at: ${u.url}`,"max-redirect")),C();return}let o={headers:new H(u.headers),follow:u.follow,counter:u.counter+1,agent:u.agent,compress:u.compress,method:u.method,body:u.body,signal:u.signal,timeout:u.timeout,size:u.size};if(!Q(u.url,a)||(r=u.url,new V(a).protocol!==new V(r).protocol))for(let e of["authorization","www-authenticate","cookie","cookie2"])o.headers.delete(e);if(303!==e.statusCode&&u.body&&null===I(u)){i(new f("Cannot follow redirect with body being a readable stream","unsupported-redirect")),C();return}(303===e.statusCode||(301===e.statusCode||302===e.statusCode)&&"POST"===u.method)&&(o.method="GET",o.body=void 0,o.headers.delete("content-length")),s(K(new G(a,o))),C();return}}e.once("end",function(){g&&g.removeEventListener("abort",y)});let n=e.pipe(new W),a={url:u.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:u.size,timeout:u.timeout,counter:u.counter},o=t.get("Content-Encoding");if(!u.compress||"HEAD"===u.method||null===o||204===e.statusCode||304===e.statusCode){s(v=new x(n,a));return}let c={flush:h.Z_SYNC_FLUSH,finishFlush:h.Z_SYNC_FLUSH};if("gzip"==o||"x-gzip"==o){s(v=new x(n=n.pipe(h.createGunzip(c)),a));return}if("deflate"==o||"x-deflate"==o){let t=e.pipe(new W);t.once("data",function(e){s(v=new x(n=(15&e[0])==8?n.pipe(h.createInflate()):n.pipe(h.createInflateRaw()),a))}),t.on("end",function(){v||s(v=new x(n,a))});return}if("br"==o&&"function"==typeof h.createBrotliDecompress){s(v=new x(n=n.pipe(h.createBrotliDecompress()),a));return}s(v=new x(n,a))}),function(e,t){let s=t.body;null===s?e.end():P(s)?s.stream().pipe(e):Buffer.isBuffer(s)?(e.write(s),e.end()):s.pipe(e)}(w,u)})}function Y(e,t){e.destroy?e.destroy(t):(e.emit("error",t),e.end())}K.isRedirect=function(e){return 301===e||302===e||303===e||307===e||308===e},K.Promise=global.Promise;let Z=K}};
//# sourceMappingURL=10772.js.map